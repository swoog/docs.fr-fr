---
title: Migration .NET Core à partir de project.json
description: Apprenez à migrer un ancien projet .NET Core à l’aide de project.json
author: blackdwarf
ms.date: 07/19/2017
ms.custom: seodec18
ms.openlocfilehash: 40a0aaf9d687a580b83e11811effad458f708a85
ms.sourcegitcommit: e6ad58812807937b03f5c581a219dcd7d1726b1d
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 12/10/2018
ms.locfileid: "53170689"
---
# <a name="migrating-net-core-projects-from-projectjson"></a><span data-ttu-id="7bac3-103">Migration de projets .NET Core à partir de project.json</span><span class="sxs-lookup"><span data-stu-id="7bac3-103">Migrating .NET Core projects from project.json</span></span>

<span data-ttu-id="7bac3-104">Ce document couvre les scénarios de migration pour les projets .NET Core et passe en revue les trois scénarios de migration suivants :</span><span class="sxs-lookup"><span data-stu-id="7bac3-104">This document will cover migration scenarios for .NET Core projects and will go over the following three migration scenarios:</span></span>

1. [<span data-ttu-id="7bac3-105">Migration à partir du schéma valide le plus récent de *project.json* vers *csproj*</span><span class="sxs-lookup"><span data-stu-id="7bac3-105">Migration from a valid latest schema of *project.json* to *csproj*</span></span>](#migration-from-projectjson-to-csproj)
2. [<span data-ttu-id="7bac3-106">Migration à partir de DNX vers csproj</span><span class="sxs-lookup"><span data-stu-id="7bac3-106">Migration from DNX to csproj</span></span>](#migration-from-dnx-to-csproj)
3. [<span data-ttu-id="7bac3-107">Migration de projets csproj .NET Core RC3 et antérieurs vers le format final</span><span class="sxs-lookup"><span data-stu-id="7bac3-107">Migration from RC3 and previous .NET Core csproj projects to the final format</span></span>](#migration-from-earlier-net-core-csproj-formats-to-rtm-csproj)

<span data-ttu-id="7bac3-108">Ce document s’applique uniquement aux anciens projets .NET Core qui utilisent toujours project.json.</span><span class="sxs-lookup"><span data-stu-id="7bac3-108">This document is only applicable to older .NET Core projects that still use project.json.</span></span> <span data-ttu-id="7bac3-109">Il ne concerne pas la migration de .NET Framework vers .NET Core.</span><span class="sxs-lookup"><span data-stu-id="7bac3-109">It is not applicable for migrating from .NET Framework to .NET Core.</span></span>

## <a name="migration-from-projectjson-to-csproj"></a><span data-ttu-id="7bac3-110">Migration de project.json vers csproj</span><span class="sxs-lookup"><span data-stu-id="7bac3-110">Migration from project.json to csproj</span></span>

<span data-ttu-id="7bac3-111">La migration à partir de *project.json* vers *.csproj* peut être effectuée à l’aide de l’une des méthodes suivantes :</span><span class="sxs-lookup"><span data-stu-id="7bac3-111">Migration from *project.json* to *.csproj* can be done using one of the following methods:</span></span>

- [<span data-ttu-id="7bac3-112">Visual Studio 2017</span><span class="sxs-lookup"><span data-stu-id="7bac3-112">Visual Studio 2017</span></span>](#visual-studio-2017)
- [<span data-ttu-id="7bac3-113">Outil de ligne de commande dotnet migrate</span><span class="sxs-lookup"><span data-stu-id="7bac3-113">dotnet migrate command-line tool</span></span>](#dotnet-migrate)

<span data-ttu-id="7bac3-114">Les deux méthodes utilisant le même moteur sous-jacent pour migrer les projets, les résultats obtenus sont donc identiques dans les deux cas.</span><span class="sxs-lookup"><span data-stu-id="7bac3-114">Both methods use the same underlying engine to migrate the projects, so the results will be the same for both.</span></span> <span data-ttu-id="7bac3-115">Dans la plupart des cas, l’utilisation de l’une de ces deux méthodes pour migrer *project.json* vers *csproj* suffit et aucune autre modification manuelle du fichier projet n’est nécessaire.</span><span class="sxs-lookup"><span data-stu-id="7bac3-115">In most cases, using one of these two ways to migrate the *project.json* to *csproj* is the only thing that is needed and no further manual editing of the project file is necessary.</span></span> <span data-ttu-id="7bac3-116">Le fichier *.csproj* obtenu porte le même nom que le répertoire le contenant.</span><span class="sxs-lookup"><span data-stu-id="7bac3-116">The resulting *.csproj* file will be named the same as the containing directory name.</span></span>

### <a name="visual-studio-2017"></a><span data-ttu-id="7bac3-117">Visual Studio 2017</span><span class="sxs-lookup"><span data-stu-id="7bac3-117">Visual Studio 2017</span></span>

<span data-ttu-id="7bac3-118">Quand vous ouvrez un fichier *.xproj* ou un fichier solution qui fait référence à des fichiers *.xproj*, la boîte de dialogue **Mise à niveau définitive** s’affiche.</span><span class="sxs-lookup"><span data-stu-id="7bac3-118">When you open a *.xproj* file or a solution file which references *.xproj* files, the **One-way upgrade** dialog appears.</span></span> <span data-ttu-id="7bac3-119">La boîte de dialogue affiche les projets à migrer.</span><span class="sxs-lookup"><span data-stu-id="7bac3-119">The dialog displays the projects to be migrated.</span></span>
<span data-ttu-id="7bac3-120">Si vous ouvrez un fichier solution, tous les projets spécifiés dans le fichier solution sont répertoriés.</span><span class="sxs-lookup"><span data-stu-id="7bac3-120">If you open a solution file, all the projects specified in the solution file will be listed.</span></span> <span data-ttu-id="7bac3-121">Passez en revue la liste des projets à migrer, puis sélectionnez **OK**.</span><span class="sxs-lookup"><span data-stu-id="7bac3-121">Review the list of projects to be migrated and select **OK**.</span></span>

![Boîte de dialogue Mise à niveau définitive indiquant la liste des projets à migrer](media/one-way-upgrade.jpg)

<span data-ttu-id="7bac3-123">Visual Studio migre les projets choisis automatiquement.</span><span class="sxs-lookup"><span data-stu-id="7bac3-123">Visual Studio will migrate the projects chosen automatically.</span></span> <span data-ttu-id="7bac3-124">Quand vous migrez une solution, si vous ne choisissez pas tous les projets, la même boîte de dialogue s’affiche pour vous demander de mettre à niveau les projets restants de cette solution.</span><span class="sxs-lookup"><span data-stu-id="7bac3-124">When migrating a solution, if you don't choose all projects, the same dialog will appear asking you to upgrade the remaining projects from that solution.</span></span> <span data-ttu-id="7bac3-125">Une fois le projet migré, vous pouvez voir et modifier son contenu en double-cliquant sur le projet dans la fenêtre **Explorateur de solutions** et en sélectionnant **Modifier \<nom_projet>.csproj**.</span><span class="sxs-lookup"><span data-stu-id="7bac3-125">After the project is migrated, you can see and modify its contents by right-clicking the project in the **Solution Explorer** window and selecting **Edit \<project name>.csproj**.</span></span>

<span data-ttu-id="7bac3-126">Les fichiers qui ont été migrés (*project.json*, *global.json*, *.xproj* et le fichier solution) sont déplacés vers un dossier de *sauvegarde*.</span><span class="sxs-lookup"><span data-stu-id="7bac3-126">Files that were migrated (*project.json*, *global.json*, *.xproj* and solution file) will be moved to a *Backup* folder.</span></span> <span data-ttu-id="7bac3-127">Le fichier solution qui est migré est mis à niveau vers Visual Studio 2017 et vous ne pourrez pas l’ouvrir dans les versions précédentes de Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="7bac3-127">The solution file that is migrated will be upgraded to Visual Studio 2017 and you won't be able to open that solution file in previous versions of Visual Studio.</span></span>
<span data-ttu-id="7bac3-128">Un fichier nommé *UpgradeLog.htm* qui contient un rapport de migration est également enregistré et automatiquement ouvert.</span><span class="sxs-lookup"><span data-stu-id="7bac3-128">A file named *UpgradeLog.htm* is also saved and automatically opened that contains a migration report.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="7bac3-129">Les nouveaux outils n’étant pas disponibles dans Visual Studio 2015, vous ne pouvez pas migrer vos projets à l’aide de cette version de Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="7bac3-129">The new tooling is not available in Visual Studio 2015, so you cannot migrate your projects using that version of Visual Studio.</span></span>

### <a name="dotnet-migrate"></a><span data-ttu-id="7bac3-130">dotnet migrate</span><span class="sxs-lookup"><span data-stu-id="7bac3-130">dotnet migrate</span></span>

<span data-ttu-id="7bac3-131">Dans le scénario de ligne de commande, vous pouvez utiliser la commande [`dotnet migrate`](../tools/dotnet-migrate.md).</span><span class="sxs-lookup"><span data-stu-id="7bac3-131">In the command-line scenario, you can use the [`dotnet migrate`](../tools/dotnet-migrate.md) command.</span></span> <span data-ttu-id="7bac3-132">Elle migre un projet, une solution ou un ensemble de dossiers dans cet ordre, selon ceux qui ont été trouvés.</span><span class="sxs-lookup"><span data-stu-id="7bac3-132">It will migrate a project, a solution or a set of folders in that order, depending on which ones were found.</span></span>
<span data-ttu-id="7bac3-133">Quand vous migrez un projet, le projet et toutes ses dépendances sont migrés.</span><span class="sxs-lookup"><span data-stu-id="7bac3-133">When you migrate a project, the project and all its dependencies are migrated.</span></span>

<span data-ttu-id="7bac3-134">Les fichiers qui ont été migrés (*project.json*, *global.json* et *.xproj*) sont déplacés vers un dossier de *sauvegarde*.</span><span class="sxs-lookup"><span data-stu-id="7bac3-134">Files that were migrated (*project.json*, *global.json* and *.xproj*) will be moved to a *backup* folder.</span></span>

> [!NOTE]
> <span data-ttu-id="7bac3-135">Si vous utilisez Visual Studio Code, la commande `dotnet migrate` ne modifie pas les fichiers spécifiques à Visual Studio Code comme `tasks.json`.</span><span class="sxs-lookup"><span data-stu-id="7bac3-135">If you are using Visual Studio Code, the `dotnet migrate` command will not modify Visual Studio Code-specific files such as `tasks.json`.</span></span> <span data-ttu-id="7bac3-136">Ces fichiers doivent être modifiés manuellement.</span><span class="sxs-lookup"><span data-stu-id="7bac3-136">These files need to be changed manually.</span></span>
> <span data-ttu-id="7bac3-137">Cela s’applique également si vous utilisez Project Ryder ou un éditeur ou environnement de développement intégré (IDE) autre que Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="7bac3-137">This is also true if you are using Project Ryder or any editor or Integrated Development Environment (IDE) other than Visual Studio.</span></span>

<span data-ttu-id="7bac3-138">Consultez la page [Mappage entre propriétés project.json et csproj](../tools/project-json-to-csproj.md) pour afficher une comparaison des formats project.json et csproj.</span><span class="sxs-lookup"><span data-stu-id="7bac3-138">See [A mapping between project.json and csproj properties](../tools/project-json-to-csproj.md) for a comparison of project.json and csproj formats.</span></span>

### <a name="common-issues"></a><span data-ttu-id="7bac3-139">Problèmes courants</span><span class="sxs-lookup"><span data-stu-id="7bac3-139">Common issues</span></span>

- <span data-ttu-id="7bac3-140">Si vous obtenez une erreur : « Aucun fichier exécutable correspondant à la commande dotnet migrate n’a été trouvé » :</span><span class="sxs-lookup"><span data-stu-id="7bac3-140">If you get an error: "No executable found matching command dotnet-migrate":</span></span>

<span data-ttu-id="7bac3-141">Exécutez `dotnet --version` pour afficher la version que vous utilisez.</span><span class="sxs-lookup"><span data-stu-id="7bac3-141">Run `dotnet --version` to see which version you are using.</span></span> <span data-ttu-id="7bac3-142">[`dotnet migrate`](../tools/dotnet-migrate.md) nécessite la CLI .NET Core RC3 ou version ultérieure.</span><span class="sxs-lookup"><span data-stu-id="7bac3-142">[`dotnet migrate`](../tools/dotnet-migrate.md) requires .NET Core CLI RC3 or higher.</span></span>
<span data-ttu-id="7bac3-143">Cette erreur s’affiche si un fichier *global.json* figure dans le répertoire actif ou parent et que la version `sdk` est une version antérieure.</span><span class="sxs-lookup"><span data-stu-id="7bac3-143">You’ll get this error if you have a *global.json* file in the current or parent directory and the `sdk` version is set to an older version.</span></span>

## <a name="migration-from-dnx-to-csproj"></a><span data-ttu-id="7bac3-144">Migration à partir de DNX vers csproj</span><span class="sxs-lookup"><span data-stu-id="7bac3-144">Migration from DNX to csproj</span></span>

<span data-ttu-id="7bac3-145">Si vous utilisez encore DNX pour le développement .NET Core, votre processus de migration doit être effectué en deux étapes :</span><span class="sxs-lookup"><span data-stu-id="7bac3-145">If you are still using DNX for .NET Core development, your migration process should be done in two stages:</span></span>

1. <span data-ttu-id="7bac3-146">Utilisez les [conseils de migration DNX existants](from-dnx.md) pour la migration à partir de DNX vers la CLI prenant en charge project-json.</span><span class="sxs-lookup"><span data-stu-id="7bac3-146">Use the [existing DNX migration guidance](from-dnx.md) to migrate from DNX to project-json enabled CLI.</span></span>
2. <span data-ttu-id="7bac3-147">Suivez les étapes de la section précédente pour la migration de *project.json* vers *.csproj*.</span><span class="sxs-lookup"><span data-stu-id="7bac3-147">Follow the steps from the previous section to migrate from *project.json* to *.csproj*.</span></span>  

> [!NOTE]
> <span data-ttu-id="7bac3-148">DNX a été officiellement déprécié lors de la version Preview 1 de la CLI .NET Core.</span><span class="sxs-lookup"><span data-stu-id="7bac3-148">DNX has become officially deprecated during the Preview 1 release of the .NET Core CLI.</span></span>

## <a name="migration-from-earlier-net-core-csproj-formats-to-rtm-csproj"></a><span data-ttu-id="7bac3-149">Migration de formats csproj .NET Core antérieurs vers le format csproj final</span><span class="sxs-lookup"><span data-stu-id="7bac3-149">Migration from earlier .NET Core csproj formats to RTM csproj</span></span>

<span data-ttu-id="7bac3-150">Le format csproj .NET Core est modifié et évolue avec chaque nouvelle version préliminaire des outils.</span><span class="sxs-lookup"><span data-stu-id="7bac3-150">The .NET Core csproj format has been changing and evolving with each new pre-release version of the tooling.</span></span> <span data-ttu-id="7bac3-151">Comme il n’existe aucun outil pour migrer votre fichier projet des versions antérieures de csproj vers la dernière version, vous devez modifier manuellement le fichier projet.</span><span class="sxs-lookup"><span data-stu-id="7bac3-151">There is no tool that will migrate your project file from earlier versions of csproj to the latest, so you need to manually edit the project file.</span></span> <span data-ttu-id="7bac3-152">Les étapes réelles dépendent de la version du fichier projet que vous migrez.</span><span class="sxs-lookup"><span data-stu-id="7bac3-152">The actual steps depend on the version of the project file you are migrating.</span></span> <span data-ttu-id="7bac3-153">Voici quelques conseils à prendre en compte en fonction des modifications apportées entre les versions :</span><span class="sxs-lookup"><span data-stu-id="7bac3-153">The following is some guidance to consider based on the changes that happened between versions:</span></span>

* <span data-ttu-id="7bac3-154">Supprimez la propriété de version des outils de l’élément `<Project>`, si elle existe.</span><span class="sxs-lookup"><span data-stu-id="7bac3-154">Remove the tools version property from the `<Project>` element, if it exists.</span></span>
* <span data-ttu-id="7bac3-155">Supprimez l’espace de noms XML (`xmlns`) de l’élément `<Project>`.</span><span class="sxs-lookup"><span data-stu-id="7bac3-155">Remove the XML namespace (`xmlns`) from the `<Project>` element.</span></span>
* <span data-ttu-id="7bac3-156">S’il n’existe pas, ajoutez l’attribut `Sdk` à l’élément `<Project>` et affectez-lui la valeur `Microsoft.NET.Sdk` ou `Microsoft.NET.Sdk.Web`.</span><span class="sxs-lookup"><span data-stu-id="7bac3-156">If it doesn't exist, add the `Sdk` attribute to the `<Project>` element and set it to `Microsoft.NET.Sdk` or `Microsoft.NET.Sdk.Web`.</span></span> <span data-ttu-id="7bac3-157">Cet attribut spécifie que le projet utilise le SDK à utiliser.</span><span class="sxs-lookup"><span data-stu-id="7bac3-157">This attribute specifies that the project uses the SDK to be used.</span></span> <span data-ttu-id="7bac3-158">`Microsoft.NET.Sdk.Web` est utilisé pour les applications web.</span><span class="sxs-lookup"><span data-stu-id="7bac3-158">`Microsoft.NET.Sdk.Web` is used for web apps.</span></span>
* <span data-ttu-id="7bac3-159">Supprimez les instructions `<Import Project="$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props" />` et `<Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />` en haut et en bas du projet.</span><span class="sxs-lookup"><span data-stu-id="7bac3-159">Remove the `<Import Project="$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props" />` and `<Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />` statements from the top and bottom of the project.</span></span> <span data-ttu-id="7bac3-160">Ces instructions d’importation étant indiquées implicitement par le SDK, il est inutile qu’elles figurent dans le projet.</span><span class="sxs-lookup"><span data-stu-id="7bac3-160">These import statements are implied by the SDK, so there is no need for them to be in the project.</span></span>
* <span data-ttu-id="7bac3-161">Si des éléments `<PackageReference>` `Microsoft.NETCore.App` ou `NETStandard.Library` figurent dans votre projet, vous devez les supprimer.</span><span class="sxs-lookup"><span data-stu-id="7bac3-161">If you have `Microsoft.NETCore.App` or `NETStandard.Library` `<PackageReference>` items in your project, you should remove them.</span></span> <span data-ttu-id="7bac3-162">Ces références de package sont [indiquées implicitement par le SDK](https://aka.ms/sdkimplicitrefs).</span><span class="sxs-lookup"><span data-stu-id="7bac3-162">These package references are [implied by the SDK](https://aka.ms/sdkimplicitrefs).</span></span>
* <span data-ttu-id="7bac3-163">Supprimez l’élément `<PackageReference>` `Microsoft.NET.Sdk`, s’il existe.</span><span class="sxs-lookup"><span data-stu-id="7bac3-163">Remove the `Microsoft.NET.Sdk` `<PackageReference>` element, if it exists.</span></span> <span data-ttu-id="7bac3-164">La référence SDK est fournie par l’attribut `Sdk` sur l’élément `<Project>`.</span><span class="sxs-lookup"><span data-stu-id="7bac3-164">The SDK reference comes through the `Sdk` attribute on the `<Project>` element.</span></span>
* <span data-ttu-id="7bac3-165">Supprimez les modèles [Glob](https://en.wikipedia.org/wiki/Glob_(programming)) qui sont [indiqués implicitement par le SDK](../tools/csproj.md#default-compilation-includes-in-net-core-projects).</span><span class="sxs-lookup"><span data-stu-id="7bac3-165">Remove the [globs](https://en.wikipedia.org/wiki/Glob_(programming)) that are [implied by the SDK](../tools/csproj.md#default-compilation-includes-in-net-core-projects).</span></span> <span data-ttu-id="7bac3-166">En laissant ces modèles Glob dans votre projet, une erreur se produit lors de la génération, car les éléments de compilation sont dupliqués.</span><span class="sxs-lookup"><span data-stu-id="7bac3-166">Leaving these globs in your project will cause an error on build because compile items will be duplicated.</span></span>

<span data-ttu-id="7bac3-167">Une fois ces étapes effectuées, votre projet doit être entièrement compatible avec le format csproj .NET Core final.</span><span class="sxs-lookup"><span data-stu-id="7bac3-167">After these steps your project should be fully compatible with the RTM .NET Core csproj format.</span></span>

<span data-ttu-id="7bac3-168">Pour obtenir des exemples antérieurs et postérieurs à la migration de l’ancien format csproj vers le nouveau, consultez l’article [Updating Visual Studio 2017 RC – .NET Core Tooling improvements](https://blogs.msdn.microsoft.com/dotnet/2016/12/12/updating-visual-studio-2017-rc-net-core-tooling-improvements/) sur le blog .NET.</span><span class="sxs-lookup"><span data-stu-id="7bac3-168">For examples of before and after the migration from old csproj format to the new one, see the [Updating Visual Studio 2017 RC – .NET Core Tooling improvements](https://blogs.msdn.microsoft.com/dotnet/2016/12/12/updating-visual-studio-2017-rc-net-core-tooling-improvements/) article on the .NET blog.</span></span>

## <a name="see-also"></a><span data-ttu-id="7bac3-169">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="7bac3-169">See also</span></span>

- [<span data-ttu-id="7bac3-170">Porter, migrer et mettre à niveau des projets Visual Studio</span><span class="sxs-lookup"><span data-stu-id="7bac3-170">Port, Migrate, and Upgrade Visual Studio Projects</span></span>](/visualstudio/porting/port-migrate-and-upgrade-visual-studio-projects)
