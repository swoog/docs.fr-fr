---
title: Orchestration des microservices et des applications à plusieurs conteneurs pour une grande scalabilité et une haute disponibilité
description: Applications de production réel doivent être déployée et gérée avec des orchestrateurs qui gèrent l’intégrité, les charges de travail et les cycles de vie de tous les conteneurs.
author: CESARDELATORRE
ms.author: wiwagn
ms.date: 02/15/2019
ms.openlocfilehash: 834e0b91a596f489c10e4eb11b0de2b5eaeb9f1c
ms.sourcegitcommit: 7156c0b9e4ce4ce5ecf48ce3d925403b638b680c
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/26/2019
ms.locfileid: "58466398"
---
# <a name="orchestrating-microservices-and-multi-container-applications-for-high-scalability-and-availability"></a><span data-ttu-id="68158-103">Orchestration des microservices et des applications à plusieurs conteneurs pour une grande scalabilité et une haute disponibilité</span><span class="sxs-lookup"><span data-stu-id="68158-103">Orchestrating microservices and multi-container applications for high scalability and availability</span></span>

<span data-ttu-id="68158-104">Il est essentiel de l’utilisation d’orchestrateurs pour les applications prêtes pour la production si votre application est basée sur des microservices ou répartie entre plusieurs conteneurs.</span><span class="sxs-lookup"><span data-stu-id="68158-104">Using orchestrators for production-ready applications is essential if your application is based on microservices or split across multiple containers.</span></span> <span data-ttu-id="68158-105">Comme expliqué précédemment, dans une approche basée sur les microservices, chaque microservice détient son modèle et ses données, ce qui le rend autonome du point de vue du développement et du déploiement.</span><span class="sxs-lookup"><span data-stu-id="68158-105">As introduced previously, in a microservice-based approach, each microservice owns its model and data so that it will be autonomous from a development and deployment point of view.</span></span> <span data-ttu-id="68158-106">Toutefois, même si vous avez une application plus classique composée de plusieurs services (par exemple SOA), vous aurez également plusieurs conteneurs ou services constituant une même application métier, qui doivent être déployés en tant que système distribué.</span><span class="sxs-lookup"><span data-stu-id="68158-106">But even if you have a more traditional application that's composed of multiple services (like SOA), you'll also have multiple containers or services comprising a single business application that need to be deployed as a distributed system.</span></span> <span data-ttu-id="68158-107">Ces types de systèmes sont complexes à monter en charge et à gérer : pour cette raison, vous avez absolument besoin d’un orchestrateur si vous voulez disposer d’une application multiconteneur prête pour la production et scalable.</span><span class="sxs-lookup"><span data-stu-id="68158-107">These kinds of systems are complex to scale out and manage; therefore, you absolutely need an orchestrator if you want to have a production-ready and scalable multi-container application.</span></span>

<span data-ttu-id="68158-108">Figure 4-6 illustre un déploiement dans un cluster d’une application composée de plusieurs microservices (conteneurs).</span><span class="sxs-lookup"><span data-stu-id="68158-108">Figure 4-6 illustrates deployment into a cluster of an application composed of multiple microservices (containers).</span></span>

![Applications Docker composées dans un cluster : vous utilisez un conteneur pour chaque instance de service.](./media/image6.png)

<span data-ttu-id="68158-111">**Figure 4-6**.</span><span class="sxs-lookup"><span data-stu-id="68158-111">**Figure 4-6**.</span></span> <span data-ttu-id="68158-112">Un cluster de conteneurs</span><span class="sxs-lookup"><span data-stu-id="68158-112">A cluster of containers</span></span>

<span data-ttu-id="68158-113">Ceci ressemble à une approche logique.</span><span class="sxs-lookup"><span data-stu-id="68158-113">It looks like a logical approach.</span></span> <span data-ttu-id="68158-114">Mais comment gérez-vous l’équilibrage de charge, le routage et l’orchestration de ces applications composées ?</span><span class="sxs-lookup"><span data-stu-id="68158-114">But how are you handling load balancing, routing, and orchestrating these composed applications?</span></span>

<span data-ttu-id="68158-115">L’interface de ligne de commande (CLI) Docker répond aux besoins de la gestion d’un conteneur sur un ordinateur hôte, mais il s’avère insuffisant lorsqu’il s’agit de la gestion de plusieurs conteneurs déployés sur plusieurs ordinateurs hôtes pour les applications distribuées plus complexes.</span><span class="sxs-lookup"><span data-stu-id="68158-115">The Docker command-line interface (CLI) meets the needs of managing one container on one host, but it falls short when it comes to managing multiple containers deployed on multiple hosts for more complex distributed applications.</span></span> <span data-ttu-id="68158-116">Dans la plupart des cas, vous avez besoin d’une plateforme de gestion qui sera automatiquement démarrer les conteneurs, monter en charge des conteneurs avec plusieurs instances par image, les suspendre ou les arrêter si nécessaire et idéalement, contrôler comment ils accèdent aux ressources telles que le réseau et les données stockage.</span><span class="sxs-lookup"><span data-stu-id="68158-116">In most cases, you need a management platform that will automatically start containers, scale out containers with multiple instances per image, suspend them, or shut them down when needed, and ideally also control how they access resources like the network and data storage.</span></span>

<span data-ttu-id="68158-117">Pour aller au-delà de la gestion des conteneurs individuels ou des applications composées simples et la tendance vers les applications d’entreprise plus volumineuses avec des microservices, vous devez activer à l’orchestration et le clustering des plateformes.</span><span class="sxs-lookup"><span data-stu-id="68158-117">To go beyond the management of individual containers or simple composed apps and move toward larger enterprise applications with microservices, you must turn to orchestration and clustering platforms.</span></span>

<span data-ttu-id="68158-118">À partir d’un point de vue architecture et le développement, si vous êtes bâtiment, grands, basé sur des microservices, applications, il est important de comprendre les plateformes et les produits qui prennent en charge des scénarios avancés suivants :</span><span class="sxs-lookup"><span data-stu-id="68158-118">From an architecture and development point of view, if you're building large, enterprise, microservices-based, applications, it's important to understand the following platforms and products that support advanced scenarios:</span></span>

- <span data-ttu-id="68158-119">**Clusters et orchestrateurs.**</span><span class="sxs-lookup"><span data-stu-id="68158-119">**Clusters and orchestrators.**</span></span> <span data-ttu-id="68158-120">Lorsque vous avez besoin faire évoluer les applications sur plusieurs hôtes Docker, comme avec une grande application basée sur des microservices, il est essentiel de pouvoir gérer tous ces ordinateurs hôtes en tant qu’un seul cluster en faisant abstraction de la complexité de la plateforme sous-jacente.</span><span class="sxs-lookup"><span data-stu-id="68158-120">When you need to scale out applications across many Docker hosts, such as with a large microservices-based application, it's critical to be able to manage all of those hosts as a single cluster by abstracting the complexity of the underlying platform.</span></span> <span data-ttu-id="68158-121">C’est précisément ce que les clusters de conteneurs et les orchestrateurs permettent de faire.</span><span class="sxs-lookup"><span data-stu-id="68158-121">That's what the container clusters and orchestrators provide.</span></span> <span data-ttu-id="68158-122">Azure Service Fabric et Kubernetes sont des exemples d’orchestrateurs.</span><span class="sxs-lookup"><span data-stu-id="68158-122">Examples of orchestrators are Azure Service Fabric and Kubernetes.</span></span> <span data-ttu-id="68158-123">Kubernetes est disponible dans Azure via Azure Kubernetes Service.</span><span class="sxs-lookup"><span data-stu-id="68158-123">Kubernetes is available in Azure through Azure Kubernetes Service.</span></span>

- <span data-ttu-id="68158-124">**Planificateurs.**</span><span class="sxs-lookup"><span data-stu-id="68158-124">**Schedulers.**</span></span> <span data-ttu-id="68158-125">*Planification* signifie la capacité d’un administrateur pour lancer des conteneurs dans un cluster, afin de planificateurs fournissent également une interface utilisateur pour effectuer cette opération.</span><span class="sxs-lookup"><span data-stu-id="68158-125">*Scheduling* means to have the capability for an administrator to launch containers in a cluster, so schedulers also provide a user interface for doing so.</span></span> <span data-ttu-id="68158-126">Un planificateur de cluster a plusieurs responsabilités : utiliser efficacement les ressources du cluster, définir les contraintes fournies par l’utilisateur, équilibrer efficacement la charge des conteneurs entre les nœuds ou les hôtes, et faire preuve de robustesse face aux erreurs, tout en offrant une haute disponibilité.</span><span class="sxs-lookup"><span data-stu-id="68158-126">A cluster scheduler has several responsibilities: to use the cluster's resources efficiently, to set the constraints provided by the user, to efficiently load-balance containers across nodes or hosts, and to be robust against errors while providing high availability.</span></span>

<span data-ttu-id="68158-127">Les concepts de cluster et de planificateur sont étroitement liés : les produits fournis par les différents fournisseurs offrent souvent les deux ensembles de fonctionnalités.</span><span class="sxs-lookup"><span data-stu-id="68158-127">The concepts of a cluster and a scheduler are closely related, so the products provided by different vendors often provide both sets of capabilities.</span></span> <span data-ttu-id="68158-128">La section ci-dessous illustre les plus importants pour les plateformes et les choix d’un logiciel pour les clusters et des planificateurs.</span><span class="sxs-lookup"><span data-stu-id="68158-128">The section below shows the most important platform and software choices you have for clusters and schedulers.</span></span> <span data-ttu-id="68158-129">Ces orchestrateurs sont largement proposées dans des clouds publics comme Azure.</span><span class="sxs-lookup"><span data-stu-id="68158-129">These orchestrators are widely offered in public clouds like Azure.</span></span>

## <a name="software-platforms-for-container-clustering-orchestration-and-scheduling"></a><span data-ttu-id="68158-130">Plateformes logicielles pour le clustering, l’orchestration et la planification de conteneurs</span><span class="sxs-lookup"><span data-stu-id="68158-130">Software platforms for container clustering, orchestration, and scheduling</span></span>

| <span data-ttu-id="68158-131">Plateforme</span><span class="sxs-lookup"><span data-stu-id="68158-131">Platform</span></span> | <span data-ttu-id="68158-132">Commentaires</span><span class="sxs-lookup"><span data-stu-id="68158-132">Comments</span></span> |
|:---:|:---|
| <span data-ttu-id="68158-133">**Kubernetes**</span><span class="sxs-lookup"><span data-stu-id="68158-133">**Kubernetes**</span></span> <br/> <span data-ttu-id="68158-134">![Logo de Kubernetes](./media/kubernetes-logo.png)</span><span class="sxs-lookup"><span data-stu-id="68158-134">![Kubernetes Logo](./media/kubernetes-logo.png)</span></span> | <span data-ttu-id="68158-135">[*Kubernetes*](https://kubernetes.io/) est un produit open source qui offre des fonctionnalités allant de l’infrastructure de cluster et la planification de conteneurs aux fonctionnalités d’orchestration.</span><span class="sxs-lookup"><span data-stu-id="68158-135">[*Kubernetes*](https://kubernetes.io/) is an open-source product that provides functionality that ranges from cluster infrastructure and container scheduling to orchestrating capabilities.</span></span> <span data-ttu-id="68158-136">Il vous permet d’automatiser le déploiement, la mise à l’échelle et le fonctionnement de conteneurs d’application entre des clusters d’hôtes.</span><span class="sxs-lookup"><span data-stu-id="68158-136">It lets you automate deployment, scaling, and operations of application containers across clusters of hosts.</span></span> <br/> <br/> <span data-ttu-id="68158-137">*Kubernetes* fournit une infrastructure orientée conteneur, qui regroupe les conteneurs d’application dans des unités logiques pour en faciliter la gestion et la découverte.</span><span class="sxs-lookup"><span data-stu-id="68158-137">*Kubernetes* provides a container-centric infrastructure that groups application containers into logical units for easy management and discovery.</span></span> <br/> <br/> <span data-ttu-id="68158-138">*Kubernetes* est suffisamment mature dans Linux, mais il l’est moins dans Windows.</span><span class="sxs-lookup"><span data-stu-id="68158-138">*Kubernetes* is mature in Linux, less mature in Windows.</span></span> |
| <span data-ttu-id="68158-139">**Azure Kubernetes Service (AKS)**</span><span class="sxs-lookup"><span data-stu-id="68158-139">**Azure Kubernetes Service (AKS)**</span></span> <br/> <span data-ttu-id="68158-140">![Logo Azure Kubernetes Service](./media/aks-logo.png)</span><span class="sxs-lookup"><span data-stu-id="68158-140">![Azure Kubernetes Service Logo](./media/aks-logo.png)</span></span> | <span data-ttu-id="68158-141">[AKS (Azure Kubernetes Service)](https://azure.microsoft.com/services/kubernetes-service/) est un service managé d’orchestration de conteneur Kubernetes dans Azure, qui simplifie la gestion, le déploiement et les opérations liés au cluster Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="68158-141">[Azure Kubernetes Service (AKS)](https://azure.microsoft.com/services/kubernetes-service/) is a managed Kubernetes container orchestration service in Azure that simplifies Kubernetes cluster’s management, deployment, and operations.</span></span> |
| <span data-ttu-id="68158-142">**Azure Service Fabric**</span><span class="sxs-lookup"><span data-stu-id="68158-142">**Azure Service Fabric**</span></span> <br/> <span data-ttu-id="68158-143">![Azure Service Fabric Logo](./media/service-fabric-logo.png)</span><span class="sxs-lookup"><span data-stu-id="68158-143">![Azure Service Fabric Logo](./media/service-fabric-logo.png)</span></span> | <span data-ttu-id="68158-144">[Service Fabric](https://docs.microsoft.com/azure/service-fabric/service-fabric-overview) est une plateforme de microservices de Microsoft pour la création d’applications.</span><span class="sxs-lookup"><span data-stu-id="68158-144">[Service Fabric](https://docs.microsoft.com/azure/service-fabric/service-fabric-overview) is a Microsoft microservices platform for building applications.</span></span> <span data-ttu-id="68158-145">Il s’agit d’un [orchestrateur](https://docs.microsoft.com/azure/service-fabric/service-fabric-cluster-resource-manager-introduction) de services, qui crée des clusters de machines.</span><span class="sxs-lookup"><span data-stu-id="68158-145">It's an [orchestrator](https://docs.microsoft.com/azure/service-fabric/service-fabric-cluster-resource-manager-introduction) of services and creates clusters of machines.</span></span> <span data-ttu-id="68158-146">Service Fabric peut déployer des services en tant que conteneurs ou en tant que processus standard.</span><span class="sxs-lookup"><span data-stu-id="68158-146">Service Fabric can deploy services as containers or as plain processes.</span></span> <span data-ttu-id="68158-147">Il peut même combiner des services dans des processus avec des services dans des conteneurs au sein de la même application et du même cluster.</span><span class="sxs-lookup"><span data-stu-id="68158-147">It can even mix services in processes with services in containers within the same application and cluster.</span></span> <br/> <br/> <span data-ttu-id="68158-148">Vous pouvez déployer les clusters *Service Fabric* dans Azure, localement ou dans un cloud.</span><span class="sxs-lookup"><span data-stu-id="68158-148">*Service Fabric* clusters can be deployed in Azure, on-premises or in any cloud.</span></span> <span data-ttu-id="68158-149">Toutefois, le déploiement dans Azure est simplifié grâce à une approche managée.</span><span class="sxs-lookup"><span data-stu-id="68158-149">However, deployment in Azure is simplified with a managed approach.</span></span> <br/> <br/> <span data-ttu-id="68158-150">*Service Fabric* fournit des [modèles de programmation Service Fabric](https://azure.microsoft.com/documentation/articles/service-fabric-choose-framework/) supplémentaires prescriptifs et facultatifs, par exemple les [services avec état](https://azure.microsoft.com/documentation/articles/service-fabric-reliable-services-introduction/) et [Reliable Actors](https://azure.microsoft.com/documentation/articles/service-fabric-reliable-actors-introduction/).</span><span class="sxs-lookup"><span data-stu-id="68158-150">*Service Fabric* provides additional and optional prescriptive [Service Fabric programming models](https://azure.microsoft.com/documentation/articles/service-fabric-choose-framework/) like [stateful services](https://azure.microsoft.com/documentation/articles/service-fabric-reliable-services-introduction/) and [Reliable Actors](https://azure.microsoft.com/documentation/articles/service-fabric-reliable-actors-introduction/).</span></span> <br/> <br/> <span data-ttu-id="68158-151">*Service Fabric* est suffisamment mature dans Windows (plusieurs années d’évolution dans Windows), mais il l’est moins dans Linux.</span><span class="sxs-lookup"><span data-stu-id="68158-151">*Service Fabric* is mature in Windows (years evolving in Windows), less mature in Linux.</span></span> <br/> <br/> <span data-ttu-id="68158-152">Les conteneurs Linux et Windows sont pris en charge dans Service Fabric depuis 2017.</span><span class="sxs-lookup"><span data-stu-id="68158-152">Both Linux and Windows containers are supported in Service Fabric since 2017.</span></span> |
| <span data-ttu-id="68158-153">**Azure Service Fabric maille**</span><span class="sxs-lookup"><span data-stu-id="68158-153">**Azure Service Fabric Mesh**</span></span> <br/> <span data-ttu-id="68158-154">![Logo de maille Azure Service Fabric](./media/azure-service-fabric-mesh-logo.png)</span><span class="sxs-lookup"><span data-stu-id="68158-154">![Azure Service Fabric Mesh Logo](./media/azure-service-fabric-mesh-logo.png)</span></span> | <span data-ttu-id="68158-155">[*Maillage de Azure Service Fabric* ](https://docs.microsoft.com/azure/service-fabric-mesh/service-fabric-mesh-overview) offre la même fiabilité, des performances stratégiques et mise à l’échelle en tant que Service Fabric, mais offre également une plateforme entièrement managée et sans serveur.</span><span class="sxs-lookup"><span data-stu-id="68158-155">[*Azure Service Fabric Mesh*](https://docs.microsoft.com/azure/service-fabric-mesh/service-fabric-mesh-overview) offers the same reliability, mission-critical performance and scale as Service Fabric, but also offers a fully managed and serverless platform.</span></span> <span data-ttu-id="68158-156">Vous n’avez pas besoin de gérer un cluster, des machines virtuelles, le stockage ou la configuration réseau.</span><span class="sxs-lookup"><span data-stu-id="68158-156">You don't need to manage a cluster, VMs, storage or networking configuration.</span></span> <span data-ttu-id="68158-157">Vous vous concentrez uniquement sur le développement de votre application.</span><span class="sxs-lookup"><span data-stu-id="68158-157">You just focus on your application's development.</span></span> <br/> <br/> <span data-ttu-id="68158-158">*Service Fabric Mesh* prend en charge des conteneurs Windows et Linux, ce qui vous permet de développer avec n’importe quel langage de programmation et une infrastructure de votre choix.</span><span class="sxs-lookup"><span data-stu-id="68158-158">*Service Fabric Mesh* supports both Windows and Linux containers, allowing you to develop with any programming language and framework of your choice.</span></span>

## <a name="using-container-based-orchestrators-in-azure"></a><span data-ttu-id="68158-159">À l’aide d’orchestrateurs basé sur des conteneurs dans Azure</span><span class="sxs-lookup"><span data-stu-id="68158-159">Using container-based orchestrators in Azure</span></span>

<span data-ttu-id="68158-160">Plusieurs fournisseurs de cloud offrent la prise en charge des conteneurs Docker ainsi que des clusters Docker et prise en charge de l’orchestration, y compris Azure, Amazon EC2 Container Service et Google Container Engine.</span><span class="sxs-lookup"><span data-stu-id="68158-160">Several cloud vendors offer Docker containers support plus Docker clusters and orchestration support, including Azure, Amazon EC2 Container Service, and Google Container Engine.</span></span> <span data-ttu-id="68158-161">Azure fournit Docker prise en charge de cluster et l’orchestrateur via Azure Kubernetes Service (AKS), Azure Service Fabric et Azure Service Fabric maillage.</span><span class="sxs-lookup"><span data-stu-id="68158-161">Azure provides Docker cluster and orchestrator support through Azure Kubernetes Service (AKS), Azure Service Fabric, and Azure Service Fabric Mesh.</span></span>

## <a name="using-azure-kubernetes-service"></a><span data-ttu-id="68158-162">Utilisation d’Azure Kubernetes Service</span><span class="sxs-lookup"><span data-stu-id="68158-162">Using Azure Kubernetes Service</span></span>

<span data-ttu-id="68158-163">Un cluster Kubernetes pools plusieurs hôtes Docker et expose ceux-ci comme un hôte Docker virtuel unique, afin de déployer plusieurs conteneurs dans le cluster et la montée en puissance avec un nombre quelconque d’instances de conteneur.</span><span class="sxs-lookup"><span data-stu-id="68158-163">A Kubernetes cluster pools several Docker hosts and exposes them as a single virtual Docker host, so you can deploy multiple containers into the cluster and scale-out with any number of container instances.</span></span> <span data-ttu-id="68158-164">Le cluster prend en charge tous les détails complexes de la gestion, comme la scalabilité , l’intégrité, etc.</span><span class="sxs-lookup"><span data-stu-id="68158-164">The cluster will handle all the complex management plumbing, like scalability, health, and so forth.</span></span>

<span data-ttu-id="68158-165">AKS offre un moyen de simplifier la création, la configuration et la gestion d’un cluster de machines virtuelles dans Azure. Ces machines virtuelles sont préconfigurées pour exécuter des applications conteneurisées.</span><span class="sxs-lookup"><span data-stu-id="68158-165">AKS provides a way to simplify the creation, configuration, and management of a cluster of virtual machines in Azure that are preconfigured to run containerized applications.</span></span> <span data-ttu-id="68158-166">À l’aide d’une configuration optimisée d’outils open source courants de planification et d’orchestration, AKS vous permet d’utiliser vos compétences existantes ou de profiter de l’expertise importante et toujours croissante de la communauté pour déployer et gérer des applications conteneurisées sur Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="68158-166">Using an optimized configuration of popular open-source scheduling and orchestration tools, AKS enables you to use your existing skills or draw on a large and growing body of community expertise to deploy and manage container-based applications on Microsoft Azure.</span></span>

<span data-ttu-id="68158-167">Azure Kubernetes Service optimise la configuration des technologies et outils open source courants de clustering Docker spécifiquement pour Azure.</span><span class="sxs-lookup"><span data-stu-id="68158-167">Azure Kubernetes Service optimizes the configuration of popular Docker clustering open-source tools and technologies specifically for Azure.</span></span> <span data-ttu-id="68158-168">Vous obtenez une solution ouverte qui offre la portabilité à la fois pour vos conteneurs et pour la configuration de votre application.</span><span class="sxs-lookup"><span data-stu-id="68158-168">You get an open solution that offers portability for both your containers and your application configuration.</span></span> <span data-ttu-id="68158-169">Il vous suffit de sélectionner la taille, le nombre d’hôtes et les outils de l’orchestrateur, AKS gère tout le reste.</span><span class="sxs-lookup"><span data-stu-id="68158-169">You select the size, the number of hosts, and the orchestrator tools, and AKS handles everything else.</span></span>

![Structure de cluster Kubernetes : il existe un nœud principal qui gère le système DNS, le planificateur, le proxy, etc., et plusieurs nœuds de travail, qui hébergent les conteneurs.](media/image36.png)

<span data-ttu-id="68158-171">**Figure 4-7**.</span><span class="sxs-lookup"><span data-stu-id="68158-171">**Figure 4-7**.</span></span> <span data-ttu-id="68158-172">Structure et topologie simplifiées du cluster Kubernetes</span><span class="sxs-lookup"><span data-stu-id="68158-172">Kubernetes cluster's simplified structure and topology</span></span>

<span data-ttu-id="68158-173">Figure 4-7 illustre la structure d’un cluster Kubernetes dans lequel un nœud principal (VM) contrôle la majeure partie de la coordination du cluster, et vous pouvez déployer des conteneurs sur le reste des nœuds qui sont gérés comme un pool unique à partir du point de vue d’application.</span><span class="sxs-lookup"><span data-stu-id="68158-173">Figure 4-7 shows the structure of a Kubernetes cluster where a master node (VM) controls most of the coordination of the cluster, and you can deploy containers to the rest of the nodes that are managed as a single pool from an application point of view.</span></span> <span data-ttu-id="68158-174">Cela vous permet à l’échelle pour des milliers voire des dizaines de milliers de conteneurs.</span><span class="sxs-lookup"><span data-stu-id="68158-174">This allows you to scale to thousands or even tens of thousands of containers.</span></span>

## <a name="development-environment-for-kubernetes"></a><span data-ttu-id="68158-175">Environnement de développement pour Kubernetes</span><span class="sxs-lookup"><span data-stu-id="68158-175">Development environment for Kubernetes</span></span>

<span data-ttu-id="68158-176">Dans l’environnement de développement qui [Docker annoncée en juillet 2018](https://blog.docker.com/2018/07/kubernetes-is-now-available-in-docker-desktop-stable-channel/), Kubernetes peut également s’exécuter sur une machine de développement unique (Windows 10 ou macOS) en installant simplement [Docker Desktop](https://www.docker.com/community-edition).</span><span class="sxs-lookup"><span data-stu-id="68158-176">In the development environment that [Docker announced in July 2018](https://blog.docker.com/2018/07/kubernetes-is-now-available-in-docker-desktop-stable-channel/), Kubernetes can also run in a single development machine (Windows 10 or macOS) by just installing [Docker Desktop](https://www.docker.com/community-edition).</span></span> <span data-ttu-id="68158-177">Vous pouvez déployer ultérieurement dans le cloud (ACS) davantage aux tests d’intégration, comme indiqué dans la figure 4-8.</span><span class="sxs-lookup"><span data-stu-id="68158-177">You can later deploy to the cloud (AKS) for further integration tests, as shown in figure 4-8.</span></span>

![Docker a annoncé la prise en charge des machines de développement pour les clusters Kubernetes en juillet 2018 avec Docker Desktop.](media/kubernetes-development-environment.png)

<span data-ttu-id="68158-179">**Figure 4-8**.</span><span class="sxs-lookup"><span data-stu-id="68158-179">**Figure 4-8**.</span></span> <span data-ttu-id="68158-180">Exécution de Kubernetes sur la machine de développement et dans le cloud</span><span class="sxs-lookup"><span data-stu-id="68158-180">Running Kubernetes in dev machine and the cloud</span></span>

## <a name="get-started-with-azure-kubernetes-service-aks"></a><span data-ttu-id="68158-181">Bien démarrer avec Azure Kubernetes Service (AKS)</span><span class="sxs-lookup"><span data-stu-id="68158-181">Get started with Azure Kubernetes Service (AKS)</span></span>

<span data-ttu-id="68158-182">Pour commencer à utiliser AKS, vous déployez un cluster AKS à partir du portail Azure ou à l’aide de l’interface CLI.</span><span class="sxs-lookup"><span data-stu-id="68158-182">To begin using AKS, you deploy an AKS cluster from the Azure portal or by using the CLI.</span></span> <span data-ttu-id="68158-183">Pour plus d’informations sur le déploiement d’un cluster Azure Container Service, consultez [Déployer un cluster AKS (Azure Kubernetes Service)](https://docs.microsoft.com/azure/aks/kubernetes-walkthrough-portal).</span><span class="sxs-lookup"><span data-stu-id="68158-183">For more information on deploying an Azure Container Service cluster, see [Deploy an Azure Kubernetes Service (AKS) cluster](https://docs.microsoft.com/azure/aks/kubernetes-walkthrough-portal).</span></span>

<span data-ttu-id="68158-184">Aucun coût n’est facturé pour les logiciels installés par défaut dans le cadre d’AKS.</span><span class="sxs-lookup"><span data-stu-id="68158-184">There are no fees for any of the software installed by default as part of AKS.</span></span> <span data-ttu-id="68158-185">Toutes les options par défaut sont implémentées avec des logiciels open source.</span><span class="sxs-lookup"><span data-stu-id="68158-185">All default options are implemented with open-source software.</span></span> <span data-ttu-id="68158-186">AKS est disponible pour plusieurs machines virtuelles dans Azure.</span><span class="sxs-lookup"><span data-stu-id="68158-186">AKS is available for multiple virtual machines in Azure.</span></span> <span data-ttu-id="68158-187">Vous payez seulement pour les instances de calcul que vous choisissez ainsi que pour les autres ressources de l’infrastructure sous-jacente consommées, comme le stockage et le réseau.</span><span class="sxs-lookup"><span data-stu-id="68158-187">You're charged only for the compute instances you choose, as well as the other underlying infrastructure resources consumed, such as storage and networking.</span></span> <span data-ttu-id="68158-188">Aucun coût supplémentaire n’est facturé pour AKS.</span><span class="sxs-lookup"><span data-stu-id="68158-188">There are no incremental charges for AKS itself.</span></span>

<span data-ttu-id="68158-189">Pour les autres mises en œuvre plus d’informations sur le déploiement vers Kubernetes basés sur `kubectl` d’origine et `.yaml` fichiers, consultez le billet sur [paramétrage eShopOnContainers dans ACS (Azure Kubernetes Service)](https://github.com/dotnet-architecture/eShopOnContainers/wiki/10.-Setting-the-solution-up-in-AKS-(Azure-Kubernetes-Service)).</span><span class="sxs-lookup"><span data-stu-id="68158-189">For further implementation information on deployment to Kubernetes based on `kubectl` and original `.yaml` files, see the post on [Setting eShopOnContainers up in AKS (Azure Kubernetes Service)](https://github.com/dotnet-architecture/eShopOnContainers/wiki/10.-Setting-the-solution-up-in-AKS-(Azure-Kubernetes-Service)).</span></span>

## <a name="deploy-with-helm-charts-into-kubernetes-clusters"></a><span data-ttu-id="68158-190">Déployer avec des graphiques Helm dans Kubernetes clusters</span><span class="sxs-lookup"><span data-stu-id="68158-190">Deploy with Helm charts into Kubernetes clusters</span></span>

<span data-ttu-id="68158-191">Lorsque vous déployez une application sur un cluster Kubernetes, vous pouvez utiliser la version d’origine `kubectl.exe` outil CLI à l’aide de fichiers de déploiement en fonction du format natif (`.yaml` fichiers), comme déjà mentionné dans la section précédente.</span><span class="sxs-lookup"><span data-stu-id="68158-191">When deploying an application to a Kubernetes cluster, you can use the original `kubectl.exe` CLI tool using deployment files based on the native format (`.yaml` files), as already mentioned in the previous section.</span></span> <span data-ttu-id="68158-192">Toutefois, pour les applications Kubernetes plus complexes, par exemple quand vous déployez des applications de microservices complexes, il est recommandé d’utiliser [Helm](https://helm.sh/).</span><span class="sxs-lookup"><span data-stu-id="68158-192">However, for more complex Kubernetes applications such as when deploying complex microservice-based applications, it's recommended to use [Helm](https://helm.sh/).</span></span>

<span data-ttu-id="68158-193">Graphiques helm vous permet de définir, version, installation, partage, mise à niveau ou même l’application Kubernetes plus complexe de restauration.</span><span class="sxs-lookup"><span data-stu-id="68158-193">Helm Charts helps you define, version, install, share, upgrade, or rollback even the most complex Kubernetes application.</span></span>

<span data-ttu-id="68158-194">De plus, l’utilisation de Helm est également recommandée, car d’autres environnements Kubernetes dans Azure, par exemple [Azure Dev Spaces](https://docs.microsoft.com/azure/dev-spaces/azure-dev-spaces), sont également basés sur des charts Helm.</span><span class="sxs-lookup"><span data-stu-id="68158-194">Going further, Helm usage is also recommended because additional Kubernetes environments in Azure, such as [Azure Dev Spaces](https://docs.microsoft.com/azure/dev-spaces/azure-dev-spaces) are also based on Helm charts.</span></span>

<span data-ttu-id="68158-195">Helm est gérée par le [Foundation de calcul natif Cloud (CNCF)](https://www.cncf.io/) en collaboration avec Microsoft, Google, Bitnami et la Communauté de contributeur de Helm.</span><span class="sxs-lookup"><span data-stu-id="68158-195">Helm is maintained by the [Cloud Native Computing Foundation (CNCF)](https://www.cncf.io/) in collaboration with Microsoft, Google, Bitnami, and the Helm contributor community.</span></span>

<span data-ttu-id="68158-196">Pour plus les informations de mise en œuvre sur les graphiques Helm et Kubernetes, consultez le billet sur [à l’aide de graphiques Helm pour déployer eShopOnContainers sur AKS](https://github.com/dotnet-architecture/eShopOnContainers/wiki/10.1-Deploying-to-AKS-using-Helm-Charts).</span><span class="sxs-lookup"><span data-stu-id="68158-196">For further implementation information on Helm charts and Kubernetes, see the post on [Using Helm Charts to deploy eShopOnContainers to AKS](https://github.com/dotnet-architecture/eShopOnContainers/wiki/10.1-Deploying-to-AKS-using-Helm-Charts).</span></span>

## <a name="use-azure-dev-spaces-for-you-kubernetes-application-lifecycle"></a><span data-ttu-id="68158-197">Utiliser d’espaces de développement Azure pour vous, cycle de vie des applications Kubernetes</span><span class="sxs-lookup"><span data-stu-id="68158-197">Use Azure Dev Spaces for you Kubernetes application lifecycle</span></span>

<span data-ttu-id="68158-198">[Azure Dev Spaces](https://docs.microsoft.com/azure/dev-spaces/azure-dev-spaces) fournit aux équipes une expérience de développement rapide et itérative de Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="68158-198">[Azure Dev Spaces](https://docs.microsoft.com/azure/dev-spaces/azure-dev-spaces) provides a rapid, iterative Kubernetes development experience for teams.</span></span> <span data-ttu-id="68158-199">Avec une configuration minimale de la machine de développement, vous pouvez exécuter et déboguer des conteneurs de manière itérative directement dans AKS (Azure Kubernetes Service).</span><span class="sxs-lookup"><span data-stu-id="68158-199">With minimal dev machine setup, you can iteratively run and debug containers directly in Azure Kubernetes Service (AKS).</span></span> <span data-ttu-id="68158-200">Vous pouvez développer sur Windows, Mac ou Linux à l’aide des outils familiers tels que Visual Studio, Visual Studio Code ou la ligne de commande.</span><span class="sxs-lookup"><span data-stu-id="68158-200">You can develop on Windows, Mac, or Linux using familiar tools like Visual Studio, Visual Studio Code, or the command line.</span></span>

<span data-ttu-id="68158-201">Comme mentionné, espaces de développement Azure utilise des graphiques Helm lors du déploiement d’applications basées sur le conteneur.</span><span class="sxs-lookup"><span data-stu-id="68158-201">As mentioned, Azure Dev Spaces uses Helm charts when deploying container-based applications.</span></span>

<span data-ttu-id="68158-202">Les espaces de développement Azure permettent aux équipes de développement à être plus productifs sur Kubernetes, car il vous permet d’itérer rapidement et de déboguer le code directement dans un cluster Kubernetes global dans Azure en utilisant simplement Visual Studio 2017 ou Visual Studio Code.</span><span class="sxs-lookup"><span data-stu-id="68158-202">Azure Dev Spaces helps development teams be more productive on Kubernetes because it allows you to rapidly iterate and debug code directly in a global Kubernetes cluster in Azure by just using Visual Studio 2017 or Visual Studio Code.</span></span> <span data-ttu-id="68158-203">Ce cluster Kubernetes dans Azure est un cluster Kubernetes managé partagé, ce qui permet à votre équipe de travailler de manière collaborative.</span><span class="sxs-lookup"><span data-stu-id="68158-203">That Kubernetes cluster in Azure is a shared managed Kubernetes cluster, so your team can collaboratively work together.</span></span> <span data-ttu-id="68158-204">Vous pouvez développer votre code de manière isolée, puis le déployer sur le cluster global et effectuer des tests de bout en bout avec d’autres composants sans réplication ou simulation des dépendances.</span><span class="sxs-lookup"><span data-stu-id="68158-204">You can develop your code in isolation, then deploy to the global cluster and do end-to-end testing with other components without replicating or mocking up dependencies.</span></span>

<span data-ttu-id="68158-205">Comme indiqué dans la figure 4-9, la fonctionnalité de différenciation plus dans les espaces de développement Azure est la capacité de la création de « espaces » qui peuvent s’exécuter intégrées au reste du déploiement global dans le cluster.</span><span class="sxs-lookup"><span data-stu-id="68158-205">As shown in figure 4-9, the most differentiating feature in Azure Dev Spaces is the capability of creating 'spaces' that can run integrated to the rest of the global deployment in the cluster.</span></span>

![Azure Dev Spaces peut mélanger et associer de manière transparente des microservices de production à une instance de conteneur de développement pour faciliter le test des nouvelles versions.](media/image38.png)

<span data-ttu-id="68158-207">**Figure 4-9**.</span><span class="sxs-lookup"><span data-stu-id="68158-207">**Figure 4-9**.</span></span> <span data-ttu-id="68158-208">Utilisation de plusieurs espaces dans Azure Dev Spaces</span><span class="sxs-lookup"><span data-stu-id="68158-208">Using multiple spaces in Azure Dev Spaces</span></span>

<span data-ttu-id="68158-209">En fait, vous pouvez configurer un espace de développement partagé dans Azure.</span><span class="sxs-lookup"><span data-stu-id="68158-209">Basically, you can set up a shared dev space in Azure.</span></span> <span data-ttu-id="68158-210">Chaque développeur peut se concentrer simplement sur sa partie de l’application et peut itérativement développer du code « préalable engagée » dans un espace de développement qui contient déjà tous les autres services et ressources qui dépendent leur scénarios de cloud.</span><span class="sxs-lookup"><span data-stu-id="68158-210">Each developer can focus on just their part of the application, and can iteratively develop "pre-committed" code in a dev space that already contains all the other services and cloud resources that their scenarios depend on.</span></span> <span data-ttu-id="68158-211">Les dépendances sont toujours à jour, et les développeurs travaillent comme en production.</span><span class="sxs-lookup"><span data-stu-id="68158-211">Dependencies are always up-to-date, and developers are working in a way that mirrors production.</span></span>

<span data-ttu-id="68158-212">Les espaces de développement Azure propose le concept d’un espace, ce qui vous permet de travailler de manière isolée et sans craindre de perturber les membres de votre équipe.</span><span class="sxs-lookup"><span data-stu-id="68158-212">Azure Dev Spaces provides the concept of a space, which allows you to work in isolation and without the fear of breaking your team members.</span></span> <span data-ttu-id="68158-213">Cette fonctionnalité est basée sur les préfixes d’URL ; Si vous utilisez un préfixe d’espace de développement dans l’URL de demande d’un conteneur, espaces de développement Azure exécute une version spéciale du conteneur dans lequel elle est déployée pour cet espace, s’il en existe.</span><span class="sxs-lookup"><span data-stu-id="68158-213">This feature is based on URL prefixes; if you use a dev space prefix in the URL for a container's request, Azure Dev Spaces runs a special version of the container that it deployed for that space, if one exists.</span></span> <span data-ttu-id="68158-214">Sinon, la version globale/regroupée est exécutée.</span><span class="sxs-lookup"><span data-stu-id="68158-214">Otherwise, it will run the global/consolidated version.</span></span>

<span data-ttu-id="68158-215">Vous pouvez voir le [page de wiki eShopOnContainers sur les espaces de développement Azure](https://github.com/dotnet-architecture/eShopOnContainers/wiki/10.2-Using-Azure-Dev-Spaces-and-AKS) pour obtenir une vue pratique sur un exemple concret.</span><span class="sxs-lookup"><span data-stu-id="68158-215">You can see the [eShopOnContainers wiki page on Azure Dev Spaces](https://github.com/dotnet-architecture/eShopOnContainers/wiki/10.2-Using-Azure-Dev-Spaces-and-AKS) to get a practical view on a concrete example.</span></span>

<span data-ttu-id="68158-216">Pour plus d’informations, consultez l’article sur [développement en équipe avec des espaces de développement Azure](https://docs.microsoft.com/azure/dev-spaces/team-development-netcore).</span><span class="sxs-lookup"><span data-stu-id="68158-216">For further information, see the article on [Team Development with Azure Dev Spaces](https://docs.microsoft.com/azure/dev-spaces/team-development-netcore).</span></span>

## <a name="additional-resources"></a><span data-ttu-id="68158-217">Ressources supplémentaires</span><span class="sxs-lookup"><span data-stu-id="68158-217">Additional resources</span></span>

- <span data-ttu-id="68158-218">**Bien démarrer avec AKS (Azure Kubernetes Service)** \\</span><span class="sxs-lookup"><span data-stu-id="68158-218">**Getting started with Azure Kubernetes Service (AKS)** \\</span></span>
  [https://docs.microsoft.com/azure/aks/kubernetes-walkthrough-portal](https://docs.microsoft.com/azure/aks/kubernetes-walkthrough-portal)

- <span data-ttu-id="68158-219">**Azure Dev Spaces** \\</span><span class="sxs-lookup"><span data-stu-id="68158-219">**Azure Dev Spaces** \\</span></span>
  [https://docs.microsoft.com/azure/dev-spaces/azure-dev-spaces](https://docs.microsoft.com/azure/dev-spaces/azure-dev-spaces)

- <span data-ttu-id="68158-220">**Kubernetes.**</span><span class="sxs-lookup"><span data-stu-id="68158-220">**Kubernetes.**</span></span> <span data-ttu-id="68158-221">Le site officiel.</span><span class="sxs-lookup"><span data-stu-id="68158-221">The official site.</span></span> \
  [https://kubernetes.io/](https://kubernetes.io/)

## <a name="using-azure-service-fabric"></a><span data-ttu-id="68158-222">Utilisation d’Azure Service Fabric</span><span class="sxs-lookup"><span data-stu-id="68158-222">Using Azure Service Fabric</span></span>

<span data-ttu-id="68158-223">Azure Service Fabric a été créée à partir de la transition de Microsoft à partir de la distribution de produits « boîte », généralement de style monolithique, à la prestation de services.</span><span class="sxs-lookup"><span data-stu-id="68158-223">Azure Service Fabric arose from Microsoft's transition from delivering "box" products, which were typically monolithic in style, to delivering services.</span></span> <span data-ttu-id="68158-224">L’expérience de création et l’exploitation des services à grande échelle, telles que la base de données SQL Azure, Azure Cosmos DB, Azure Service Bus ou Backend de Cortana, en forme de Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="68158-224">The experience of building and operating large services at scale, such as Azure SQL Database, Azure Cosmos DB, Azure Service Bus, or Cortana's Backend, shaped Service Fabric.</span></span> <span data-ttu-id="68158-225">La plateforme a évolué au fil du temps car de plus en plus de services l’ont adoptée.</span><span class="sxs-lookup"><span data-stu-id="68158-225">The platform evolved over time as more and more services adopted it.</span></span> <span data-ttu-id="68158-226">Surtout, Service Fabric devait s’exécuter non seulement dans Azure, mais également dans des déploiements de Windows Server autonomes.</span><span class="sxs-lookup"><span data-stu-id="68158-226">Importantly, Service Fabric had to run not only in Azure but also in standalone Windows Server deployments.</span></span>

<span data-ttu-id="68158-227">L’objectif de Service Fabric est de résoudre les difficiles problèmes de la création et de l’exécution d’un service, et de l’utilisation efficace des ressources de l’infrastructure, afin que les équipes puissent solutionner les problèmes métier en utilisant une approche par microservices.</span><span class="sxs-lookup"><span data-stu-id="68158-227">The aim of Service Fabric is to solve the hard problems of building and running a service and utilizing infrastructure resources efficiently, so that teams can solve business problems using a microservices approach.</span></span>

<span data-ttu-id="68158-228">Service Fabric fournit deux grands composants principaux pour vous aider à créer des applications qui utilisent une approche par microservices :</span><span class="sxs-lookup"><span data-stu-id="68158-228">Service Fabric provides two broad areas to help you build applications that use a microservices approach:</span></span>

- <span data-ttu-id="68158-229">Une plateforme qui fournit des services système pour déployer, mettre à l’échelle, mettre à niveau, détecter et redémarrer les services ayant connu une défaillance, découvrir l’emplacement des services, gérer les états et surveiller l’intégrité.</span><span class="sxs-lookup"><span data-stu-id="68158-229">A platform that provides system services to deploy, scale, upgrade, detect, and restart failed services, discover service location, manage state, and monitor health.</span></span> <span data-ttu-id="68158-230">Ces services système permettent de mettre en œuvre de nombreuses caractéristiques des microservices décrites précédemment.</span><span class="sxs-lookup"><span data-stu-id="68158-230">These system services in effect enable many of the characteristics of microservices described previously.</span></span>

- <span data-ttu-id="68158-231">Des API de programmation, ou frameworks, pour vous aider à créer des applications en tant que microservices : [des acteurs fiables et des services fiables](https://docs.microsoft.com/azure/service-fabric/service-fabric-choose-framework).</span><span class="sxs-lookup"><span data-stu-id="68158-231">Programming APIs, or frameworks, to help you build applications as microservices: [reliable actors and reliable services](https://docs.microsoft.com/azure/service-fabric/service-fabric-choose-framework).</span></span> <span data-ttu-id="68158-232">Vous pouvez choisir n’importe quel code pour générer votre microservice, mais ces API vous facilitent le travail et s’intègrent à la plateforme de façon plus étroite.</span><span class="sxs-lookup"><span data-stu-id="68158-232">You can choose any code to build your microservice, but these APIs make the job more straightforward, and they integrate with the platform at a deeper level.</span></span> <span data-ttu-id="68158-233">De cette manière, vous pouvez obtenir des informations sur l’intégrité et les diagnostics, ou vous pouvez bénéficier d’une gestion fiable des états.</span><span class="sxs-lookup"><span data-stu-id="68158-233">This way you can get health and diagnostics information, or you can take advantage of reliable state management.</span></span>

<span data-ttu-id="68158-234">Service Fabric est agnostique quant à la façon dont vous créez votre service, et vous pouvez utiliser n’importe quelle technologie.</span><span class="sxs-lookup"><span data-stu-id="68158-234">Service Fabric is agnostic with respect to how you build your service, and you can use any technology.</span></span> <span data-ttu-id="68158-235">Il fournit cependant des API de programmation intégrées qui facilitent la création de microservices.</span><span class="sxs-lookup"><span data-stu-id="68158-235">However, it provides built-in programming APIs that make it easier to build microservices.</span></span>

<span data-ttu-id="68158-236">Comme indiqué dans la Figure 4-10, vous pouvez créer et exécuter des microservices dans Service Fabric en tant que processus simples ou en tant que conteneurs Docker.</span><span class="sxs-lookup"><span data-stu-id="68158-236">As shown in Figure 4-10, you can create and run microservices in Service Fabric either as simple processes or as Docker containers.</span></span> <span data-ttu-id="68158-237">Il est également possible de combiner des microservices basés sur des conteneurs avec des microservices basés sur des processus dans le même cluster Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="68158-237">It's also possible to mix container-based microservices with process-based microservices within the same Service Fabric cluster.</span></span>

![Comparaison d’Azure service Fabric clusters : Microservices en tant que processus où chaque nœud exécute un processus pour chaque microservice ; Microservices en tant que conteneurs où chaque nœud exécute Docker avec plusieurs conteneurs, un conteneur par microservice.](./media/azure-service-fabric-cluster-types.png)

<span data-ttu-id="68158-239">**Figure 4-10**.</span><span class="sxs-lookup"><span data-stu-id="68158-239">**Figure 4-10**.</span></span> <span data-ttu-id="68158-240">Déploiement de microservices en tant que processus ou en tant que conteneurs dans Azure Service Fabric</span><span class="sxs-lookup"><span data-stu-id="68158-240">Deploying microservices as processes or as containers in Azure Service Fabric</span></span>

<span data-ttu-id="68158-241">Les clusters Service Fabric basés sur des hôtes Linux et Windows peuvent exécuter des conteneurs Linux Docker et des conteneurs Windows, respectivement.</span><span class="sxs-lookup"><span data-stu-id="68158-241">Service Fabric clusters based on Linux and Windows hosts can run Docker Linux containers and Windows Containers, respectively.</span></span>

<span data-ttu-id="68158-242">Pour obtenir des informations récentes sur la prise en charge des conteneurs dans Azure Service Fabric, consultez [Service Fabric et les conteneurs](https://docs.microsoft.com/azure/service-fabric/service-fabric-containers-overview).</span><span class="sxs-lookup"><span data-stu-id="68158-242">For up-to-date information about containers support in Azure Service Fabric, see [Service Fabric and containers](https://docs.microsoft.com/azure/service-fabric/service-fabric-containers-overview).</span></span>

<span data-ttu-id="68158-243">Service Fabric est un bon exemple d’une plateforme où vous pouvez définir une architecture logique (microservices métier ou contextes délimités) que l’implémentation physique.</span><span class="sxs-lookup"><span data-stu-id="68158-243">Service Fabric is a good example of a platform where you can define a different logical architecture (business microservices or Bounded Contexts) than the physical implementation.</span></span> <span data-ttu-id="68158-244">Par exemple, si vous implémentez [Reliable Services avec état](https://docs.microsoft.com/azure/service-fabric/service-fabric-reliable-services-introduction) dans [Azure Service Fabric](https://docs.microsoft.com/azure/service-fabric/service-fabric-overview), qui sont présentés dans la section suivante, «[sans état et les microservices avec état](#stateless-versus-stateful-microservices), « vous avez un concept de microservice métier avec plusieurs services physiques.</span><span class="sxs-lookup"><span data-stu-id="68158-244">For example, if you implement [Stateful Reliable Services](https://docs.microsoft.com/azure/service-fabric/service-fabric-reliable-services-introduction) in [Azure Service Fabric](https://docs.microsoft.com/azure/service-fabric/service-fabric-overview), which are introduced in the next section, "[Stateless versus stateful microservices](#stateless-versus-stateful-microservices)," you have a business microservice concept with multiple physical services.</span></span>

<span data-ttu-id="68158-245">Comme indiqué dans la Figure 4-10, en adoptant une perspective de microservice logique/métier, lors de l’implémentation d’un Service avec état fiable Service Fabric, vous doit généralement implémenter deux niveaux de services.</span><span class="sxs-lookup"><span data-stu-id="68158-245">As shown in Figure 4-10, and thinking from a logical/business microservice perspective, when implementing a Service Fabric Stateful Reliable Service, you usually will need to implement two tiers of services.</span></span> <span data-ttu-id="68158-246">Le premier est le service fiable avec état backend, qui gère plusieurs partitions (chaque partition est un service avec état).</span><span class="sxs-lookup"><span data-stu-id="68158-246">The first is the back-end stateful reliable service, which handles multiple partitions (each partition is a stateful service).</span></span> <span data-ttu-id="68158-247">Le second est le service frontal, ou service de passerelle, en charge du routage et de l’agrégation des données entre plusieurs partitions ou instances de service avec état.</span><span class="sxs-lookup"><span data-stu-id="68158-247">The second is the front-end service, or Gateway service, in charge of routing and data aggregation across multiple partitions or stateful service instances.</span></span> <span data-ttu-id="68158-248">Ce service de passerelle gère également la communication côté client avec des boucles de nouvelles tentatives pour l’accès au service back-end.</span><span class="sxs-lookup"><span data-stu-id="68158-248">That Gateway service also handles client-side communication with retry loops accessing the back-end service.</span></span> <span data-ttu-id="68158-249">Il est appelé service de passerelle si vous implémentez votre service personnalisé. Toutefois, vous pouvez également utiliser le [proxy inverse](https://docs.microsoft.com/azure/service-fabric/service-fabric-reverseproxy) fourni avec Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="68158-249">It's called a Gateway service if you implement your custom service, or alternatively you can also use the out-of-the-box Service Fabric [reverse proxy](https://docs.microsoft.com/azure/service-fabric/service-fabric-reverseproxy).</span></span>

![Service Fabric a prescription pour prendre en charge plusieurs services fiables avec état dans des conteneurs.](./media/service-fabric-stateful-business-microservice.png)

<span data-ttu-id="68158-251">**Figure 4-11**.</span><span class="sxs-lookup"><span data-stu-id="68158-251">**Figure 4-11**.</span></span> <span data-ttu-id="68158-252">Microservice métier avec plusieurs instances de service avec état et un front-end de passerelle personnalisée</span><span class="sxs-lookup"><span data-stu-id="68158-252">Business microservice with several stateful service instances and a custom gateway front end</span></span>

<span data-ttu-id="68158-253">Dans tous les cas, lorsque vous utilisez Service Fabric Stateful Reliable Services, vous avez également un microservice (contexte délimité) logique ou métier qui se compose de plusieurs services physiques.</span><span class="sxs-lookup"><span data-stu-id="68158-253">In any case, when you use Service Fabric Stateful Reliable Services, you also have a logical or business microservice (Bounded Context) that's composed of multiple physical services.</span></span> <span data-ttu-id="68158-254">Chacun d’eux, service de passerelle et service de Partition peut être implémentée en tant que services API Web ASP.NET, comme illustré dans la Figure 4-11.</span><span class="sxs-lookup"><span data-stu-id="68158-254">Each of them, the Gateway service, and Partition service could be implemented as ASP.NET Web API services, as shown in Figure 4-11.</span></span>

<span data-ttu-id="68158-255">Dans Service Fabric, vous pouvez regrouper et déployer des groupes de services sous la forme d’une [application Service Fabric](https://docs.microsoft.com/azure/service-fabric/service-fabric-application-model), qui est l’unité d’empaquetage et de déploiement pour l’orchestrateur ou le cluster.</span><span class="sxs-lookup"><span data-stu-id="68158-255">In Service Fabric, you can group and deploy groups of services as a [Service Fabric Application](https://docs.microsoft.com/azure/service-fabric/service-fabric-application-model), which is the unit of packaging and deployment for the orchestrator or cluster.</span></span> <span data-ttu-id="68158-256">Ainsi, l’application Service Fabric peut également être mappée à cette limite de microservice logique et métier autonome (ou contexte délimité) : vous pouvez donc déployer ces services de façon autonome.</span><span class="sxs-lookup"><span data-stu-id="68158-256">Therefore, the Service Fabric Application could be mapped to this autonomous business and logical microservice boundary or Bounded Context, as well, so you could deploy these services autonomously.</span></span>

### <a name="service-fabric-and-containers"></a><span data-ttu-id="68158-257">Service Fabric et les conteneurs</span><span class="sxs-lookup"><span data-stu-id="68158-257">Service Fabric and containers</span></span>

<span data-ttu-id="68158-258">Pour ce qui est des conteneurs dans Service Fabric, vous pouvez également déployer des services dans des images de conteneur au sein d’un cluster Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="68158-258">With regard to containers in Service Fabric, you can also deploy services in container images within a Service Fabric cluster.</span></span> <span data-ttu-id="68158-259">Comme le montre la Figure 4-12, la plupart du temps il sera uniquement un conteneur par service.</span><span class="sxs-lookup"><span data-stu-id="68158-259">As Figure 4-12 shows, most of the time there will only be one container per service.</span></span>

![Une application Service Fabric peut exécuter plusieurs conteneurs de l’accès à une base de données externe et l’ensemble serait la limite logique d’un Microservice d’entreprise](./media/azure-service-fabric-business-microservice.png)

<span data-ttu-id="68158-261">**Figure 4-12**.</span><span class="sxs-lookup"><span data-stu-id="68158-261">**Figure 4-12**.</span></span> <span data-ttu-id="68158-262">Microservice métier avec plusieurs services (conteneurs) dans Service Fabric</span><span class="sxs-lookup"><span data-stu-id="68158-262">Business microservice with several services (containers) in Service Fabric</span></span>

<span data-ttu-id="68158-263">Toutefois, les conteneurs appelés conteneurs « sidecar » (deux conteneurs qui doivent être déployés ensemble dans le cadre d’un service logique) sont également possibles dans Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="68158-263">However, so-called "sidecar" containers (two containers that must be deployed together as part of a logical service) are also possible in Service Fabric.</span></span> <span data-ttu-id="68158-264">Le point essentiel est qu’un microservice métier est la limite logique autour de plusieurs éléments cohésifs.</span><span class="sxs-lookup"><span data-stu-id="68158-264">The important thing is that a business microservice is the logical boundary around several cohesive elements.</span></span> <span data-ttu-id="68158-265">Dans de nombreux cas, il peut s’agit d’un seul service avec un seul modèle de données, mais dans d’autres cas, vous pouvez également avoir plusieurs services physiques.</span><span class="sxs-lookup"><span data-stu-id="68158-265">In many cases, it might be a single service with a single data model, but in some other cases you might have several physical services as well.</span></span>

<span data-ttu-id="68158-266">Notez que vous pouvez combiner des services de processus et les services dans des conteneurs, dans la même application Service Fabric, comme illustré dans la Figure 4-13.</span><span class="sxs-lookup"><span data-stu-id="68158-266">Note that you can mix services in processes, and services in containers, in the same Service Fabric application, as shown in Figure 4-13.</span></span>

![Une application service fabric en cours d’exécution des services et des conteneurs dans le même nœud.](./media/business-microservice-mapped-to-service-fabric-application.png)

<span data-ttu-id="68158-268">**Figure 4-13**.</span><span class="sxs-lookup"><span data-stu-id="68158-268">**Figure 4-13**.</span></span> <span data-ttu-id="68158-269">Microservice métier mappé à une application Service Fabric avec des conteneurs et des services avec état</span><span class="sxs-lookup"><span data-stu-id="68158-269">Business microservice mapped to a Service Fabric application with containers and stateful services</span></span>

<span data-ttu-id="68158-270">Pour plus informations sur la prise en charge des conteneurs dans Azure Service Fabric, consultez [Service Fabric et les conteneurs](https://docs.microsoft.com/azure/service-fabric/service-fabric-containers-overview).</span><span class="sxs-lookup"><span data-stu-id="68158-270">For more information about container support in Azure Service Fabric, see [Service Fabric and containers](https://docs.microsoft.com/azure/service-fabric/service-fabric-containers-overview).</span></span>

## <a name="stateless-versus-stateful-microservices"></a><span data-ttu-id="68158-271">Microservices sans état et avec état</span><span class="sxs-lookup"><span data-stu-id="68158-271">Stateless versus stateful microservices</span></span>

<span data-ttu-id="68158-272">Comme mentionné précédemment, chaque microservice (contexte délimité logique) doit avoir son modèle de domaine (données et logique).</span><span class="sxs-lookup"><span data-stu-id="68158-272">As mentioned earlier, each microservice (logical Bounded Context) must own its domain model (data and logic).</span></span> <span data-ttu-id="68158-273">Dans le cas de microservices sans état, les bases de données sont externes et utilisent des options relationnelles (par exemple SQL Server), ou des options NoSQL (par exemple Azure Cosmos DB ou MongoDB).</span><span class="sxs-lookup"><span data-stu-id="68158-273">In the case of stateless microservices, the databases will be external, employing relational options like SQL Server, or NoSQL options like Azure Cosmos DB or MongoDB.</span></span>

<span data-ttu-id="68158-274">Cependant, les services eux-mêmes peuvent également être avec état dans Service Fabric, ce qui signifie que les données se trouvent dans le microservice.</span><span class="sxs-lookup"><span data-stu-id="68158-274">But the services themselves can also be stateful in Service Fabric, which means that the data resides within the microservice.</span></span> <span data-ttu-id="68158-275">Ces données peuvent exister non seulement sur le même serveur, mais aussi dans le processus du microservice et en mémoire, et être conservées sur des disques durs et répliquées sur d’autres nœuds.</span><span class="sxs-lookup"><span data-stu-id="68158-275">This data might exist not just on the same server, but within the microservice process, in memory and persisted on hard drives and replicated to other nodes.</span></span> <span data-ttu-id="68158-276">La figure 4-30 montre les différentes approches.</span><span class="sxs-lookup"><span data-stu-id="68158-276">Figure 4-30 shows the different approaches.</span></span>

![Dans les services sans état, l’état (persistance, base de données) est conservé hors du microservice.](./media/stateless-vs-stateful-microservices.png)

<span data-ttu-id="68158-279">**Figure 4-14**.</span><span class="sxs-lookup"><span data-stu-id="68158-279">**Figure 4-14**.</span></span> <span data-ttu-id="68158-280">Microservices sans état et avec état</span><span class="sxs-lookup"><span data-stu-id="68158-280">Stateless versus stateful microservices</span></span>

<span data-ttu-id="68158-281">Une approche sans état est parfaitement valide et est plus facile à implémenter que des microservices avec état, car cette approche est similaire aux modèles traditionnels bien connus.</span><span class="sxs-lookup"><span data-stu-id="68158-281">A stateless approach is perfectly valid and is easier to implement than stateful microservices, since the approach is similar to traditional and well-known patterns.</span></span> <span data-ttu-id="68158-282">Les microservices sans état imposent cependant de la latence entre les processus et les sources de données.</span><span class="sxs-lookup"><span data-stu-id="68158-282">But stateless microservices impose latency between the process and data sources.</span></span> <span data-ttu-id="68158-283">Ils impliquent également le déplacement d’un plus grand nombre d’éléments quand vous essayez d’améliorer le niveau de performance avec des caches et des files d’attente supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="68158-283">They also involve more moving pieces when you're trying to improve performance with additional cache and queues.</span></span> <span data-ttu-id="68158-284">Le résultat est que vous pouvez vous retrouver avec des architectures complexes qui ont trop de niveaux.</span><span class="sxs-lookup"><span data-stu-id="68158-284">The result is that you can end up with complex architectures that have too many tiers.</span></span>

<span data-ttu-id="68158-285">En revanche, les [microservices avec état](https://docs.microsoft.com/azure/service-fabric/service-fabric-reliable-services-introduction#when-to-use-reliable-services-apis) peuvent exceller dans les scénarios avancés, car il n’existe aucune latence entre la logique et les données du domaine.</span><span class="sxs-lookup"><span data-stu-id="68158-285">In contrast, [stateful microservices](https://docs.microsoft.com/azure/service-fabric/service-fabric-reliable-services-introduction#when-to-use-reliable-services-apis) can excel in advanced scenarios, because there's no latency between the domain logic and data.</span></span> <span data-ttu-id="68158-286">Les traitements de données lourds, les back-end de jeux, les bases de données en tant que service et tous les autres scénarios avec une latence faible tirent parti des services avec état, qui permettent un état local pour un accès plus rapide.</span><span class="sxs-lookup"><span data-stu-id="68158-286">Heavy data processing, gaming back ends, databases as a service, and other low-latency scenarios all benefit from stateful services, which enable local state for faster access.</span></span>

<span data-ttu-id="68158-287">Les services sans état et avec état sont complémentaires.</span><span class="sxs-lookup"><span data-stu-id="68158-287">Stateless and stateful services are complementary.</span></span> <span data-ttu-id="68158-288">Par exemple, comme vous pouvez le voir dans le diagramme de droite dans la Figure 4-31, un service avec état peut être fractionné en plusieurs partitions.</span><span class="sxs-lookup"><span data-stu-id="68158-288">For instance, as you can see in the right diagram in Figure 4-31, a stateful service can be split into multiple partitions.</span></span> <span data-ttu-id="68158-289">Pour accéder à ces partitions, vous pouvez avoir besoin d’un service sans état agissant comme un service de passerelle, qui sait comment atteindre chaque partition en fonction de clés de partition.</span><span class="sxs-lookup"><span data-stu-id="68158-289">To access those partitions, you might need a stateless service acting as a gateway service that knows how to address each partition based on partition keys.</span></span>

<span data-ttu-id="68158-290">Les services avec état présentent des inconvénients.</span><span class="sxs-lookup"><span data-stu-id="68158-290">Stateful services do have drawbacks.</span></span> <span data-ttu-id="68158-291">Ils imposent un niveau de complexité élevée pour être mis à l’échelle. Les fonctionnalités qui seraient habituellement implémentées par des systèmes de base de données externes doivent être fournies pour des tâches comme la réplication des données entre des microservices avec état et le partitionnement des données.</span><span class="sxs-lookup"><span data-stu-id="68158-291">They impose a high complexity level to be scaled out. Functionality that would usually be implemented by external database systems must be addressed for tasks such as data replication across stateful microservices and data partitioning.</span></span> <span data-ttu-id="68158-292">C’est un des domaines où un orchestrateur comme [Azure Service Fabric](https://docs.microsoft.com/azure/service-fabric/service-fabric-reliable-services-platform-architecture) avec ses [services fiables avec état](https://docs.microsoft.com/azure/service-fabric/service-fabric-reliable-services-introduction#when-to-use-reliable-services-apis) peut être le plus utile, en simplifiant le développement et le cycle de vie des microservices avec état grâce à [l’API Reliable Services](https://docs.microsoft.com/azure/service-fabric/service-fabric-work-with-reliable-collections) et [Reliable Actors](https://docs.microsoft.com/azure/service-fabric/service-fabric-reliable-actors-introduction).</span><span class="sxs-lookup"><span data-stu-id="68158-292">However, this is one of the areas where an orchestrator like [Azure Service Fabric](https://docs.microsoft.com/azure/service-fabric/service-fabric-reliable-services-platform-architecture) with its [stateful reliable services](https://docs.microsoft.com/azure/service-fabric/service-fabric-reliable-services-introduction#when-to-use-reliable-services-apis) can help the most—by simplifying the development and lifecycle of stateful microservices using the [Reliable Services API](https://docs.microsoft.com/azure/service-fabric/service-fabric-work-with-reliable-collections) and [Reliable Actors](https://docs.microsoft.com/azure/service-fabric/service-fabric-reliable-actors-introduction).</span></span>

<span data-ttu-id="68158-293">Les autres frameworks de microservices qui permettent les services avec état, qui prennent en charge le modèle d’acteur et qui améliorent la tolérance de panne et la latence entre la logique métier et les données sont Microsoft [Orléans](https://github.com/dotnet/orleans) de Microsoft Research et [Akka.NET](https://getakka.net/).</span><span class="sxs-lookup"><span data-stu-id="68158-293">Other microservice frameworks that allow stateful services, that support the Actor pattern, and that improve fault tolerance and latency between business logic and data are Microsoft [Orleans](https://github.com/dotnet/orleans), from Microsoft Research, and [Akka.NET](https://getakka.net/).</span></span> <span data-ttu-id="68158-294">Les deux frameworks améliorent actuellement leur prise en charge de Docker.</span><span class="sxs-lookup"><span data-stu-id="68158-294">Both frameworks are currently improving their support for Docker.</span></span>

<span data-ttu-id="68158-295">N’oubliez pas que les conteneurs Docker sont eux-mêmes sans état.</span><span class="sxs-lookup"><span data-stu-id="68158-295">Remember that Docker containers are themselves stateless.</span></span> <span data-ttu-id="68158-296">Si vous voulez implémenter un service avec état, vous avez besoin d’un des frameworks normatifs et de plus haut niveau supplémentaires précédemment indiqués.</span><span class="sxs-lookup"><span data-stu-id="68158-296">If you want to implement a stateful service, you need one of the additional prescriptive and higher-level frameworks noted earlier.</span></span>

## <a name="using-azure-service-fabric-mesh"></a><span data-ttu-id="68158-297">Utilisation d’Azure Service Fabric Mesh</span><span class="sxs-lookup"><span data-stu-id="68158-297">Using Azure Service Fabric Mesh</span></span>

<span data-ttu-id="68158-298">Maillage de Azure Service Fabric est un service entièrement géré qui permet aux développeurs de créer et déployer des applications de grande envergure sans la gestion des infrastructures.</span><span class="sxs-lookup"><span data-stu-id="68158-298">Azure Service Fabric Mesh is a fully managed service that enables developers to build and deploy mission critical applications without managing any infrastructure.</span></span> <span data-ttu-id="68158-299">Utilisez Service Fabric Mesh pour générer et exécuter des applications de microservices sécurisées, distribuées et scalables à la demande.</span><span class="sxs-lookup"><span data-stu-id="68158-299">Use Service Fabric Mesh to build and run secure, distributed microservices applications that scale on demand.</span></span>

<span data-ttu-id="68158-300">Comme indiqué dans la figure 4-15, applications hébergées sur le maillage de Service Fabric exécuter et mettre à l’échelle sans vous soucier de l’infrastructure de mise sous tension d’elle.</span><span class="sxs-lookup"><span data-stu-id="68158-300">As shown in figure 4-15, applications hosted on Service Fabric Mesh run and scale without you worrying about the infrastructure powering it.</span></span>

![Une application de plusieurs conteneurs s’exécutant dans le bureau de Docker peut être déployée vers Azure Service Fabric Mesh sans vous soucier d’infrastructure.](media/image39.png)

<span data-ttu-id="68158-302">**Figure 4-15**.</span><span class="sxs-lookup"><span data-stu-id="68158-302">**Figure 4-15**.</span></span> <span data-ttu-id="68158-303">Déploiement d’une application basée sur des microservices/conteneurs sur Service Fabric Mesh</span><span class="sxs-lookup"><span data-stu-id="68158-303">Deploying a microservice/containers application to Service Fabric Mesh</span></span>

<span data-ttu-id="68158-304">Service Fabric Mesh est constitué de clusters de milliers de machines.</span><span class="sxs-lookup"><span data-stu-id="68158-304">Under the covers, Service Fabric Mesh consists of clusters of thousands of machines.</span></span> <span data-ttu-id="68158-305">Toutes les opérations de cluster sont masquées pour le développeur.</span><span class="sxs-lookup"><span data-stu-id="68158-305">All cluster operations are hidden from the developer.</span></span> <span data-ttu-id="68158-306">Il vous suffit simplement de charger vos conteneurs et de spécifier les ressources nécessaires, leurs exigences de disponibilité et leurs limites.</span><span class="sxs-lookup"><span data-stu-id="68158-306">You simply need to upload your containers and specify resources you need, availability requirements, and resource limits.</span></span> <span data-ttu-id="68158-307">Service Fabric Mesh alloue automatiquement l’infrastructure nécessaire au déploiement de votre application. Il gère également les défaillances de l’infrastructure, ce qui permet ainsi de garantir la haute disponibilité de vos applications.</span><span class="sxs-lookup"><span data-stu-id="68158-307">Service Fabric Mesh automatically allocates the infrastructure requested by your application deployment and also handles infrastructure failures, making sure your applications are highly available.</span></span> <span data-ttu-id="68158-308">Vous devez uniquement vous soucier de l’intégrité et de la réactivité de votre application, et non de l’infrastructure.</span><span class="sxs-lookup"><span data-stu-id="68158-308">You only need to care about the health and responsiveness of your application, not the infrastructure.</span></span>

<span data-ttu-id="68158-309">Pour plus d’informations, consultez le [documentation Service Fabric Mesh](https://docs.microsoft.com/azure/service-fabric-mesh/).</span><span class="sxs-lookup"><span data-stu-id="68158-309">For further information, see the [Service Fabric Mesh documentation](https://docs.microsoft.com/azure/service-fabric-mesh/).</span></span>

## <a name="choosing-orchestrators-in-azure"></a><span data-ttu-id="68158-310">Choix des orchestrateurs dans Azure</span><span class="sxs-lookup"><span data-stu-id="68158-310">Choosing orchestrators in Azure</span></span>

<span data-ttu-id="68158-311">Le tableau suivant fournit une aide sur le type d’orchestrateur à utiliser en fonction des charges de travail et du focus du système d’exploitation.</span><span class="sxs-lookup"><span data-stu-id="68158-311">The following table provides guidance on what orchestrator to use depending on workloads and OS focus.</span></span>

![Services Kubernetes Azure est plus mature dans Linux que dans Windows et est principalement utilisé pour le déploiement de microservices basées sur les conteneurs.](media/image40.png)

<span data-ttu-id="68158-314">**Figure 4-16**.</span><span class="sxs-lookup"><span data-stu-id="68158-314">**Figure 4-16**.</span></span> <span data-ttu-id="68158-315">Sélection de l’orchestrateur dans l’aide d’Azure</span><span class="sxs-lookup"><span data-stu-id="68158-315">Orchestrator selection in Azure guidance</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="68158-316">[Précédent](soa-applications.md)
>[Suivant](deploy-azure-kubernetes-service.md)</span><span class="sxs-lookup"><span data-stu-id="68158-316">[Previous](soa-applications.md)
[Next](deploy-azure-kubernetes-service.md)</span></span>
