---
title: Écriture des attributs personnalisés
ms.date: 07/17/2018
ms.technology: dotnet-standard
dev_langs:
- csharp
- vb
- cpp
helpviewer_keywords:
- multiple attribute instances
- AttributeTargets enumeration
- attributes [.NET Framework], custom
- AllowMultiple property
- custom attributes
- AttributeUsageAttribute class, custom attributes
- Inherited property
- attribute classes, declaring
ms.assetid: 97216f69-bde8-49fd-ac40-f18c500ef5dc
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: 114d24c1fc523d5501deb4aa17f9541c5a918276
ms.sourcegitcommit: c66ba2df2d2ecfb214f85ee0687d298e4941c1a8
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/14/2018
ms.locfileid: "33574645"
---
# <a name="writing-custom-attributes"></a><span data-ttu-id="79d0a-102">Écriture des attributs personnalisés</span><span class="sxs-lookup"><span data-stu-id="79d0a-102">Writing Custom Attributes</span></span>
<span data-ttu-id="79d0a-103">Pour concevoir vos propres attributs personnalisés, vous n’avez pas besoin de maîtriser les nombreux nouveaux concepts.</span><span class="sxs-lookup"><span data-stu-id="79d0a-103">To design your own custom attributes, you do not need to master many new concepts.</span></span> <span data-ttu-id="79d0a-104">Si vous êtes familiarisé avec la programmation orientée objet et savez concevoir des classes, vous possédez déjà la plupart des connaissances nécessaires.</span><span class="sxs-lookup"><span data-stu-id="79d0a-104">If you are familiar with object-oriented programming and know how to design classes, you already have most of the knowledge needed.</span></span> <span data-ttu-id="79d0a-105">Les attributs personnalisés sont essentiellement des classes traditionnelles qui dérivent directement ou indirectement de <xref:System.Attribute?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="79d0a-105">Custom attributes are essentially traditional classes that derive directly or indirectly from <xref:System.Attribute?displayProperty=nameWithType>.</span></span> <span data-ttu-id="79d0a-106">Tout comme les classes traditionnelles, les attributs personnalisés contiennent des méthodes qui stockent et récupèrent les données.</span><span class="sxs-lookup"><span data-stu-id="79d0a-106">Just like traditional classes, custom attributes contain methods that store and retrieve data.</span></span>  
  
 <span data-ttu-id="79d0a-107">Les principales étapes permettant de concevoir correctement des classes d’attributs personnalisés sont les suivantes :</span><span class="sxs-lookup"><span data-stu-id="79d0a-107">The primary steps to properly design custom attribute classes are as follows:</span></span>  
  
- [<span data-ttu-id="79d0a-108">Application d’AttributeUsageAttribute</span><span class="sxs-lookup"><span data-stu-id="79d0a-108">Applying the AttributeUsageAttribute</span></span>](#applying-the-attributeusageattribute)  
  
- [<span data-ttu-id="79d0a-109">Déclaration de la classe d’attributs</span><span class="sxs-lookup"><span data-stu-id="79d0a-109">Declaring the attribute class</span></span>](#declaring-the-attribute-class)  
  
- [<span data-ttu-id="79d0a-110">Déclaration des constructeurs</span><span class="sxs-lookup"><span data-stu-id="79d0a-110">Declaring constructors</span></span>](#declaring-constructors)  
  
- [<span data-ttu-id="79d0a-111">Déclaration des propriétés</span><span class="sxs-lookup"><span data-stu-id="79d0a-111">Declaring properties</span></span>](#declaring-properties)  
  
 <span data-ttu-id="79d0a-112">Cette section décrit chacune de ces étapes et se termine par un [exemple d’attribut personnalisé](#custom-attribute-example).</span><span class="sxs-lookup"><span data-stu-id="79d0a-112">This section describes each of these steps and concludes with a [custom attribute example](#custom-attribute-example).</span></span>  
  
## <a name="applying-the-attributeusageattribute"></a><span data-ttu-id="79d0a-113">Application d’AttributeUsageAttribute</span><span class="sxs-lookup"><span data-stu-id="79d0a-113">Applying the AttributeUsageAttribute</span></span>  
 <span data-ttu-id="79d0a-114">Une déclaration d’attribut personnalisé commence par <xref:System.AttributeUsageAttribute?displayProperty=nameWithType>, qui définit certaines caractéristiques clés de votre classe d’attributs.</span><span class="sxs-lookup"><span data-stu-id="79d0a-114">A custom attribute declaration begins with the <xref:System.AttributeUsageAttribute?displayProperty=nameWithType>, which defines some of the key characteristics of your attribute class.</span></span> <span data-ttu-id="79d0a-115">Par exemple, vous pouvez spécifier si votre attribut peut être hérité par d’autres classes ou spécifier les éléments auxquels l’attribut peut être appliqué.</span><span class="sxs-lookup"><span data-stu-id="79d0a-115">For example, you can specify whether your attribute can be inherited by other classes or specify which elements the attribute can be applied to.</span></span> <span data-ttu-id="79d0a-116">Le fragment de code suivant montre comment utiliser l’attribut <xref:System.AttributeUsageAttribute>.</span><span class="sxs-lookup"><span data-stu-id="79d0a-116">The following code fragment demonstrates how to use the <xref:System.AttributeUsageAttribute>.</span></span>  
  
 [!code-cpp[Conceptual.Attributes.Usage#5](../../../samples/snippets/cpp/VS_Snippets_CLR/conceptual.attributes.usage/cpp/source2.cpp#5)]
 [!code-csharp[Conceptual.Attributes.Usage#5](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.attributes.usage/cs/source2.cs#5)]
 [!code-vb[Conceptual.Attributes.Usage#5](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.attributes.usage/vb/source2.vb#5)]  
  
 <span data-ttu-id="79d0a-117"><xref:System.AttributeUsageAttribute> possède trois membres importants pour la création d’attributs personnalisés : [AttributeTargets](#attributetargets-member), [Inherited](#inherited-property)et [AllowMultiple](#allowmultiple-property).</span><span class="sxs-lookup"><span data-stu-id="79d0a-117">The <xref:System.AttributeUsageAttribute> has three members that are important for the creation of custom attributes: [AttributeTargets](#attributetargets-member), [Inherited](#inherited-property), and [AllowMultiple](#allowmultiple-property).</span></span>  
  
### <a name="attributetargets-member"></a><span data-ttu-id="79d0a-118">Membre AttributeTargets</span><span class="sxs-lookup"><span data-stu-id="79d0a-118">AttributeTargets Member</span></span>  
 <span data-ttu-id="79d0a-119">Dans l’exemple précédent, <xref:System.AttributeTargets.All?displayProperty=nameWithType> est spécifié, ce qui indique que cet attribut peut être appliqué à tous les éléments de programme.</span><span class="sxs-lookup"><span data-stu-id="79d0a-119">In the previous example, <xref:System.AttributeTargets.All?displayProperty=nameWithType> is specified, indicating that this attribute can be applied to all program elements.</span></span> <span data-ttu-id="79d0a-120">Vous pouvez également spécifier <xref:System.AttributeTargets.Class?displayProperty=nameWithType>, qui indique que votre attribut peut être appliqué uniquement à une classe, ou <xref:System.AttributeTargets.Method?displayProperty=nameWithType>, qui indique que votre attribut peut être appliqué uniquement à une méthode.</span><span class="sxs-lookup"><span data-stu-id="79d0a-120">Alternatively, you can specify <xref:System.AttributeTargets.Class?displayProperty=nameWithType>, indicating that your attribute can be applied only to a class, or <xref:System.AttributeTargets.Method?displayProperty=nameWithType>, indicating that your attribute can be applied only to a method.</span></span> <span data-ttu-id="79d0a-121">Tous les éléments de programme peuvent être marqués pour description par un attribut personnalisé de cette manière.</span><span class="sxs-lookup"><span data-stu-id="79d0a-121">All program elements can be marked for description by a custom attribute in this manner.</span></span>  
  
 <span data-ttu-id="79d0a-122">Vous pouvez également transmettre plusieurs valeurs de <xref:System.AttributeTargets>.</span><span class="sxs-lookup"><span data-stu-id="79d0a-122">You can also pass multiple <xref:System.AttributeTargets> values.</span></span> <span data-ttu-id="79d0a-123">Le fragment de code suivant spécifie qu’un attribut personnalisé peut être appliqué à n’importe quelle classe ou méthode.</span><span class="sxs-lookup"><span data-stu-id="79d0a-123">The following code fragment specifies that a custom attribute can be applied to any class or method.</span></span>  
  
 [!code-cpp[Conceptual.Attributes.Usage#6](../../../samples/snippets/cpp/VS_Snippets_CLR/conceptual.attributes.usage/cpp/source2.cpp#6)]
 [!code-csharp[Conceptual.Attributes.Usage#6](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.attributes.usage/cs/source2.cs#6)]
 [!code-vb[Conceptual.Attributes.Usage#6](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.attributes.usage/vb/source2.vb#6)]  
  
### <a name="inherited-property"></a><span data-ttu-id="79d0a-124">Propriété Inherited</span><span class="sxs-lookup"><span data-stu-id="79d0a-124">Inherited Property</span></span>  
 <span data-ttu-id="79d0a-125">La propriété <xref:System.AttributeUsageAttribute.Inherited%2A?displayProperty=nameWithType> indique si votre attribut peut être hérité par les classes qui sont dérivées des classes auxquelles votre attribut est appliqué.</span><span class="sxs-lookup"><span data-stu-id="79d0a-125">The <xref:System.AttributeUsageAttribute.Inherited%2A?displayProperty=nameWithType> property indicates whether your attribute can be inherited by classes that are derived from the classes to which your attribute is applied.</span></span> <span data-ttu-id="79d0a-126">Cette propriété reçoit un indicateur `true` (par défaut) ou `false`.</span><span class="sxs-lookup"><span data-stu-id="79d0a-126">This property takes either a `true` (the default) or `false` flag.</span></span> <span data-ttu-id="79d0a-127">Dans l’exemple suivant, `MyAttribute` affiche une valeur par défaut <xref:System.AttributeUsageAttribute.Inherited%2A> de `true`, tandis `YourAttribute` affiche une valeur <xref:System.AttributeUsageAttribute.Inherited%2A> de `false`.</span><span class="sxs-lookup"><span data-stu-id="79d0a-127">In the following example, `MyAttribute` has a default <xref:System.AttributeUsageAttribute.Inherited%2A> value of `true`, while `YourAttribute` has an <xref:System.AttributeUsageAttribute.Inherited%2A> value of `false`.</span></span>  
  
 [!code-cpp[Conceptual.Attributes.Usage#7](../../../samples/snippets/cpp/VS_Snippets_CLR/conceptual.attributes.usage/cpp/source2.cpp#7)]
 [!code-csharp[Conceptual.Attributes.Usage#7](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.attributes.usage/cs/source2.cs#7)]
 [!code-vb[Conceptual.Attributes.Usage#7](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.attributes.usage/vb/source2.vb#7)]  
  
 <span data-ttu-id="79d0a-128">Les deux attributs sont ensuite appliqués à une méthode dans la classe de base `MyClass`.</span><span class="sxs-lookup"><span data-stu-id="79d0a-128">The two attributes are then applied to a method in the base class `MyClass`.</span></span>  
  
 [!code-cpp[Conceptual.Attributes.Usage#9](../../../samples/snippets/cpp/VS_Snippets_CLR/conceptual.attributes.usage/cpp/source2.cpp#9)]
 [!code-csharp[Conceptual.Attributes.Usage#9](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.attributes.usage/cs/source2.cs#9)]
 [!code-vb[Conceptual.Attributes.Usage#9](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.attributes.usage/vb/source2.vb#9)]  
  
 <span data-ttu-id="79d0a-129">Enfin, la classe `YourClass` est héritée de la classe de base `MyClass`.</span><span class="sxs-lookup"><span data-stu-id="79d0a-129">Finally, the class `YourClass` is inherited from the base class `MyClass`.</span></span> <span data-ttu-id="79d0a-130">La méthode `MyMethod` affiche `MyAttribute`, mais pas `YourAttribute`.</span><span class="sxs-lookup"><span data-stu-id="79d0a-130">The method `MyMethod` shows `MyAttribute`, but not `YourAttribute`.</span></span>  
  
 [!code-cpp[Conceptual.Attributes.Usage#10](../../../samples/snippets/cpp/VS_Snippets_CLR/conceptual.attributes.usage/cpp/source2.cpp#10)]
 [!code-csharp[Conceptual.Attributes.Usage#10](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.attributes.usage/cs/source2.cs#10)]
 [!code-vb[Conceptual.Attributes.Usage#10](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.attributes.usage/vb/source2.vb#10)]  
  
### <a name="allowmultiple-property"></a><span data-ttu-id="79d0a-131">Propriété AllowMultiple</span><span class="sxs-lookup"><span data-stu-id="79d0a-131">AllowMultiple Property</span></span>  
 <span data-ttu-id="79d0a-132">La propriété <xref:System.AttributeUsageAttribute.AllowMultiple%2A?displayProperty=nameWithType> indique si plusieurs instances de votre attribut peuvent exister sur un élément.</span><span class="sxs-lookup"><span data-stu-id="79d0a-132">The <xref:System.AttributeUsageAttribute.AllowMultiple%2A?displayProperty=nameWithType> property indicates whether multiple instances of your attribute can exist on an element.</span></span> <span data-ttu-id="79d0a-133">Si la valeur est `true`, plusieurs instances sont autorisées, si la valeur est `false` (par défaut), une seule instance est autorisée.</span><span class="sxs-lookup"><span data-stu-id="79d0a-133">If set to `true`, multiple instances are allowed; if set to `false` (the default), only one instance is allowed.</span></span>  
  
 <span data-ttu-id="79d0a-134">Dans l’exemple suivant, `MyAttribute` affiche une valeur par défaut <xref:System.AttributeUsageAttribute.AllowMultiple%2A> de `false`, tandis `YourAttribute` affiche une valeur de `true`.</span><span class="sxs-lookup"><span data-stu-id="79d0a-134">In the following example, `MyAttribute` has a default <xref:System.AttributeUsageAttribute.AllowMultiple%2A> value of `false`, while `YourAttribute` has a value of `true`.</span></span>  
  
 [!code-cpp[Conceptual.Attributes.Usage#11](../../../samples/snippets/cpp/VS_Snippets_CLR/conceptual.attributes.usage/cpp/source2.cpp#11)]
 [!code-csharp[Conceptual.Attributes.Usage#11](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.attributes.usage/cs/source2.cs#11)]
 [!code-vb[Conceptual.Attributes.Usage#11](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.attributes.usage/vb/source2.vb#11)]  
  
 <span data-ttu-id="79d0a-135">Quand plusieurs instances de ces attributs sont appliquées, `MyAttribute` génère une erreur du compilateur.</span><span class="sxs-lookup"><span data-stu-id="79d0a-135">When multiple instances of these attributes are applied, `MyAttribute` produces a compiler error.</span></span> <span data-ttu-id="79d0a-136">L’exemple de code suivant illustre l’utilisation valide de `YourAttribute` et l’utilisation non valide de `MyAttribute`.</span><span class="sxs-lookup"><span data-stu-id="79d0a-136">The following code example shows the valid use of `YourAttribute` and the invalid use of `MyAttribute`.</span></span>  
  
 [!code-cpp[Conceptual.Attributes.Usage#13](../../../samples/snippets/cpp/VS_Snippets_CLR/conceptual.attributes.usage/cpp/source2.cpp#13)]
 [!code-csharp[Conceptual.Attributes.Usage#13](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.attributes.usage/cs/source2.cs#13)]
 [!code-vb[Conceptual.Attributes.Usage#13](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.attributes.usage/vb/source2.vb#13)]  
  
 <span data-ttu-id="79d0a-137">Si la propriété <xref:System.AttributeUsageAttribute.AllowMultiple%2A> et la propriété <xref:System.AttributeUsageAttribute.Inherited%2A> ont la valeur `true`, une classe héritée d’une autre classe peut hériter d’un attribut et avoir une autre instance du même attribut appliquée dans la même classe enfant.</span><span class="sxs-lookup"><span data-stu-id="79d0a-137">If both the <xref:System.AttributeUsageAttribute.AllowMultiple%2A> property and the <xref:System.AttributeUsageAttribute.Inherited%2A> property are set to `true`, a class that is inherited from another class can inherit an attribute and have another instance of the same attribute applied in the same child class.</span></span> <span data-ttu-id="79d0a-138">Si <xref:System.AttributeUsageAttribute.AllowMultiple%2A> a la valeur `false`, les valeurs des attributs de la classe parente sont remplacées par les nouvelles instances du même attribut dans la classe enfant.</span><span class="sxs-lookup"><span data-stu-id="79d0a-138">If <xref:System.AttributeUsageAttribute.AllowMultiple%2A> is set to `false`, the values of any attributes in the parent class will be overwritten by new instances of the same attribute in the child class.</span></span>  
  
## <a name="declaring-the-attribute-class"></a><span data-ttu-id="79d0a-139">Déclaration de la classe d’attributs</span><span class="sxs-lookup"><span data-stu-id="79d0a-139">Declaring the Attribute Class</span></span>  
 <span data-ttu-id="79d0a-140">Une fois que vous avez appliqué <xref:System.AttributeUsageAttribute>, vous pouvez commencer à définir les particularités de votre attribut.</span><span class="sxs-lookup"><span data-stu-id="79d0a-140">After you apply the <xref:System.AttributeUsageAttribute>, you can begin to define the specifics of your attribute.</span></span> <span data-ttu-id="79d0a-141">La déclaration d’une classe d’attributs ressemble à la déclaration d’une classe traditionnelle, comme illustré dans le code suivant.</span><span class="sxs-lookup"><span data-stu-id="79d0a-141">The declaration of an attribute class looks similar to the declaration of a traditional class, as demonstrated by the following code.</span></span>  
  
 [!code-cpp[Conceptual.Attributes.Usage#14](../../../samples/snippets/cpp/VS_Snippets_CLR/conceptual.attributes.usage/cpp/source2.cpp#14)]
 [!code-csharp[Conceptual.Attributes.Usage#14](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.attributes.usage/cs/source2.cs#14)]
 [!code-vb[Conceptual.Attributes.Usage#14](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.attributes.usage/vb/source2.vb#14)]  
  
 <span data-ttu-id="79d0a-142">Cette définition de l’attribut illustre les points suivants :</span><span class="sxs-lookup"><span data-stu-id="79d0a-142">This attribute definition demonstrates the following points:</span></span>  
  
- <span data-ttu-id="79d0a-143">Les classes d’attributs doivent être déclarées comme des classes publiques.</span><span class="sxs-lookup"><span data-stu-id="79d0a-143">Attribute classes must be declared as public classes.</span></span>  
  
- <span data-ttu-id="79d0a-144">Par convention, le nom de la classe d’attributs se termine par le mot **Attribute**.</span><span class="sxs-lookup"><span data-stu-id="79d0a-144">By convention, the name of the attribute class ends with the word **Attribute**.</span></span> <span data-ttu-id="79d0a-145">Même si elle n’est pas obligatoire, cette convention est recommandée pour une meilleure lisibilité.</span><span class="sxs-lookup"><span data-stu-id="79d0a-145">While not required, this convention is recommended for readability.</span></span> <span data-ttu-id="79d0a-146">Quand l’attribut est appliqué, l’inclusion du mot Attribute est facultative.</span><span class="sxs-lookup"><span data-stu-id="79d0a-146">When the attribute is applied, the inclusion of the word Attribute is optional.</span></span>  
  
- <span data-ttu-id="79d0a-147">Toutes les classes d’attributs doivent hériter directement ou indirectement de <xref:System.Attribute?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="79d0a-147">All attribute classes must inherit directly or indirectly from <xref:System.Attribute?displayProperty=nameWithType>.</span></span>  
  
- <span data-ttu-id="79d0a-148">Dans Microsoft Visual Basic, toutes les classes d’attributs personnalisés doivent avoir l’attribut <xref:System.AttributeUsageAttribute?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="79d0a-148">In Microsoft Visual Basic, all custom attribute classes must have the <xref:System.AttributeUsageAttribute?displayProperty=nameWithType> attribute.</span></span>  
  
## <a name="declaring-constructors"></a><span data-ttu-id="79d0a-149">Déclaration des constructeurs</span><span class="sxs-lookup"><span data-stu-id="79d0a-149">Declaring Constructors</span></span>  
 <span data-ttu-id="79d0a-150">Les attributs sont initialisés avec des constructeurs de la même façon que les classes traditionnelles.</span><span class="sxs-lookup"><span data-stu-id="79d0a-150">Attributes are initialized with constructors in the same way as traditional classes.</span></span> <span data-ttu-id="79d0a-151">Le fragment de code suivant illustre un constructeur d’attribut classique.</span><span class="sxs-lookup"><span data-stu-id="79d0a-151">The following code fragment illustrates a typical attribute constructor.</span></span> <span data-ttu-id="79d0a-152">Ce constructeur public accepte un paramètre et définit une variable membre égale à sa valeur.</span><span class="sxs-lookup"><span data-stu-id="79d0a-152">This public constructor takes a parameter and sets a member variable equal to its value.</span></span>  
  
 [!code-cpp[Conceptual.Attributes.Usage#15](../../../samples/snippets/cpp/VS_Snippets_CLR/conceptual.attributes.usage/cpp/source2.cpp#15)]
 [!code-csharp[Conceptual.Attributes.Usage#15](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.attributes.usage/cs/source2.cs#15)]
 [!code-vb[Conceptual.Attributes.Usage#15](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.attributes.usage/vb/source2.vb#15)]  
  
 <span data-ttu-id="79d0a-153">Vous pouvez surcharger le constructeur pour qu’il reçoive différentes combinaisons de valeurs.</span><span class="sxs-lookup"><span data-stu-id="79d0a-153">You can overload the constructor to accommodate different combinations of values.</span></span> <span data-ttu-id="79d0a-154">Si vous définissez également une [propriété](https://msdn.microsoft.com/library/8f1a1ff1-0f05-40e0-bfdf-80de8fff7d52) pour votre classe d’attributs personnalisés, vous pouvez utiliser une combinaison de paramètres nommés et positionnels lors de l’initialisation de l’attribut.</span><span class="sxs-lookup"><span data-stu-id="79d0a-154">If you also define a [property](https://msdn.microsoft.com/library/8f1a1ff1-0f05-40e0-bfdf-80de8fff7d52) for your custom attribute class, you can use a combination of named and positional parameters when initializing the attribute.</span></span> <span data-ttu-id="79d0a-155">En général, vous définissez tous les paramètres obligatoires comme des paramètres positionnels et tous les paramètres facultatifs comme des paramètres nommés.</span><span class="sxs-lookup"><span data-stu-id="79d0a-155">Typically, you define all required parameters as positional and all optional parameters as named.</span></span> <span data-ttu-id="79d0a-156">Dans ce cas, l’attribut ne peut pas être initialisé sans le paramètre obligatoire.</span><span class="sxs-lookup"><span data-stu-id="79d0a-156">In this case, the attribute cannot be initialized without the required parameter.</span></span> <span data-ttu-id="79d0a-157">Tous les autres paramètres sont facultatifs.</span><span class="sxs-lookup"><span data-stu-id="79d0a-157">All other parameters are optional.</span></span> <span data-ttu-id="79d0a-158">Notez que dans Visual Basic, les constructeurs d’une classe d’attributs ne doivent pas utiliser d’argument ParamArray.</span><span class="sxs-lookup"><span data-stu-id="79d0a-158">Note that in Visual Basic, constructors for an attribute class should not use a ParamArray argument.</span></span>  
  
 <span data-ttu-id="79d0a-159">L’exemple de code suivant montre comment un attribut qui utilise le constructeur précédent peut être appliqué à l’aide de paramètres obligatoires et facultatifs.</span><span class="sxs-lookup"><span data-stu-id="79d0a-159">The following code example shows how an attribute that uses the previous constructor can be applied using optional and required parameters.</span></span> <span data-ttu-id="79d0a-160">Il suppose que l’attribut a une valeur booléenne obligatoire et une propriété de chaîne facultative.</span><span class="sxs-lookup"><span data-stu-id="79d0a-160">It assumes that the attribute has one required Boolean value and one optional string property.</span></span>  
  
 [!code-cpp[Conceptual.Attributes.Usage#17](../../../samples/snippets/cpp/VS_Snippets_CLR/conceptual.attributes.usage/cpp/source2.cpp#17)]
 [!code-csharp[Conceptual.Attributes.Usage#17](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.attributes.usage/cs/source2.cs#17)]
 [!code-vb[Conceptual.Attributes.Usage#17](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.attributes.usage/vb/source2.vb#17)]  
  
## <a name="declaring-properties"></a><span data-ttu-id="79d0a-161">Déclaration des propriétés</span><span class="sxs-lookup"><span data-stu-id="79d0a-161">Declaring Properties</span></span>  
 <span data-ttu-id="79d0a-162">Si vous voulez définir un paramètre nommé ou fournir un moyen facile de retourner les valeurs stockées par votre attribut, déclarez une [propriété](https://msdn.microsoft.com/library/8f1a1ff1-0f05-40e0-bfdf-80de8fff7d52).</span><span class="sxs-lookup"><span data-stu-id="79d0a-162">If you want to define a named parameter or provide an easy way to return the values stored by your attribute, declare a [property](https://msdn.microsoft.com/library/8f1a1ff1-0f05-40e0-bfdf-80de8fff7d52).</span></span> <span data-ttu-id="79d0a-163">Les propriétés d’attribut doivent être déclarées comme des entités publiques avec une description du type de données à retourner.</span><span class="sxs-lookup"><span data-stu-id="79d0a-163">Attribute properties should be declared as public entities with a description of the data type that will be returned.</span></span> <span data-ttu-id="79d0a-164">Définissez la variable qui contient la valeur de votre propriété et associez-la aux méthodes **get** et **set** .</span><span class="sxs-lookup"><span data-stu-id="79d0a-164">Define the variable that will hold the value of your property and associate it with the **get** and **set** methods.</span></span> <span data-ttu-id="79d0a-165">L’exemple de code suivant montre comment implémenter une propriété simple dans votre attribut.</span><span class="sxs-lookup"><span data-stu-id="79d0a-165">The following code example demonstrates how to implement a simple property in your attribute.</span></span>  
  
 [!code-cpp[Conceptual.Attributes.Usage#16](../../../samples/snippets/cpp/VS_Snippets_CLR/conceptual.attributes.usage/cpp/source2.cpp#16)]
 [!code-csharp[Conceptual.Attributes.Usage#16](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.attributes.usage/cs/source2.cs#16)]
 [!code-vb[Conceptual.Attributes.Usage#16](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.attributes.usage/vb/source2.vb#16)]  
  
## <a name="custom-attribute-example"></a><span data-ttu-id="79d0a-166">exemple d’attribut personnalisé</span><span class="sxs-lookup"><span data-stu-id="79d0a-166">Custom Attribute Example</span></span>  
 <span data-ttu-id="79d0a-167">Cette section intègre les informations précédentes et montre comment concevoir un attribut simple qui documente des informations sur l’auteur d’une section de code.</span><span class="sxs-lookup"><span data-stu-id="79d0a-167">This section incorporates the previous information and shows how to design a simple attribute that documents information about the author of a section of code.</span></span> <span data-ttu-id="79d0a-168">L’attribut de cet exemple stocke le nom et le niveau du programmeur, et indique si le code a été révisé.</span><span class="sxs-lookup"><span data-stu-id="79d0a-168">The attribute in this example stores the name and level of the programmer, and whether the code has been reviewed.</span></span> <span data-ttu-id="79d0a-169">Il utilise trois variables privées pour stocker les valeurs réelles à enregistrer.</span><span class="sxs-lookup"><span data-stu-id="79d0a-169">It uses three private variables to store the actual values to save.</span></span> <span data-ttu-id="79d0a-170">Chaque variable est représentée par une propriété publique qui obtient et définit les valeurs.</span><span class="sxs-lookup"><span data-stu-id="79d0a-170">Each variable is represented by a public property that gets and sets the values.</span></span> <span data-ttu-id="79d0a-171">Enfin, le constructeur est défini avec deux paramètres obligatoires.</span><span class="sxs-lookup"><span data-stu-id="79d0a-171">Finally, the constructor is defined with two required parameters.</span></span>  
  
 [!code-cpp[Conceptual.Attributes.Usage#4](../../../samples/snippets/cpp/VS_Snippets_CLR/conceptual.attributes.usage/cpp/source2.cpp#4)]
 [!code-csharp[Conceptual.Attributes.Usage#4](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.attributes.usage/cs/source2.cs#4)]
 [!code-vb[Conceptual.Attributes.Usage#4](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.attributes.usage/vb/source2.vb#4)]  
  
 <span data-ttu-id="79d0a-172">Vous pouvez appliquer cet attribut à l’aide du nom complet, `DeveloperAttribute`, ou à l’aide du nom abrégé, `Developer`, de l’une des manières suivantes.</span><span class="sxs-lookup"><span data-stu-id="79d0a-172">You can apply this attribute using the full name, `DeveloperAttribute`, or using the abbreviated name, `Developer`, in one of the following ways.</span></span>  
  
 [!code-cpp[Conceptual.Attributes.Usage#12](../../../samples/snippets/cpp/VS_Snippets_CLR/conceptual.attributes.usage/cpp/source2.cpp#12)]
 [!code-csharp[Conceptual.Attributes.Usage#12](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.attributes.usage/cs/source2.cs#12)]
 [!code-vb[Conceptual.Attributes.Usage#12](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.attributes.usage/vb/source2.vb#12)]  
  
 <span data-ttu-id="79d0a-173">Le premier exemple montre l’attribut appliqué uniquement avec les paramètres nommés obligatoires, tandis que le deuxième exemple montre l’attribut appliqué avec les paramètres obligatoires et facultatifs.</span><span class="sxs-lookup"><span data-stu-id="79d0a-173">The first example shows the attribute applied with only the required named parameters, while the second example shows the attribute applied with both the required and optional parameters.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="79d0a-174">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="79d0a-174">See Also</span></span>  
 <xref:System.Attribute?displayProperty=nameWithType>  
 <xref:System.AttributeUsageAttribute?displayProperty=nameWithType>  
 [<span data-ttu-id="79d0a-175">Attributs</span><span class="sxs-lookup"><span data-stu-id="79d0a-175">Attributes</span></span>](../../../docs/standard/attributes/index.md)
