---
title: Identification des limites du modèle de domaine pour chaque microservice
description: Explorez l’essence du partitionnement d’une application volumineuse en microservices pour obtenir une architecture solide.
ms.date: 09/20/2018
ms.openlocfilehash: aa903e13b20be1084fad60e6fb7bbb1c61403deb
ms.sourcegitcommit: 8699383914c24a0df033393f55db3369db728a7b
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 05/15/2019
ms.locfileid: "65644390"
---
# <a name="identify-domain-model-boundaries-for-each-microservice"></a><span data-ttu-id="bada9-103">Identifier les limites du modèle de domaine pour chaque microservice</span><span class="sxs-lookup"><span data-stu-id="bada9-103">Identify domain-model boundaries for each microservice</span></span>

<span data-ttu-id="bada9-104">L’objectif de l’identification des limites et de la taille du modèle pour chaque microservice n’est pas d’obtenir la séparation la plus granulaire possible, même si vous devez tendre vers de petits microservices autant que possible.</span><span class="sxs-lookup"><span data-stu-id="bada9-104">The goal when identifying model boundaries and size for each microservice isn't to get to the most granular separation possible, although you should tend toward small microservices if possible.</span></span> <span data-ttu-id="bada9-105">Votre objectif doit plutôt être de parvenir à la séparation la plus significative en fonction de votre connaissance du domaine.</span><span class="sxs-lookup"><span data-stu-id="bada9-105">Instead, your goal should be to get to the most meaningful separation guided by your domain knowledge.</span></span> <span data-ttu-id="bada9-106">Vous ne devez pas mettre l’accent sur la taille, mais plutôt sur les fonctionnalités métier.</span><span class="sxs-lookup"><span data-stu-id="bada9-106">The emphasis isn't on the size, but instead on business capabilities.</span></span> <span data-ttu-id="bada9-107">De plus, si une cohésion claire est nécessaire pour une certaine zone de l’application en raison d’un grand nombre de dépendances, cela indique également la nécessité d’avoir un seul microservice.</span><span class="sxs-lookup"><span data-stu-id="bada9-107">In addition, if there's clear cohesion needed for a certain area of the application based on a high number of dependencies, that indicates the need for a single microservice, too.</span></span> <span data-ttu-id="bada9-108">La cohésion est une façon d’identifier comment dissocier ou regrouper ensemble des microservices.</span><span class="sxs-lookup"><span data-stu-id="bada9-108">Cohesion is a way to identify how to break apart or group together microservices.</span></span> <span data-ttu-id="bada9-109">Enfin, au fil de l’approfondissement de vos connaissances sur le domaine, vous devez adapter la taille de votre microservice par itérations successives.</span><span class="sxs-lookup"><span data-stu-id="bada9-109">Ultimately, while you gain more knowledge about the domain, you should adapt the size of your microservice, iteratively.</span></span> <span data-ttu-id="bada9-110">Trouver la bonne taille ne se fait pas en une seule fois.</span><span class="sxs-lookup"><span data-stu-id="bada9-110">Finding the right size isn't a one-shot process.</span></span>

<span data-ttu-id="bada9-111">[Sam Newman](https://samnewman.io/), promoteur reconnu des microservices et auteur du livre [Building Microservices](https://samnewman.io/books/building_microservices/), insiste sur le fait que vous devez concevoir vos microservices en fonction du modèle de contexte délimité (qui fait partie de la conception pilotée par le domaine), introduit précédemment.</span><span class="sxs-lookup"><span data-stu-id="bada9-111">[Sam Newman](https://samnewman.io/), a recognized promoter of microservices and author of the book [Building Microservices](https://samnewman.io/books/building_microservices/), highlights that you should design your microservices based on the Bounded Context (BC) pattern (part of domain-driven design), as introduced earlier.</span></span> <span data-ttu-id="bada9-112">Parfois, un contexte délimité peut être composé de plusieurs services physiques, mais l’inverse n’est pas vrai.</span><span class="sxs-lookup"><span data-stu-id="bada9-112">Sometimes, a BC could be composed of several physical services, but not vice versa.</span></span>

<span data-ttu-id="bada9-113">Un modèle de domaine avec des entités de domaine spécifique s’applique dans un contexte délimité ou un microservice concret.</span><span class="sxs-lookup"><span data-stu-id="bada9-113">A domain model with specific domain entities applies within a concrete BC or microservice.</span></span> <span data-ttu-id="bada9-114">Un contexte délimité détermine l’applicabilité d’un modèle de domaine, et donne aux membres de l’équipe de développement une compréhension claire et partagée de ce qui doit être cohésif et de ce qui peut être développé indépendamment.</span><span class="sxs-lookup"><span data-stu-id="bada9-114">A BC delimits the applicability of a domain model and gives developer team members a clear and shared understanding of what must be cohesive and what can be developed independently.</span></span> <span data-ttu-id="bada9-115">Ces objectifs sont identiques pour les microservices.</span><span class="sxs-lookup"><span data-stu-id="bada9-115">These are the same goals for microservices.</span></span>

<span data-ttu-id="bada9-116">La [loi de Conway](https://en.wikipedia.org/wiki/Conway%27s_law) est un autre outil qui influence vos choix de conception. Elle établit qu’une application reflète les limites sociales de l’organisation qui l’a produite.</span><span class="sxs-lookup"><span data-stu-id="bada9-116">Another tool that informs your design choice is [Conway's law](https://en.wikipedia.org/wiki/Conway%27s_law), which states that an application will reflect the social boundaries of the organization that produced it.</span></span> <span data-ttu-id="bada9-117">Toutefois, l’inverse est parfois vrai : l’organisation de l’entreprise est déterminée par le logiciel.</span><span class="sxs-lookup"><span data-stu-id="bada9-117">But sometimes the opposite is true -the company's organization is formed by the software.</span></span> <span data-ttu-id="bada9-118">Il peut s’avérer nécessaire d’inverser la loi de Conway et de créer les limites selon la façon dont vous souhaitez que l’entreprise soit organisée, en retenant les conseils relatifs au processus métier.</span><span class="sxs-lookup"><span data-stu-id="bada9-118">You might need to reverse Conway's law and build the boundaries the way you want the company to be organized, leaning toward business process consulting.</span></span>

<span data-ttu-id="bada9-119">Pour identifier les contextes liés, vous pouvez utiliser un modèle DDD appelé [modèle de mappage de contexte](https://www.infoq.com/articles/ddd-contextmapping).</span><span class="sxs-lookup"><span data-stu-id="bada9-119">To identify bounded contexts, you can use a DDD pattern called the [Context Mapping pattern](https://www.infoq.com/articles/ddd-contextmapping).</span></span> <span data-ttu-id="bada9-120">Avec le mappage de contexte, vous identifiez les différents contextes dans l’application et leurs limites.</span><span class="sxs-lookup"><span data-stu-id="bada9-120">With Context Mapping, you identify the various contexts in the application and their boundaries.</span></span> <span data-ttu-id="bada9-121">Par exemple, il est courant d’avoir d’un contexte et des limites différents pour chaque petit sous-système.</span><span class="sxs-lookup"><span data-stu-id="bada9-121">It's common to have a different context and boundary for each small subsystem, for instance.</span></span> <span data-ttu-id="bada9-122">Le mappage de contexte est un moyen de définir et de rendre explicite ces limites entre domaines.</span><span class="sxs-lookup"><span data-stu-id="bada9-122">The Context Map is a way to define and make explicit those boundaries between domains.</span></span> <span data-ttu-id="bada9-123">Un contexte délimité est autonome et inclut les détails d’un seul domaine (des détails comme les entités de domaine). Il définit les contrats d’intégration avec les autres contextes délimités.</span><span class="sxs-lookup"><span data-stu-id="bada9-123">A BC is autonomous and includes the details of a single domain -details like the domain entities- and defines integration contracts with other BCs.</span></span> <span data-ttu-id="bada9-124">Ceci est similaire à la définition d’un microservice : il est autonome, il implémente certaines fonctionnalités de domaine et doit fournir des interfaces.</span><span class="sxs-lookup"><span data-stu-id="bada9-124">This is similar to the definition of a microservice: it's autonomous, it implements certain domain capability, and it must provide interfaces.</span></span> <span data-ttu-id="bada9-125">C’est pourquoi le mappage de contexte et le modèle de contexte délimité sont une bonne approche pour identifier les limites du modèle de domaine de vos microservices.</span><span class="sxs-lookup"><span data-stu-id="bada9-125">This is why Context Mapping and the Bounded Context pattern are good approaches for identifying the domain model boundaries of your microservices.</span></span>

<span data-ttu-id="bada9-126">Durant la conception d’une application importante, vous voyez comment son modèle de domaine peut être fragmenté : par exemple, un expert du domaine des catalogues ne nomme pas les entités dans le catalogue et dans l’inventaire de la même façon qu’un expert du domaine des transports.</span><span class="sxs-lookup"><span data-stu-id="bada9-126">When designing a large application, you'll see how its domain model can be fragmented - a domain expert from the catalog domain will name entities differently in the catalog and inventory domains than a shipping domain expert, for instance.</span></span> <span data-ttu-id="bada9-127">L’entité du domaine utilisateur peut aussi être différente en taille et en nombre d’attributs quand vous traitez avec un expert de la relation clientèle, qui veut stocker tous les détails du client, par rapport à un expert du domaine de la gestion des commandes, qui a besoin seulement de données partielles sur le client.</span><span class="sxs-lookup"><span data-stu-id="bada9-127">Or the user domain entity might be different in size and number of attributes when dealing with a CRM expert who wants to store every detail about the customer than for an ordering domain expert who just needs partial data about the customer.</span></span> <span data-ttu-id="bada9-128">Il est très difficile de lever l’ambiguïté de tous les termes d’un domaine dans tous les domaines liés à une grosse application.</span><span class="sxs-lookup"><span data-stu-id="bada9-128">It's very hard to disambiguate all domain terms across all the domains related to a large application.</span></span> <span data-ttu-id="bada9-129">Toutefois, le plus important est de ne pas essayer d’unifier les termes.</span><span class="sxs-lookup"><span data-stu-id="bada9-129">But the most important thing is that you shouldn't try to unify the terms.</span></span> <span data-ttu-id="bada9-130">À la place, acceptez les différences et la richesse de chaque domaine.</span><span class="sxs-lookup"><span data-stu-id="bada9-130">Instead, accept the differences and richness provided by each domain.</span></span> <span data-ttu-id="bada9-131">Si vous essayez d’avoir une base de données unifiée pour toute l’application, les tentatives d’obtention d’un vocabulaire unifié sont difficiles et ne semblent correctes pour aucun des experts des différents domaines.</span><span class="sxs-lookup"><span data-stu-id="bada9-131">If you try to have a unified database for the whole application, attempts at a unified vocabulary will be awkward and won't sound right to any of the multiple domain experts.</span></span> <span data-ttu-id="bada9-132">Ainsi, les contextes délimités (implémentés en tant que microservices) vous aident à préciser où vous pouvez utiliser certains termes du domaine, et où vous devez scinder le système pour créer des contextes délimités supplémentaires avec des domaines distincts.</span><span class="sxs-lookup"><span data-stu-id="bada9-132">Therefore, BCs (implemented as microservices) will help you to clarify where you can use certain domain terms and where you'll need to split the system and create additional BCs with different domains.</span></span>

<span data-ttu-id="bada9-133">Vous savez que vous avez déterminé les bonnes limites et les bonnes tailles de chaque contexte délimité et de chaque modèle de domaine si vous n’avez que quelques relations fortes entre les modèles de domaine. De plus, vous n’avez généralement pas besoin de fusionner les informations provenant de plusieurs modèles de domaine au moment de l’exécution d’opérations d’application classiques.</span><span class="sxs-lookup"><span data-stu-id="bada9-133">You'll know that you got the right boundaries and sizes of each BC and domain model if you have few strong relationships between domain models, and you do not usually need to merge information from multiple domain models when performing typical application operations.</span></span>

<span data-ttu-id="bada9-134">La meilleure réponse à la question de la taille que doit avoir un modèle de domaine pour chaque microservice est peut-être la suivante : il doit avoir un contexte délimité autonome, aussi isolé que possible, qui vous permet de travailler sans devoir passer constamment à d’autres contextes (autres modèles de microservice).</span><span class="sxs-lookup"><span data-stu-id="bada9-134">Perhaps the best answer to the question of how large a domain model for each microservice should be is the following: it should have an autonomous BC, as isolated as possible, that enables you to work without having to constantly switch to other contexts (other microservice's models).</span></span> <span data-ttu-id="bada9-135">Dans la figure 4-10, vous pouvez voir comment plusieurs microservices (plusieurs contextes délimités) ont chacun leur propre modèle et comment leurs entités peuvent être définies, en fonction des exigences spécifiques de chacun des domaines identifiés dans votre application.</span><span class="sxs-lookup"><span data-stu-id="bada9-135">In Figure 4-10, you can see how multiple microservices (multiple BCs) each has their own model and how their entities can be defined, depending on the specific requirements for each of the identified domains in your application.</span></span>

![Entités de plusieurs limites de modèle (contextes délimités), où la même entité apparaît sous les termes « Users » (Utilisateurs), « Buyers » (Acheteurs), « Payers » (Payeurs) et « Customers » (Clients) en fonction du contexte délimité](./media/image10.png)

<span data-ttu-id="bada9-137">**Figure 4-10**.</span><span class="sxs-lookup"><span data-stu-id="bada9-137">**Figure 4-10**.</span></span> <span data-ttu-id="bada9-138">Identification des entités et des limites du modèle de microservice</span><span class="sxs-lookup"><span data-stu-id="bada9-138">Identifying entities and microservice model boundaries</span></span>

<span data-ttu-id="bada9-139">La figure 4-10 illustre un exemple de scénario relatif à un système de gestion de conférences en ligne.</span><span class="sxs-lookup"><span data-stu-id="bada9-139">Figure 4-10 illustrates a sample scenario related to an online conference management system.</span></span> <span data-ttu-id="bada9-140">Vous avez identifié plusieurs contextes délimités qui peuvent être implémentés en tant que microservices, en fonction des domaines définis pour vous par les experts des domaines.</span><span class="sxs-lookup"><span data-stu-id="bada9-140">You've identified several BCs that could be implemented as microservices, based on domains that domain experts defined for you.</span></span> <span data-ttu-id="bada9-141">Comme vous pouvez le voir, il existe des entités qui sont présentes dans un seul modèle de microservice, comme Payments (Paiements) dans le microservice Payment (Paiement).</span><span class="sxs-lookup"><span data-stu-id="bada9-141">As you can see, there are entities that are present just in a single microservice model, like Payments in the Payment microservice.</span></span> <span data-ttu-id="bada9-142">Ceux-ci seront faciles à implémenter.</span><span class="sxs-lookup"><span data-stu-id="bada9-142">Those will be easy to implement.</span></span>

<span data-ttu-id="bada9-143">Cependant, vous pouvez également avoir des entités qui ont une forme différente, mais qui partagent la même identité entre les différents modèles de domaine des différents microservices.</span><span class="sxs-lookup"><span data-stu-id="bada9-143">However, you might also have entities that have a different shape but share the same identity across the multiple domain models from the multiple microservices.</span></span> <span data-ttu-id="bada9-144">Par exemple, l’entité User (Utilisateur) est identifiée dans le microservice Conferences Management (Gestion des conférences).</span><span class="sxs-lookup"><span data-stu-id="bada9-144">For example, the User entity is identified in the Conferences Management microservice.</span></span> <span data-ttu-id="bada9-145">Ce même utilisateur, avec la même identité, est celui qui est nommé Buyers (Acheteurs) dans le microservice Ordering (Commandes), ou celui qui est nommé Payer (Payeur) dans le microservice Payment (Paiement), et même celui qui est nommé Customer (Client) dans le microservice Customer Service (Service client).</span><span class="sxs-lookup"><span data-stu-id="bada9-145">That same user, with the same identity, is the one named Buyers in the Ordering microservice, or the one named Payer in the Payment microservice, and even the one named Customer in the Customer Service microservice.</span></span> <span data-ttu-id="bada9-146">C’est pourquoi, en fonction de [l’ubiquité du langage](https://martinfowler.com/bliki/UbiquitousLanguage.html) utilisé par chaque expert du domaine, un utilisateur peut avoir une perspective différente, avec même des attributs différents.</span><span class="sxs-lookup"><span data-stu-id="bada9-146">This is because, depending on the [ubiquitous language](https://martinfowler.com/bliki/UbiquitousLanguage.html) that each domain expert is using, a user might have a different perspective even with different attributes.</span></span> <span data-ttu-id="bada9-147">L’entité représentant un utilisateur dans le modèle de microservice nommé Conferences Management peut avoir la plupart de ses attributs de données personnelles.</span><span class="sxs-lookup"><span data-stu-id="bada9-147">The user entity in the microservice model named Conferences Management might have most of its personal data attributes.</span></span> <span data-ttu-id="bada9-148">Cependant, ce même utilisateur dans la forme Payer du microservice Payment ou dans la forme Customer dans le microservice Customer Service peut ne pas nécessiter la même liste d’attributs.</span><span class="sxs-lookup"><span data-stu-id="bada9-148">However, that same user in the shape of Payer in the microservice Payment or in the shape of Customer in the microservice Customer Service might not need the same list of attributes.</span></span>

<span data-ttu-id="bada9-149">Une approche similaire est illustrée dans la figure 4-11.</span><span class="sxs-lookup"><span data-stu-id="bada9-149">A similar approach is illustrated in Figure 4-11.</span></span>

![Quand vous décomposez un modèle de données classique en plusieurs contextes liés, différentes entités peuvent partager la même identité (un acheteur est également un utilisateur) avec des attributs distincts dans chaque contexte lié.](./media/image11.png)

<span data-ttu-id="bada9-151">**Figure 4-11**.</span><span class="sxs-lookup"><span data-stu-id="bada9-151">**Figure 4-11**.</span></span> <span data-ttu-id="bada9-152">Décomposition des modèles de données traditionnels en plusieurs modèles de domaine</span><span class="sxs-lookup"><span data-stu-id="bada9-152">Decomposing traditional data models into multiple domain models</span></span>

<span data-ttu-id="bada9-153">Vous pouvez voir que l’utilisateur est présent dans le modèle de microservice Conferences Management en tant qu’entité User, et qu’il est également présent sous la forme de l’entité Buyer dans le microservice Pricing (Tarification), avec d’autres attributs ou détails sur l’utilisateur quand il est en fait un acheteur.</span><span class="sxs-lookup"><span data-stu-id="bada9-153">You can see how the user is present in the Conferences Management microservice model as the User entity and is also present in the form of the Buyer entity in the Pricing microservice, with alternate attributes or details about the user when it's actually a buyer.</span></span> <span data-ttu-id="bada9-154">Chaque microservice ou contexte délimité peut ne pas avoir besoin de toutes les données relatives à une entité User, mais seulement d’une partie d’entre elles, selon le problème à résoudre ou le contexte.</span><span class="sxs-lookup"><span data-stu-id="bada9-154">Each microservice or BC might not need all the data related to a User entity, just part of it, depending on the problem to solve or the context.</span></span> <span data-ttu-id="bada9-155">Par exemple, dans le modèle de microservice Pricing, vous n’avez pas besoin de l’adresse ou du nom de l’utilisateur, mais simplement d’ID (en tant qu’identité) et de Status (État), qui a un impact sur les remises pour la tarification des sièges par acheteur.</span><span class="sxs-lookup"><span data-stu-id="bada9-155">For instance, in the Pricing microservice model, you do not need the address or the name of the user, just the ID (as identity) and Status, which will have an impact on discounts when pricing the seats per buyer.</span></span>

<span data-ttu-id="bada9-156">L’entité Seat (Siège) a le même nom, mais des attributs différents dans chaque modèle de domaine.</span><span class="sxs-lookup"><span data-stu-id="bada9-156">The Seat entity has the same name but different attributes in each domain model.</span></span> <span data-ttu-id="bada9-157">Cependant, Seat partage l’identité basée sur le même ID, comme cela se passe avec User et Buyer.</span><span class="sxs-lookup"><span data-stu-id="bada9-157">However, Seat shares identity based on the same ID, as happens with User and Buyer.</span></span>

<span data-ttu-id="bada9-158">Il existe ici un concept partagé, celui d’un utilisateur présent dans plusieurs services (domaines), qui partagent tous l’identité de cet utilisateur.</span><span class="sxs-lookup"><span data-stu-id="bada9-158">Basically, there's a shared concept of a user that exists in multiple services (domains), which all share the identity of that user.</span></span> <span data-ttu-id="bada9-159">Il peut cependant exister dans chaque modèle de domaine des détails supplémentaires ou différents sur l’entité utilisateur.</span><span class="sxs-lookup"><span data-stu-id="bada9-159">But in each domain model there might be additional or different details about the user entity.</span></span> <span data-ttu-id="bada9-160">Par conséquent, il doit exister un moyen de mapper une entité utilisateur d’un domaine (microservice) à un autre.</span><span class="sxs-lookup"><span data-stu-id="bada9-160">Therefore, there needs to be a way to map a user entity from one domain (microservice) to another.</span></span>

<span data-ttu-id="bada9-161">Il existe plusieurs avantages à ne pas partager la même entité utilisateur avec le même nombre d’attributs entre les domaines.</span><span class="sxs-lookup"><span data-stu-id="bada9-161">There are several benefits to not sharing the same user entity with the same number of attributes across domains.</span></span> <span data-ttu-id="bada9-162">Un des avantages est de réduire la duplication, de façon que les modèles de microservice n’aient pas les données dont ils n’ont pas besoin.</span><span class="sxs-lookup"><span data-stu-id="bada9-162">One benefit is to reduce duplication, so that microservice models do not have any data that they do not need.</span></span> <span data-ttu-id="bada9-163">Un autre avantage est d’avoir un microservice maître qui détient un certain type de données par entité, afin que les mises à jour et les requêtes pour ce type de données soient pilotées seulement par ce microservice.</span><span class="sxs-lookup"><span data-stu-id="bada9-163">Another benefit is having a master microservice that owns a certain type of data per entity so that updates and queries for that type of data are driven only by that microservice.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="bada9-164">[Précédent](distributed-data-management.md)
>[Suivant](direct-client-to-microservice-communication-versus-the-api-gateway-pattern.md)</span><span class="sxs-lookup"><span data-stu-id="bada9-164">[Previous](distributed-data-management.md)
[Next](direct-client-to-microservice-communication-versus-the-api-gateway-pattern.md)</span></span>
