---
title: Copie de nœuds existants d'un document à un autre
ms.custom: ''
ms.date: 03/30/2017
ms.prod: .net
ms.reviewer: ''
ms.suite: ''
ms.technology: dotnet-standard
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 3caa78c1-3448-4b7b-b83c-228ee857635e
caps.latest.revision: ''
author: mairaw
ms.author: mairaw
manager: wpickett
ms.workload:
- dotnet
- dotnetcore
ms.openlocfilehash: 958dccfc184857b0edd12cd1d9afe7b3b468b1e6
ms.sourcegitcommit: c883637b41ee028786edceece4fa872939d2e64c
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/26/2018
---
# <a name="copying-existing-nodes-from-one-document-to-another"></a><span data-ttu-id="a33e6-102">Copie de nœuds existants d'un document à un autre</span><span class="sxs-lookup"><span data-stu-id="a33e6-102">Copying Existing Nodes from One Document to Another</span></span>
<span data-ttu-id="a33e6-103">La méthode **ImportNode** est le mécanisme par lequel un nœud ou un sous-arbre de nœuds entier est copié d'un **XmlDocument** à un autre.</span><span class="sxs-lookup"><span data-stu-id="a33e6-103">The **ImportNode** method is the mechanism by which a node or entire node subtree is copied from one **XmlDocument** to another.</span></span> <span data-ttu-id="a33e6-104">Le nœud retourné par l'appel est une copie du nœud issu du document source, y compris sur le plan des valeurs d'attribut, du nom du nœud, du type de nœud et de tous les attributs associés à l'espace de noms tels que le préfixe, le nom local et l'URI (Uniform Resource Identifier) d'espace de noms.</span><span class="sxs-lookup"><span data-stu-id="a33e6-104">The node returned from the call is a copy of the node from the source document, including attribute values, the node name, node type, and all namespace-related attributes such as the prefix, local name, and namespace Uniform Resource Identifier (URI).</span></span> <span data-ttu-id="a33e6-105">Le document source n'est pas modifié.</span><span class="sxs-lookup"><span data-stu-id="a33e6-105">The source document is not changed.</span></span> <span data-ttu-id="a33e6-106">À l'issue de l'importation du nœud, il vous reste encore à l'ajouter à l'arborescence à l'aide d'une des méthodes d'insertion de nœuds.</span><span class="sxs-lookup"><span data-stu-id="a33e6-106">After you have imported the node, you still have to add it to the tree using one of the methods used to insert nodes.</span></span>  
  
 <span data-ttu-id="a33e6-107">Dès que le nœud a été joint à son nouveau document, ce dernier en prend possession.</span><span class="sxs-lookup"><span data-stu-id="a33e6-107">When the node is attached to its new document, the new document owns the node.</span></span> <span data-ttu-id="a33e6-108">En effet, chaque nœud, lors de sa création, possède un document propriétaire, même si les nœuds sont créés dans des fragments de document distincts.</span><span class="sxs-lookup"><span data-stu-id="a33e6-108">The reason is that each node, when created, has an owning document, even if the nodes are created in separate document fragments.</span></span> <span data-ttu-id="a33e6-109">Il s’agit d’une exigence imposée par le DOM (Document Object Model) XML, qui est appliquée par le design de création de factory à la classe **XmlDocument**.</span><span class="sxs-lookup"><span data-stu-id="a33e6-109">This is a requirement of the XML Document Object Model (DOM) and is enforced by the factory creation design on the **XmlDocument** class.</span></span> <span data-ttu-id="a33e6-110">Par exemple, **CreateElement** constitue la seule solution pour créer de nouveaux nœuds.</span><span class="sxs-lookup"><span data-stu-id="a33e6-110">For example, **CreateElement**, is the only way to create new nodes.</span></span>  
  
 <span data-ttu-id="a33e6-111">En fonction du type de nœud que présente le nœud importé et de la valeur du paramètre *deep*, d'autres informations sont éventuellement copiées.</span><span class="sxs-lookup"><span data-stu-id="a33e6-111">Depending on the node type of the imported node and the value of the *deep* parameter, additional information is copied as appropriate.</span></span> <span data-ttu-id="a33e6-112">Cette méthode tente de refléter le comportement attendu si un fragment de code source HTML ou XML était copié d'un document à un autre, en tenant compte du fait que, dans le cas d'un document XML, les deux documents peuvent posséder des définitions de type de document (DTD) différentes.</span><span class="sxs-lookup"><span data-stu-id="a33e6-112">This method attempts to mirror the behavior expected if a fragment of XML or HTML source was copied from one document to another, accounting for the fact that for XML, the two documents may have different document type definitions (DTDs).</span></span>  
  
 <span data-ttu-id="a33e6-113">Le tableau suivant décrit le comportement spécifique pour chaque type of nœud pouvant être importé.</span><span class="sxs-lookup"><span data-stu-id="a33e6-113">The following table describes the specific behavior for each type of node that can be imported.</span></span>  
  
|<span data-ttu-id="a33e6-114">Type de nœud</span><span class="sxs-lookup"><span data-stu-id="a33e6-114">Node Type</span></span>|<span data-ttu-id="a33e6-115">Paramètre *deep* avec la valeur true</span><span class="sxs-lookup"><span data-stu-id="a33e6-115">*deep* parameter is true</span></span>|<span data-ttu-id="a33e6-116">Paramètre *deep* avec la valeur false</span><span class="sxs-lookup"><span data-stu-id="a33e6-116">*deep* parameter is false</span></span>|  
|---------------|------------------------------|-------------------------------|  
|<span data-ttu-id="a33e6-117">XmlAttribute</span><span class="sxs-lookup"><span data-stu-id="a33e6-117">XmlAttribute</span></span>|<span data-ttu-id="a33e6-118"><xref:System.Xml.XmlAttribute.Specified%2A> a la valeur **true** sur XmlAttribute.</span><span class="sxs-lookup"><span data-stu-id="a33e6-118">The <xref:System.Xml.XmlAttribute.Specified%2A> is set to **true** on the XmlAttribute.</span></span> <span data-ttu-id="a33e6-119">Les descendants du **XmlAttribute** source sont importés de façon récursive et les nœuds résultants sont assemblés à nouveau pour former le sous-arbre correspondant.</span><span class="sxs-lookup"><span data-stu-id="a33e6-119">The descendants of the source **XmlAttribute** are recursively imported and the resulting nodes reassembled to form the corresponding subtree.</span></span>|<span data-ttu-id="a33e6-120">Le paramètre *deep* ne s'applique pas aux nœuds **XmlAttribute**, parce qu'ils emportent toujours avec eux leurs nœuds enfants lorsqu'ils sont importés.</span><span class="sxs-lookup"><span data-stu-id="a33e6-120">The *deep* parameter does not apply to **XmlAttribute** nodes, because they always carry their child nodes with them when imported.</span></span>|  
|<span data-ttu-id="a33e6-121">XmlCDataSection</span><span class="sxs-lookup"><span data-stu-id="a33e6-121">XmlCDataSection</span></span>|<span data-ttu-id="a33e6-122">Copie le nœud avec ses données.</span><span class="sxs-lookup"><span data-stu-id="a33e6-122">Copies the node, including its data.</span></span>|<span data-ttu-id="a33e6-123">Copie le nœud avec ses données.</span><span class="sxs-lookup"><span data-stu-id="a33e6-123">Copies the node, including its data.</span></span>|  
|<span data-ttu-id="a33e6-124">XmlComment</span><span class="sxs-lookup"><span data-stu-id="a33e6-124">XmlComment</span></span>|<span data-ttu-id="a33e6-125">Copie le nœud avec ses données.</span><span class="sxs-lookup"><span data-stu-id="a33e6-125">Copies the node, including its data.</span></span>|<span data-ttu-id="a33e6-126">Copie le nœud avec ses données.</span><span class="sxs-lookup"><span data-stu-id="a33e6-126">Copies the node, including its data.</span></span>|  
|<span data-ttu-id="a33e6-127">XmlDocumentFragment</span><span class="sxs-lookup"><span data-stu-id="a33e6-127">XmlDocumentFragment</span></span>|<span data-ttu-id="a33e6-128">Les descendants du nœud source sont importés de manière récursive et les nœuds obtenus sont réassemblés pour former le sous-arbre correspondant.</span><span class="sxs-lookup"><span data-stu-id="a33e6-128">The descendants of the source node are recursively imported and the resulting nodes reassembled to form the corresponding subtree.</span></span>|<span data-ttu-id="a33e6-129">Un **XmlDocumentFragment** vide est créé.</span><span class="sxs-lookup"><span data-stu-id="a33e6-129">An empty **XmlDocumentFragment** is created.</span></span>|  
|<span data-ttu-id="a33e6-130">XmlDocumentType</span><span class="sxs-lookup"><span data-stu-id="a33e6-130">XmlDocumentType</span></span>|<span data-ttu-id="a33e6-131">Copie le nœud avec ses données.\*</span><span class="sxs-lookup"><span data-stu-id="a33e6-131">Copies the node, including its data.\*</span></span>|<span data-ttu-id="a33e6-132">Copie le nœud avec ses données.\*</span><span class="sxs-lookup"><span data-stu-id="a33e6-132">Copies the node, including its data.\*</span></span>|  
|<span data-ttu-id="a33e6-133">XmlElement</span><span class="sxs-lookup"><span data-stu-id="a33e6-133">XmlElement</span></span>|<span data-ttu-id="a33e6-134">Les descendants de l'élément source sont importés de façon récursive et les nœuds résultants sont assemblés à nouveau pour former le sous-arbre correspondant.</span><span class="sxs-lookup"><span data-stu-id="a33e6-134">The descendants of the source element are recursively imported and the resulting nodes reassembled to form the corresponding subtree.</span></span> <span data-ttu-id="a33e6-135">**Remarque :** les attributs par défaut ne sont pas copiés.</span><span class="sxs-lookup"><span data-stu-id="a33e6-135">**Note:**  Default attributes are not copied.</span></span> <span data-ttu-id="a33e6-136">Si le document destinataire de l'importation définit des attributs par défaut pour ce nom d'élément, ces attributs sont assignés.</span><span class="sxs-lookup"><span data-stu-id="a33e6-136">If the document being imported into defines default attributes for this element name, those are assigned.</span></span>|<span data-ttu-id="a33e6-137">Les nœuds d'attribut spécifiés de l'élément source sont importés et les nœuds **XmlAttribute** générés sont joints au nouvel élément.</span><span class="sxs-lookup"><span data-stu-id="a33e6-137">Specified attribute nodes of the source element are imported, and the generated **XmlAttribute** nodes are attached to the new element.</span></span> <span data-ttu-id="a33e6-138">Les nœuds descendants ne sont pas copiés.</span><span class="sxs-lookup"><span data-stu-id="a33e6-138">The descendant nodes are not copied.</span></span> <span data-ttu-id="a33e6-139">**Remarque :** les attributs par défaut ne sont pas copiés.</span><span class="sxs-lookup"><span data-stu-id="a33e6-139">**Note:**  Default attributes are not copied.</span></span> <span data-ttu-id="a33e6-140">Si le document destinataire de l'importation définit des attributs par défaut pour ce nom d'élément, ces attributs sont assignés.</span><span class="sxs-lookup"><span data-stu-id="a33e6-140">If the document being imported into defines default attributes for this element name, those are assigned.</span></span>|  
|<span data-ttu-id="a33e6-141">XmlEntityReference</span><span class="sxs-lookup"><span data-stu-id="a33e6-141">XmlEntityReference</span></span>|<span data-ttu-id="a33e6-142">Étant donné que les documents source et de destination peuvent comporter des définitions différentes des entités, cette méthode ne copie que le nœud **XmlEntityReference**.</span><span class="sxs-lookup"><span data-stu-id="a33e6-142">Because the source and destination documents could have the entities defined differently, this method only copies the **XmlEntityReference** node.</span></span> <span data-ttu-id="a33e6-143">Le texte de remplacement n'est pas inclus.</span><span class="sxs-lookup"><span data-stu-id="a33e6-143">The replacement text is not included.</span></span> <span data-ttu-id="a33e6-144">Si l'entité est définie dans le document de destination, sa valeur est assignée.</span><span class="sxs-lookup"><span data-stu-id="a33e6-144">If the destination document has the entity defined, its value is assigned.</span></span>|<span data-ttu-id="a33e6-145">Étant donné que les documents source et de destination peuvent comporter des définitions différentes des entités, cette méthode ne copie que le nœud **XmlEntityReference**.</span><span class="sxs-lookup"><span data-stu-id="a33e6-145">Because the source and destination documents could have the entities defined differently, this method only copies the **XmlEntityReference** node.</span></span> <span data-ttu-id="a33e6-146">Le texte de remplacement n'est pas inclus.</span><span class="sxs-lookup"><span data-stu-id="a33e6-146">The replacement text is not included.</span></span> <span data-ttu-id="a33e6-147">Si l'entité est définie dans le document de destination, sa valeur est assignée.</span><span class="sxs-lookup"><span data-stu-id="a33e6-147">If the destination document has the entity defined, its value is assigned.</span></span>|  
|<span data-ttu-id="a33e6-148">XmlProcessingInstruction</span><span class="sxs-lookup"><span data-stu-id="a33e6-148">XmlProcessingInstruction</span></span>|<span data-ttu-id="a33e6-149">Copie la cible et la valeur de données à partir du nœud importé.</span><span class="sxs-lookup"><span data-stu-id="a33e6-149">Copies the target and data value from the imported node.</span></span>|<span data-ttu-id="a33e6-150">Copie la cible et la valeur de données à partir du nœud importé.</span><span class="sxs-lookup"><span data-stu-id="a33e6-150">Copies the target and data value from the imported node.</span></span>|  
|<span data-ttu-id="a33e6-151">XmlText</span><span class="sxs-lookup"><span data-stu-id="a33e6-151">XmlText</span></span>|<span data-ttu-id="a33e6-152">Copie le nœud avec ses données.</span><span class="sxs-lookup"><span data-stu-id="a33e6-152">Copies the node, including its data.</span></span>|<span data-ttu-id="a33e6-153">Copie le nœud avec ses données.</span><span class="sxs-lookup"><span data-stu-id="a33e6-153">Copies the node, including its data.</span></span>|  
|<span data-ttu-id="a33e6-154">XmlSignificantWhitespace</span><span class="sxs-lookup"><span data-stu-id="a33e6-154">XmlSignificantWhitespace</span></span>|<span data-ttu-id="a33e6-155">Copie le nœud avec ses données.</span><span class="sxs-lookup"><span data-stu-id="a33e6-155">Copies the node, including its data.</span></span>|<span data-ttu-id="a33e6-156">Copie le nœud avec ses données.</span><span class="sxs-lookup"><span data-stu-id="a33e6-156">Copies the node, including its data.</span></span>|  
|<span data-ttu-id="a33e6-157">XmlWhitespace</span><span class="sxs-lookup"><span data-stu-id="a33e6-157">XmlWhitespace</span></span>|<span data-ttu-id="a33e6-158">Copie le nœud avec ses données.</span><span class="sxs-lookup"><span data-stu-id="a33e6-158">Copies the node, including its data.</span></span>|<span data-ttu-id="a33e6-159">Copie le nœud avec ses données.</span><span class="sxs-lookup"><span data-stu-id="a33e6-159">Copies the node, including its data.</span></span>|  
|<span data-ttu-id="a33e6-160">XmlDeclaration</span><span class="sxs-lookup"><span data-stu-id="a33e6-160">XmlDeclaration</span></span>|<span data-ttu-id="a33e6-161">Copie la cible et la valeur de données à partir du nœud importé.</span><span class="sxs-lookup"><span data-stu-id="a33e6-161">Copies the target and data value from the imported node.</span></span>|<span data-ttu-id="a33e6-162">Copie la cible et la valeur de données à partir du nœud importé.</span><span class="sxs-lookup"><span data-stu-id="a33e6-162">Copies the target and data value from the imported node.</span></span>|  
|<span data-ttu-id="a33e6-163">Tous les autres types de nœuds</span><span class="sxs-lookup"><span data-stu-id="a33e6-163">All other node types</span></span>|<span data-ttu-id="a33e6-164">Ces types de nœuds ne peuvent pas être importés.</span><span class="sxs-lookup"><span data-stu-id="a33e6-164">These node types cannot be imported.</span></span>|<span data-ttu-id="a33e6-165">Ces types de nœuds ne peuvent pas être importés.</span><span class="sxs-lookup"><span data-stu-id="a33e6-165">These node types cannot be imported.</span></span>|  
  
> [!NOTE]
>  <span data-ttu-id="a33e6-166">Bien que les nœuds DocumentType puissent être importés, un document ne peut avoir qu'un seul DocumentType.</span><span class="sxs-lookup"><span data-stu-id="a33e6-166">Although DocumentType nodes can be imported, a document can only have one DocumentType.</span></span> <span data-ttu-id="a33e6-167">Par conséquent, dès que vous avez importé le type de document, vous devez vous assurer, avant de l’insérer dans l’arborescence, que le document est dépourvu de type de document.</span><span class="sxs-lookup"><span data-stu-id="a33e6-167">So, once you have imported the document type, before inserting it into tree you have to make sure that there is no document type in the document.</span></span> <span data-ttu-id="a33e6-168">Pour plus d’informations sur la suppression de nœuds, consultez [Suppression de nœuds, de contenu et de valeurs d'un document XML](../../../../docs/standard/data/xml/removing-nodes-content-and-values-from-an-xml-document.md).</span><span class="sxs-lookup"><span data-stu-id="a33e6-168">For information on removing nodes, see [Removing Nodes, Content, and Values from an XML Document](../../../../docs/standard/data/xml/removing-nodes-content-and-values-from-an-xml-document.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="a33e6-169">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="a33e6-169">See Also</span></span>  
 [<span data-ttu-id="a33e6-170">DOM (Document Object Model) XML</span><span class="sxs-lookup"><span data-stu-id="a33e6-170">XML Document Object Model (DOM)</span></span>](../../../../docs/standard/data/xml/xml-document-object-model-dom.md)
