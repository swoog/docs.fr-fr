---
title: "Accès concurrentiel optimiste : Vue d'ensemble"
ms.date: 03/30/2017
ms.assetid: c2e38512-d0c8-4807-b30a-cb7e30338694
ms.openlocfilehash: 8f3bd35cc1391339d99d5aa0a4021e29fa81756c
ms.sourcegitcommit: 5b6d778ebb269ee6684fb57ad69a8c28b06235b9
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/08/2019
ms.locfileid: "59106546"
---
# <a name="optimistic-concurrency-overview"></a><span data-ttu-id="b6dbc-102">Accès concurrentiel optimiste : Vue d'ensemble</span><span class="sxs-lookup"><span data-stu-id="b6dbc-102">Optimistic Concurrency: Overview</span></span>
[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] <span data-ttu-id="b6dbc-103">prend en charge le contrôle d’accès concurrentiel optimiste.</span><span class="sxs-lookup"><span data-stu-id="b6dbc-103">supports optimistic concurrency control.</span></span> <span data-ttu-id="b6dbc-104">Le tableau suivant décrit les conditions qui s’appliquent à l’accès concurrentiel optimiste dans [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] documentation :</span><span class="sxs-lookup"><span data-stu-id="b6dbc-104">The following table describes terms that apply to optimistic concurrency in [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] documentation:</span></span>  
  
|<span data-ttu-id="b6dbc-105">Termes</span><span class="sxs-lookup"><span data-stu-id="b6dbc-105">Terms</span></span>|<span data-ttu-id="b6dbc-106">Description</span><span class="sxs-lookup"><span data-stu-id="b6dbc-106">Description</span></span>|  
|-----------|-----------------|  
|<span data-ttu-id="b6dbc-107">concurrence</span><span class="sxs-lookup"><span data-stu-id="b6dbc-107">concurrency</span></span>|<span data-ttu-id="b6dbc-108">Situation dans laquelle deux utilisateurs ou plus essaient simultanément de mettre à jour la même ligne de base de données.</span><span class="sxs-lookup"><span data-stu-id="b6dbc-108">The situation in which two or more users at the same time try to update the same database row.</span></span>|  
|<span data-ttu-id="b6dbc-109">conflit de concurrence</span><span class="sxs-lookup"><span data-stu-id="b6dbc-109">concurrency conflict</span></span>|<span data-ttu-id="b6dbc-110">Situation dans laquelle deux utilisateurs ou plus essaient simultanément de soumettre des valeurs incompatibles à une ou plusieurs colonnes d'une ligne.</span><span class="sxs-lookup"><span data-stu-id="b6dbc-110">The situation in which two or more users at the same time try to submit conflicting values to one or more columns of a row.</span></span>|  
|<span data-ttu-id="b6dbc-111">contrôle d'accès concurrentiel</span><span class="sxs-lookup"><span data-stu-id="b6dbc-111">concurrency control</span></span>|<span data-ttu-id="b6dbc-112">Technique utilisée pour résoudre des conflits d'accès concurrentiel.</span><span class="sxs-lookup"><span data-stu-id="b6dbc-112">The technique used to resolve concurrency conflicts.</span></span>|  
|<span data-ttu-id="b6dbc-113">contrôle concurrentiel optimiste</span><span class="sxs-lookup"><span data-stu-id="b6dbc-113">optimistic concurrency control</span></span>|<span data-ttu-id="b6dbc-114">Technique qui recherche d’abord si d’autres transactions ont modifié les valeurs d’une ligne avant d’autoriser la soumission des modifications.</span><span class="sxs-lookup"><span data-stu-id="b6dbc-114">The technique that first investigates whether other transactions have changed values in a row before permitting changes to be submitted.</span></span><br /><br /> <span data-ttu-id="b6dbc-115">Par contraste *contrôle d’accès concurrentiel pessimiste*, qui verrouille l’enregistrement afin d’éviter les conflits d’accès concurrentiel.</span><span class="sxs-lookup"><span data-stu-id="b6dbc-115">Contrast with *pessimistic concurrency control*, which locks the record to avoid concurrency conflicts.</span></span><br /><br /> <span data-ttu-id="b6dbc-116">*Optimiste* contrôle est appelé ainsi car il considère que les risques d’une transaction interfère avec une autre sont faibles.</span><span class="sxs-lookup"><span data-stu-id="b6dbc-116">*Optimistic* control is so termed because it considers the chances of one transaction interfering with another to be unlikely.</span></span>|  
|<span data-ttu-id="b6dbc-117">résolution de conflit</span><span class="sxs-lookup"><span data-stu-id="b6dbc-117">conflict resolution</span></span>|<span data-ttu-id="b6dbc-118">Processus d'actualisation d'un élément en conflit en interrogeant de nouveau la base de données, puis en harmonisant les différences.</span><span class="sxs-lookup"><span data-stu-id="b6dbc-118">The process of refreshing a conflicting item by querying the database again and then reconciling differences.</span></span><br /><br /> <span data-ttu-id="b6dbc-119">Lorsqu'un objet est actualisé, le dispositif de suivi des modifications [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] contient les données suivantes :</span><span class="sxs-lookup"><span data-stu-id="b6dbc-119">When an object is refreshed, the [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] change tracker holds the following data:</span></span><br /><br /> <span data-ttu-id="b6dbc-120">-Les valeurs à l’origine à partir de la base de données et l’utiliser pour la mise à jour vérifier.</span><span class="sxs-lookup"><span data-stu-id="b6dbc-120">-   The values originally taken from the database and used for the update check.</span></span><br /><span data-ttu-id="b6dbc-121">-Les nouvelles valeurs de base de données à partir de la requête suivante.</span><span class="sxs-lookup"><span data-stu-id="b6dbc-121">-   The new database values from the subsequent query.</span></span><br /><br /> [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] <span data-ttu-id="b6dbc-122">détermine ensuite si l’objet est en conflit (autrement dit, si un ou plusieurs de ses valeurs membres a changé).</span><span class="sxs-lookup"><span data-stu-id="b6dbc-122">then determines whether the object is in conflict (that is, whether one or more of its member values has changed).</span></span> <span data-ttu-id="b6dbc-123">Si l’objet est en conflit, [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] détermine ensuite lesquels de ses membres sont en conflit.</span><span class="sxs-lookup"><span data-stu-id="b6dbc-123">If the object is in conflict, [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] next determines which of its members are in conflict.</span></span><br /><br /> <span data-ttu-id="b6dbc-124">Tout conflit entre membres que [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] découvre est ajouté à une liste de conflits.</span><span class="sxs-lookup"><span data-stu-id="b6dbc-124">Any member conflict that [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] discovers is added to a conflict list.</span></span>|  
  
 <span data-ttu-id="b6dbc-125">Dans le [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] modèle d’objet, un *conflit d’accès concurrentiel optimiste* se produit lorsque les deux conditions suivantes sont remplies :</span><span class="sxs-lookup"><span data-stu-id="b6dbc-125">In the [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] object model, an *optimistic concurrency conflict* occurs when both of the following conditions are true:</span></span>  
  
-   <span data-ttu-id="b6dbc-126">Le client tente de soumettre des modifications à la base de données.</span><span class="sxs-lookup"><span data-stu-id="b6dbc-126">The client tries to submit changes to the database.</span></span>  
  
-   <span data-ttu-id="b6dbc-127">Une ou plusieurs valeurs de vérification de mise à jour ont été mises à jour dans la base de données depuis la dernière fois que le client les a lues.</span><span class="sxs-lookup"><span data-stu-id="b6dbc-127">One or more update-check values have been updated in the database since the client last read them.</span></span>  
  
 <span data-ttu-id="b6dbc-128">La résolution de ce conflit inclut la découverte des membres de l'objet qui sont en conflit, puis la décision relative à l'action que vous souhaitez effectuer.</span><span class="sxs-lookup"><span data-stu-id="b6dbc-128">Resolution of this conflict includes discovering which members of the object are in conflict, and then deciding what you want to do about it.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="b6dbc-129">Seuls les membres mappés comme <xref:System.Data.Linq.Mapping.UpdateCheck.Always> ou <xref:System.Data.Linq.Mapping.UpdateCheck.WhenChanged> participent aux contrôles d'accès concurrentiel optimiste.</span><span class="sxs-lookup"><span data-stu-id="b6dbc-129">Only members mapped as <xref:System.Data.Linq.Mapping.UpdateCheck.Always> or <xref:System.Data.Linq.Mapping.UpdateCheck.WhenChanged> participate in optimistic concurrency checks.</span></span> <span data-ttu-id="b6dbc-130">Aucun contrôle n'est effectué pour les membres marqués <xref:System.Data.Linq.Mapping.UpdateCheck.Never>.</span><span class="sxs-lookup"><span data-stu-id="b6dbc-130">No check is performed for members marked <xref:System.Data.Linq.Mapping.UpdateCheck.Never>.</span></span> <span data-ttu-id="b6dbc-131">Pour plus d'informations, consultez <xref:System.Data.Linq.Mapping.UpdateCheck>.</span><span class="sxs-lookup"><span data-stu-id="b6dbc-131">For more information, see <xref:System.Data.Linq.Mapping.UpdateCheck>.</span></span>  
  
## <a name="example"></a><span data-ttu-id="b6dbc-132">Exemple</span><span class="sxs-lookup"><span data-stu-id="b6dbc-132">Example</span></span>  
 <span data-ttu-id="b6dbc-133">Par exemple, dans le scénario suivant, User1 commence à préparer une mise à jour en interrogeant la base de données pour une ligne.</span><span class="sxs-lookup"><span data-stu-id="b6dbc-133">For example, in the following scenario, User1 starts to prepare an update by querying the database for a row.</span></span> <span data-ttu-id="b6dbc-134">User1 reçoit une ligne avec les valeurs Alfreds, Maria et Sales.</span><span class="sxs-lookup"><span data-stu-id="b6dbc-134">User1 receives a row with values of Alfreds, Maria, and Sales.</span></span>  
  
 <span data-ttu-id="b6dbc-135">User1 souhaite modifier la valeur de la colonne Manager en Alfred et la valeur de la colonne Department en Marketing.</span><span class="sxs-lookup"><span data-stu-id="b6dbc-135">User1 wants to change the value of the Manager column to Alfred and the value of the Department column to Marketing.</span></span> <span data-ttu-id="b6dbc-136">Avant que User1 puisse soumettre ces modifications, User2 a soumis des modifications à la base de données.</span><span class="sxs-lookup"><span data-stu-id="b6dbc-136">Before User1 can submit those changes, User2 has submitted changes to the database.</span></span> <span data-ttu-id="b6dbc-137">Désormais, la valeur de la colonne Assistant a donc été modifiée en Mary et la valeur de la colonne Department en Service.</span><span class="sxs-lookup"><span data-stu-id="b6dbc-137">So now the value of the Assistant column has been changed to Mary and the value of the Department column to Service.</span></span>  
  
 <span data-ttu-id="b6dbc-138">Lorsque User1 tente à présent de soumettre des modifications, la soumission échoue et une exception <xref:System.Data.Linq.ChangeConflictException> est levée.</span><span class="sxs-lookup"><span data-stu-id="b6dbc-138">When User1 now tries to submit changes, the submission fails and a <xref:System.Data.Linq.ChangeConflictException> exception is thrown.</span></span> <span data-ttu-id="b6dbc-139">Ce résultat se produit car les valeurs de base de données des colonnes Assistant et Department ne sont pas celles qui étaient attendues.</span><span class="sxs-lookup"><span data-stu-id="b6dbc-139">This result occurs because the database values for the Assistant column and the Department column are not those that were expected.</span></span> <span data-ttu-id="b6dbc-140">Les membres représentant les colonnes Assistant et Department sont en conflit.</span><span class="sxs-lookup"><span data-stu-id="b6dbc-140">Members representing the Assistant and Department columns are in conflict.</span></span> <span data-ttu-id="b6dbc-141">Le tableau suivant récapitule la situation :</span><span class="sxs-lookup"><span data-stu-id="b6dbc-141">The following table summarizes the situation.</span></span>  
  
||<span data-ttu-id="b6dbc-142">Responsable</span><span class="sxs-lookup"><span data-stu-id="b6dbc-142">Manager</span></span>|<span data-ttu-id="b6dbc-143">Assistant</span><span class="sxs-lookup"><span data-stu-id="b6dbc-143">Assistant</span></span>|<span data-ttu-id="b6dbc-144">Department</span><span class="sxs-lookup"><span data-stu-id="b6dbc-144">Department</span></span>|  
|------|-------------|---------------|----------------|  
|<span data-ttu-id="b6dbc-145">État d'origine</span><span class="sxs-lookup"><span data-stu-id="b6dbc-145">Original state</span></span>|<span data-ttu-id="b6dbc-146">Alfreds</span><span class="sxs-lookup"><span data-stu-id="b6dbc-146">Alfreds</span></span>|<span data-ttu-id="b6dbc-147">Maria</span><span class="sxs-lookup"><span data-stu-id="b6dbc-147">Maria</span></span>|<span data-ttu-id="b6dbc-148">Sales</span><span class="sxs-lookup"><span data-stu-id="b6dbc-148">Sales</span></span>|  
|<span data-ttu-id="b6dbc-149">Utilisateur1</span><span class="sxs-lookup"><span data-stu-id="b6dbc-149">User1</span></span>|<span data-ttu-id="b6dbc-150">Alfred</span><span class="sxs-lookup"><span data-stu-id="b6dbc-150">Alfred</span></span>||<span data-ttu-id="b6dbc-151">Marketing</span><span class="sxs-lookup"><span data-stu-id="b6dbc-151">Marketing</span></span>|  
|<span data-ttu-id="b6dbc-152">User2</span><span class="sxs-lookup"><span data-stu-id="b6dbc-152">User2</span></span>||<span data-ttu-id="b6dbc-153">Mary</span><span class="sxs-lookup"><span data-stu-id="b6dbc-153">Mary</span></span>|<span data-ttu-id="b6dbc-154">Service</span><span class="sxs-lookup"><span data-stu-id="b6dbc-154">Service</span></span>|  
  
 <span data-ttu-id="b6dbc-155">Vous pouvez résoudre des conflits comme celui-ci de différentes façons.</span><span class="sxs-lookup"><span data-stu-id="b6dbc-155">You can resolve conflicts such as this in different ways.</span></span> <span data-ttu-id="b6dbc-156">Pour plus d'informations, voir [Procédure : Gérer les conflits de changement](../../../../../../docs/framework/data/adonet/sql/linq/how-to-manage-change-conflicts.md).</span><span class="sxs-lookup"><span data-stu-id="b6dbc-156">For more information, see [How to: Manage Change Conflicts](../../../../../../docs/framework/data/adonet/sql/linq/how-to-manage-change-conflicts.md).</span></span>  
  
## <a name="conflict-detection-and-resolution-checklist"></a><span data-ttu-id="b6dbc-157">Détection de conflit et liste de vérification de résolution</span><span class="sxs-lookup"><span data-stu-id="b6dbc-157">Conflict Detection and Resolution Checklist</span></span>  
 <span data-ttu-id="b6dbc-158">Vous pouvez détecter et résoudre des conflits à n'importe quel niveau de détail.</span><span class="sxs-lookup"><span data-stu-id="b6dbc-158">You can detect and resolve conflicts at any level of detail.</span></span> <span data-ttu-id="b6dbc-159">Une approche consiste à résoudre tous les conflits à l'aide d'une des trois façons (consultez <xref:System.Data.Linq.RefreshMode>) sans considération supplémentaire.</span><span class="sxs-lookup"><span data-stu-id="b6dbc-159">At one extreme, you can resolve all conflicts in one of three ways (see <xref:System.Data.Linq.RefreshMode>) without additional consideration.</span></span> <span data-ttu-id="b6dbc-160">Une autre approche consiste à désigner une action spécifique pour chaque type de conflit sur tous les membres en conflit.</span><span class="sxs-lookup"><span data-stu-id="b6dbc-160">At the other extreme, you can designate a specific action for each type of conflict on every member in conflict.</span></span>  
  
-   <span data-ttu-id="b6dbc-161">Spécifiez ou modifiez des options <xref:System.Data.Linq.Mapping.UpdateCheck> dans votre modèle objet.</span><span class="sxs-lookup"><span data-stu-id="b6dbc-161">Specify or revise <xref:System.Data.Linq.Mapping.UpdateCheck> options in your object model.</span></span>  
  
     <span data-ttu-id="b6dbc-162">Pour plus d'informations, voir [Procédure : Spécifier les membres sont vérifiés pour les conflits d’accès concurrentiel](../../../../../../docs/framework/data/adonet/sql/linq/how-to-specify-which-members-are-tested-for-concurrency-conflicts.md).</span><span class="sxs-lookup"><span data-stu-id="b6dbc-162">For more information, see [How to: Specify Which Members are Tested for Concurrency Conflicts](../../../../../../docs/framework/data/adonet/sql/linq/how-to-specify-which-members-are-tested-for-concurrency-conflicts.md).</span></span>  
  
-   <span data-ttu-id="b6dbc-163">Dans le bloc try/catch de votre appel à <xref:System.Data.Linq.DataContext.SubmitChanges%2A>, spécifiez à quel point vous souhaitez que les exceptions soient levées.</span><span class="sxs-lookup"><span data-stu-id="b6dbc-163">In the try/catch block of your call to <xref:System.Data.Linq.DataContext.SubmitChanges%2A>, specify at what point you want exceptions to be thrown.</span></span>  
  
     <span data-ttu-id="b6dbc-164">Pour plus d'informations, voir [Procédure : Spécifiez quand les Exceptions d’accès concurrentiel sont levées](../../../../../../docs/framework/data/adonet/sql/linq/how-to-specify-when-concurrency-exceptions-are-thrown.md).</span><span class="sxs-lookup"><span data-stu-id="b6dbc-164">For more information, see [How to: Specify When Concurrency Exceptions are Thrown](../../../../../../docs/framework/data/adonet/sql/linq/how-to-specify-when-concurrency-exceptions-are-thrown.md).</span></span>  
  
-   <span data-ttu-id="b6dbc-165">Déterminez la quantité de détails du conflit que vous souhaitez récupérer et incluez le code dans votre bloc try/catch en conséquence.</span><span class="sxs-lookup"><span data-stu-id="b6dbc-165">Determine how much conflict detail you want to retrieve, and include code in your try/catch block accordingly.</span></span>  
  
     <span data-ttu-id="b6dbc-166">Pour plus d'informations, voir [Procédure : Récupérer des informations de conflit d’entité](../../../../../../docs/framework/data/adonet/sql/linq/how-to-retrieve-entity-conflict-information.md) et [Comment : Récupérer des informations sur les conflits de membre](../../../../../../docs/framework/data/adonet/sql/linq/how-to-retrieve-member-conflict-information.md).</span><span class="sxs-lookup"><span data-stu-id="b6dbc-166">For more information, see [How to: Retrieve Entity Conflict Information](../../../../../../docs/framework/data/adonet/sql/linq/how-to-retrieve-entity-conflict-information.md) and [How to: Retrieve Member Conflict Information](../../../../../../docs/framework/data/adonet/sql/linq/how-to-retrieve-member-conflict-information.md).</span></span>  
  
-   <span data-ttu-id="b6dbc-167">Inclure dans votre `try` / `catch` code la façon dont vous souhaitez résoudre les différents conflits que vous découvrez.</span><span class="sxs-lookup"><span data-stu-id="b6dbc-167">Include in your `try`/`catch` code how you want to resolve the various conflicts you discover.</span></span>  
  
     <span data-ttu-id="b6dbc-168">Pour plus d'informations, voir [Procédure : Résoudre les conflits en conservant des valeurs de la base de données](../../../../../../docs/framework/data/adonet/sql/linq/how-to-resolve-conflicts-by-retaining-database-values.md), [Comment : Résoudre les conflits en remplaçant des valeurs de la base de données](../../../../../../docs/framework/data/adonet/sql/linq/how-to-resolve-conflicts-by-overwriting-database-values.md), et [Comment : Résoudre les conflits en fusionnant des valeurs de la base de données](../../../../../../docs/framework/data/adonet/sql/linq/how-to-resolve-conflicts-by-merging-with-database-values.md).</span><span class="sxs-lookup"><span data-stu-id="b6dbc-168">For more information, see [How to: Resolve Conflicts by Retaining Database Values](../../../../../../docs/framework/data/adonet/sql/linq/how-to-resolve-conflicts-by-retaining-database-values.md), [How to: Resolve Conflicts by Overwriting Database Values](../../../../../../docs/framework/data/adonet/sql/linq/how-to-resolve-conflicts-by-overwriting-database-values.md), and [How to: Resolve Conflicts by Merging with Database Values](../../../../../../docs/framework/data/adonet/sql/linq/how-to-resolve-conflicts-by-merging-with-database-values.md).</span></span>  
  
## <a name="linq-to-sql-types-that-support-conflict-discovery-and-resolution"></a><span data-ttu-id="b6dbc-169">Types LINQ to SQL qui prennent en charge la découverte et la résolution de conflits</span><span class="sxs-lookup"><span data-stu-id="b6dbc-169">LINQ to SQL Types That Support Conflict Discovery and Resolution</span></span>  
 <span data-ttu-id="b6dbc-170">Les classes et les fonctionnalités pour prendre en charge la résolution de conflits dans l’accès concurrentiel optimiste dans [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] incluent les éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="b6dbc-170">Classes and features to support the resolution of conflicts in optimistic concurrency in [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] include the following:</span></span>  
  
-   <xref:System.Data.Linq.ObjectChangeConflict?displayProperty=nameWithType>  
  
-   <xref:System.Data.Linq.MemberChangeConflict?displayProperty=nameWithType>  
  
-   <xref:System.Data.Linq.ChangeConflictCollection?displayProperty=nameWithType>  
  
-   <xref:System.Data.Linq.ChangeConflictException?displayProperty=nameWithType>  
  
-   <xref:System.Data.Linq.DataContext.ChangeConflicts%2A?displayProperty=nameWithType>  
  
-   <xref:System.Data.Linq.DataContext.SubmitChanges%2A?displayProperty=nameWithType>  
  
-   <xref:System.Data.Linq.DataContext.Refresh%2A?displayProperty=nameWithType>  
  
-   <xref:System.Data.Linq.Mapping.ColumnAttribute.UpdateCheck%2A?displayProperty=nameWithType>  
  
-   <xref:System.Data.Linq.Mapping.UpdateCheck?displayProperty=nameWithType>  
  
-   <xref:System.Data.Linq.RefreshMode?displayProperty=nameWithType>  
  
## <a name="see-also"></a><span data-ttu-id="b6dbc-171">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="b6dbc-171">See also</span></span>

- [<span data-ttu-id="b6dbc-172">Procédure : Gérer les conflits de changement</span><span class="sxs-lookup"><span data-stu-id="b6dbc-172">How to: Manage Change Conflicts</span></span>](../../../../../../docs/framework/data/adonet/sql/linq/how-to-manage-change-conflicts.md)
