---
title: 'Procédure : Stocker et réutiliser des requêtes'
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: a012bd79-1809-45e3-adea-0229532396cc
ms.openlocfilehash: 1aac20c3f9c421d353938a83b9e321d35abd244e
ms.sourcegitcommit: 5b6d778ebb269ee6684fb57ad69a8c28b06235b9
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/08/2019
ms.locfileid: "59084191"
---
# <a name="how-to-store-and-reuse-queries"></a><span data-ttu-id="99faa-102">Procédure : Stocker et réutiliser des requêtes</span><span class="sxs-lookup"><span data-stu-id="99faa-102">How to: Store and Reuse Queries</span></span>
<span data-ttu-id="99faa-103">Lorsque vous possédez une application qui exécute de nombreuses fois des requêtes similaires d'un point de vue structurel, vous pouvez souvent améliorer les performances en compilant la requête une fois et en l'exécutant plusieurs fois avec des paramètres différents.</span><span class="sxs-lookup"><span data-stu-id="99faa-103">When you have an application that executes structurally similar queries many times, you can often increase performance by compiling the query one time and executing it several times with different parameters.</span></span> <span data-ttu-id="99faa-104">Par exemple, une application peut avoir besoin de récupérer tous les clients d'une ville spécifique, où la ville est spécifiée à l'exécution par l'utilisateur dans un formulaire.</span><span class="sxs-lookup"><span data-stu-id="99faa-104">For example, an application might have to retrieve all the customers who are in a particular city, where the city is specified at runtime by the user in a form.</span></span> [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] <span data-ttu-id="99faa-105">prend en charge l’utilisation de *requêtes compilées* à cet effet.</span><span class="sxs-lookup"><span data-stu-id="99faa-105">supports the use of *compiled queries* for this purpose.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="99faa-106">Ce modèle d’utilisation représente l’utilisation la plus courante pour les requêtes compilées.</span><span class="sxs-lookup"><span data-stu-id="99faa-106">This pattern of usage represents the most common use for compiled queries.</span></span> <span data-ttu-id="99faa-107">D'autres approches sont possibles.</span><span class="sxs-lookup"><span data-stu-id="99faa-107">Other approaches are possible.</span></span> <span data-ttu-id="99faa-108">Par exemple, les requêtes compilées peuvent être stockées comme des membres statiques sur une classe partielle qui étend le code généré par le concepteur.</span><span class="sxs-lookup"><span data-stu-id="99faa-108">For example, compiled queries can be stored as static members on a partial class that extends the code generated by the designer.</span></span>  
  
## <a name="example"></a><span data-ttu-id="99faa-109">Exemple</span><span class="sxs-lookup"><span data-stu-id="99faa-109">Example</span></span>  
 <span data-ttu-id="99faa-110">Dans de nombreux scénarios, vous pouvez avoir besoin de réutiliser des requêtes au-delà des limites de thread.</span><span class="sxs-lookup"><span data-stu-id="99faa-110">In many scenarios you might want to reuse the queries across thread boundaries.</span></span> <span data-ttu-id="99faa-111">Dans ce type de situations, le stockage des requêtes compilées dans des variables statiques est particulièrement efficace.</span><span class="sxs-lookup"><span data-stu-id="99faa-111">In such cases, storing the compiled queries in static variables is especially effective.</span></span> <span data-ttu-id="99faa-112">L'exemple de code suivant suppose l'existence d'une classe `Queries` conçue pour stocker des requêtes compilées et d'une classe Northwind qui représente un <xref:System.Data.Linq.DataContext> fortement typé.</span><span class="sxs-lookup"><span data-stu-id="99faa-112">The following code example assumes a `Queries` class designed to store compiled queries, and assumes a Northwind class that represents a strongly typed <xref:System.Data.Linq.DataContext>.</span></span>  
  
 [!code-csharp[DLinqQuerying#6](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqQuerying/cs/Program.cs#6)]
 [!code-vb[DLinqQuerying#6](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqQuerying/vb/Module1.vb#6)]  
  
 [!code-csharp[DLinqQuerying#7](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqQuerying/cs/Program.cs#7)]
 [!code-vb[DLinqQuerying#7](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqQuerying/vb/Module1.vb#7)]  
  
## <a name="example"></a><span data-ttu-id="99faa-113">Exemple</span><span class="sxs-lookup"><span data-stu-id="99faa-113">Example</span></span>  
 <span data-ttu-id="99faa-114">Vous ne pouvez pas actuellement store (dans des variables statiques) des requêtes qui retournent un *type anonyme*, car le type n’a aucun nom à utiliser comme un argument générique.</span><span class="sxs-lookup"><span data-stu-id="99faa-114">You cannot currently store (in static variables) queries that return an *anonymous type*, because type has no name to provide as a generic argument.</span></span> <span data-ttu-id="99faa-115">L’exemple suivant montre comment vous pouvez contourner le problème en créant un type qui peut représenter le résultat et en l’utilisant comme argument générique.</span><span class="sxs-lookup"><span data-stu-id="99faa-115">The following example shows how you can work around the issue by creating a type that can represent the result, and then use it as a generic argument.</span></span>  
  
 [!code-csharp[DLinqQuerying#8](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqQuerying/cs/Program.cs#8)]
 [!code-vb[DLinqQuerying#8](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqQuerying/vb/Module1.vb#8)]  
  
## <a name="see-also"></a><span data-ttu-id="99faa-116">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="99faa-116">See also</span></span>

- <xref:System.Data.Linq.CompiledQuery>
- [<span data-ttu-id="99faa-117">Concepts relatifs aux requêtes</span><span class="sxs-lookup"><span data-stu-id="99faa-117">Query Concepts</span></span>](../../../../../../docs/framework/data/adonet/sql/linq/query-concepts.md)
- [<span data-ttu-id="99faa-118">Interrogation de la base de données</span><span class="sxs-lookup"><span data-stu-id="99faa-118">Querying the Database</span></span>](../../../../../../docs/framework/data/adonet/sql/linq/querying-the-database.md)
