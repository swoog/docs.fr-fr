---
title: Sécurité d'accès du code et ADO.NET
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: 93e099eb-daa1-4f1e-b031-c1e10a996f88
ms.openlocfilehash: 5712b0f7ef67e0a925207858e17d256dbf50cc60
ms.sourcegitcommit: 3500c4845f96a91a438a02ef2c6b4eef45a5e2af
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 02/07/2019
ms.locfileid: "55826258"
---
# <a name="code-access-security-and-adonet"></a><span data-ttu-id="3a70a-102">Sécurité d'accès du code et ADO.NET</span><span class="sxs-lookup"><span data-stu-id="3a70a-102">Code Access Security and ADO.NET</span></span>
<span data-ttu-id="3a70a-103">Le .NET Framework offre une sécurité basée sur les rôles ainsi qu'une sécurité d'accès du code (CAS, Code Access Security) implémentées à l'aide d'une infrastructure commune fournie par le Common Language Runtime (CLR).</span><span class="sxs-lookup"><span data-stu-id="3a70a-103">The .NET Framework offers role-based security as well as code access security (CAS), both of which are implemented using a common infrastructure supplied by the common language runtime (CLR).</span></span> <span data-ttu-id="3a70a-104">Dans l'univers du code non managé, la plupart des applications s'exécutent avec les autorisations de l'utilisateur ou d'une principal de sécurité.</span><span class="sxs-lookup"><span data-stu-id="3a70a-104">In the world of unmanaged code, most applications execute with the permissions of the user or principal.</span></span> <span data-ttu-id="3a70a-105">C'est pourquoi les systèmes informatiques peuvent être endommagés et des données privées compromises lorsqu'un utilisateur bénéficiant de privilèges élevés exécute des logiciels malveillants ou remplis d'erreurs.</span><span class="sxs-lookup"><span data-stu-id="3a70a-105">As a result, computer systems can be damaged and private data compromised when malicious or error-filled software is run by a user with elevated privileges.</span></span>  
  
 <span data-ttu-id="3a70a-106">En revanche, le code managé exécuté dans le .NET Framework inclut une sécurité d'accès du code qui s'applique au code seul.</span><span class="sxs-lookup"><span data-stu-id="3a70a-106">By contrast, managed code executing in the .NET Framework includes code access security, which applies to code alone.</span></span> <span data-ttu-id="3a70a-107">L'autorisation ou l'interdiction pour le code de s'exécuter dépend de son origine et d'autres aspects de son identité, et pas seulement de l'identité de la principal de sécurité.</span><span class="sxs-lookup"><span data-stu-id="3a70a-107">Whether the code is allowed to run or not depends on the code's origin or other aspects of the code's identity, not solely the identity of the principal.</span></span> <span data-ttu-id="3a70a-108">Cela réduit la probabilité que du code managé puisse être utilisé de façon abusive.</span><span class="sxs-lookup"><span data-stu-id="3a70a-108">This reduces the likelihood that managed code can be misused.</span></span>  
  
## <a name="code-access-permissions"></a><span data-ttu-id="3a70a-109">Autorisations d'accès du code</span><span class="sxs-lookup"><span data-stu-id="3a70a-109">Code Access Permissions</span></span>  
 <span data-ttu-id="3a70a-110">Lors de l'exécution du code, ce dernier présente une preuve qui est évaluée par le système de sécurité CLR.</span><span class="sxs-lookup"><span data-stu-id="3a70a-110">When code is executed, it presents evidence that is evaluated by the CLR security system.</span></span> <span data-ttu-id="3a70a-111">Généralement, cette preuve comprend l'origine du code, notamment l'URL, le site, la zone et les signatures numériques qui garantissent l'identité de l'assembly.</span><span class="sxs-lookup"><span data-stu-id="3a70a-111">Typically, this evidence comprises the origin of the code including URL, site, and zone, and digital signatures that ensure the identity of the assembly.</span></span>  
  
 <span data-ttu-id="3a70a-112">Le CLR permet au code d'effectuer uniquement les opérations pour lesquelles il dispose d'une autorisation.</span><span class="sxs-lookup"><span data-stu-id="3a70a-112">The CLR allows code to perform only those operations that the code has permission to perform.</span></span> <span data-ttu-id="3a70a-113">Le code peut demander des autorisations qui lui sont accordées en fonction de la stratégie de sécurité définie par un administrateur.</span><span class="sxs-lookup"><span data-stu-id="3a70a-113">Code can request permissions, and those requests are honored based on the security policy set by an administrator.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="3a70a-114">Le code s'exécutant dans le CLR ne peut pas s'octroyer d'autorisations à lui-même.</span><span class="sxs-lookup"><span data-stu-id="3a70a-114">Code executing in the CLR cannot grant permissions to itself.</span></span> <span data-ttu-id="3a70a-115">Par exemple, un code peut demander et obtenir moins d'autorisations qu'une stratégie de sécurité le prévoit, mais il ne pourra jamais en obtenir plus.</span><span class="sxs-lookup"><span data-stu-id="3a70a-115">For example, code can request and be granted fewer permissions than a security policy allows, but it will never be granted more permissions.</span></span> <span data-ttu-id="3a70a-116">Lors de l'octroi d'autorisations, démarrez sans autorisation, puis ajoutez les autorisations les plus restrictives pour la tâche en cours d'exécution.</span><span class="sxs-lookup"><span data-stu-id="3a70a-116">When granting permissions, start with no permissions at all and then add the narrowest permissions for the particular task being performed.</span></span> <span data-ttu-id="3a70a-117">Démarrer avec toutes les autorisations puis en refuser individuellement génère des applications non sécurisées susceptibles de contenir des failles de sécurité involontaires dues à l'octroi de davantage d'autorisations que nécessaire.</span><span class="sxs-lookup"><span data-stu-id="3a70a-117">Starting with all permissions and then denying individual ones leads to insecure applications that may contain unintentional security holes from granting more permissions than required.</span></span> <span data-ttu-id="3a70a-118">Pour plus d’informations, consultez [configuration de la stratégie de sécurité](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/7c9c2y1w(v=vs.100)) et [gestion des stratégies de sécurité](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/c1k0eed6(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="3a70a-118">For more information, see [Configuring Security Policy](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/7c9c2y1w(v=vs.100)) and [Security Policy Management](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/c1k0eed6(v=vs.100)).</span></span>  
  
 <span data-ttu-id="3a70a-119">Il existe trois types d'autorisations d'accès du code :</span><span class="sxs-lookup"><span data-stu-id="3a70a-119">There are three types of code access permissions:</span></span>  
  
-   <span data-ttu-id="3a70a-120">Les `Code access permissions` sont dérivées de la classe <xref:System.Security.CodeAccessPermission>.</span><span class="sxs-lookup"><span data-stu-id="3a70a-120">`Code access permissions` derive from the <xref:System.Security.CodeAccessPermission> class.</span></span> <span data-ttu-id="3a70a-121">Des autorisations sont requises pour accéder à des ressources protégées, telles que des fichiers et des variables d'environnement, ainsi que pour effectuer des opérations protégées, telles que l'accès à du code non managé.</span><span class="sxs-lookup"><span data-stu-id="3a70a-121">Permissions are required in order to access protected resources, such as files and environment variables, and to perform protected operations, such as accessing unmanaged code.</span></span>  
  
-   <span data-ttu-id="3a70a-122">Les `Identity permissions` représentent les caractéristiques qui identifient un assembly.</span><span class="sxs-lookup"><span data-stu-id="3a70a-122">`Identity permissions` represent characteristics that identify an assembly.</span></span> <span data-ttu-id="3a70a-123">Des autorisations sont octroyées à un assembly sur la base d'une preuve, qui peut consister en différents éléments, tels qu'une signature numérique ou la provenance du code.</span><span class="sxs-lookup"><span data-stu-id="3a70a-123">Permissions are granted to an assembly based on evidence, which can include items such as a digital signature or where the code originated.</span></span> <span data-ttu-id="3a70a-124">Les autorisations d'identité dérivent également de la classe de base <xref:System.Security.CodeAccessPermission>.</span><span class="sxs-lookup"><span data-stu-id="3a70a-124">Identity permissions also derive from the <xref:System.Security.CodeAccessPermission> base class.</span></span>  
  
-   <span data-ttu-id="3a70a-125">Les `Role-based security permissions` sont basées sur le fait qu'une principal de sécurité possède une identité spécifiée ou soit membre d'un rôle particulier.</span><span class="sxs-lookup"><span data-stu-id="3a70a-125">`Role-based security permissions` are based on whether a principal has a specified identity or is a member of a specified role.</span></span> <span data-ttu-id="3a70a-126">La classe <xref:System.Security.Permissions.PrincipalPermission> permet de procéder à des vérifications d'autorisations déclaratives et impératives par rapport à la principal de sécurité active.</span><span class="sxs-lookup"><span data-stu-id="3a70a-126">The <xref:System.Security.Permissions.PrincipalPermission> class allows both declarative and imperative permission checks against the active principal.</span></span>  
  
 <span data-ttu-id="3a70a-127">Pour déterminer si le code est autorisé à accéder à une ressources ou effectuer une opération, le système de sécurité du runtime parcourt la pile des appels, en comparant les autorisations de chaque appelant à l'autorisation faisant l'objet d'une demande.</span><span class="sxs-lookup"><span data-stu-id="3a70a-127">To determine whether code is authorized to access a resource or perform an operation, the runtime's security system traverses the call stack, comparing the granted permissions of each caller to the permission being demanded.</span></span> <span data-ttu-id="3a70a-128">Si un appelant dans la pile des appels ne possède pas l'autorisation demandée, une exception <xref:System.Security.SecurityException> est levée et l'accès est refusé.</span><span class="sxs-lookup"><span data-stu-id="3a70a-128">If any caller in the call stack does not have the demanded permission, a <xref:System.Security.SecurityException> is thrown and access is refused.</span></span>  
  
### <a name="requesting-permissions"></a><span data-ttu-id="3a70a-129">Demande d'autorisations</span><span class="sxs-lookup"><span data-stu-id="3a70a-129">Requesting Permissions</span></span>  
 <span data-ttu-id="3a70a-130">Les demandes d'autorisations ont pour but d'indiquer au runtime les autorisations dont votre application a besoin pour s'exécuter et de garantir que seules les autorisations requises lui sont octroyées.</span><span class="sxs-lookup"><span data-stu-id="3a70a-130">The purpose of requesting permissions is to inform the runtime which permissions your application requires in order to run, and to ensure that it receives only the permissions that it actually needs.</span></span> <span data-ttu-id="3a70a-131">Par exemple, si votre application doit écrire des données sur le disque local, elle nécessite <xref:System.Security.Permissions.FileIOPermission>.</span><span class="sxs-lookup"><span data-stu-id="3a70a-131">For example, if your application needs to write data to the local disk, it requires <xref:System.Security.Permissions.FileIOPermission>.</span></span> <span data-ttu-id="3a70a-132">Si cette autorisation n'a pas été accordée, l'application échoue lorsqu'elle tente d'écrire sur le disque.</span><span class="sxs-lookup"><span data-stu-id="3a70a-132">If that permission hasn't been granted, the application will fail when it attempts to write to the disk.</span></span> <span data-ttu-id="3a70a-133">Cependant, si l'application demande `FileIOPermission` et que cette autorisation lui a été refusée, l'application génère l'exception dès le départ et ne se charge pas.</span><span class="sxs-lookup"><span data-stu-id="3a70a-133">However, if the application requests `FileIOPermission` and that permission has not been granted, the application will generate the exception at the outset and will not load.</span></span>  
  
 <span data-ttu-id="3a70a-134">Dans un scénario dans lequel l'application a seulement besoin de lire des données du disque, vous pouvez demander à ce qu'aucune autorisation d'accès en écriture ne lui soit jamais octroyée.</span><span class="sxs-lookup"><span data-stu-id="3a70a-134">In a scenario where the application only needs to read data from the disk, you can request that it never be granted any write permissions.</span></span> <span data-ttu-id="3a70a-135">En cas de bogue ou d'attaque malveillante, votre code ne peut pas altérer les données sur lesquelles il opère.</span><span class="sxs-lookup"><span data-stu-id="3a70a-135">In the event of a bug or a malicious attack, your code cannot damage the data on which it operates.</span></span> <span data-ttu-id="3a70a-136">Pour plus d’informations, consultez [demande d’autorisations](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/yd267cce(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="3a70a-136">For more information, see [Requesting Permissions](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/yd267cce(v=vs.100)).</span></span>  
  
## <a name="role-based-security-and-cas"></a><span data-ttu-id="3a70a-137">Sécurité basée sur les rôles et sécurité d'accès du code (CAS)</span><span class="sxs-lookup"><span data-stu-id="3a70a-137">Role-Based Security and CAS</span></span>  
 <span data-ttu-id="3a70a-138">L'implémentation de la sécurité basée sur les rôles et de la sécurité d'accès du code (CAS) améliore la sécurité globale de votre application.</span><span class="sxs-lookup"><span data-stu-id="3a70a-138">Implementing both role-based security and code-accessed security (CAS) enhances overall security for your application.</span></span> <span data-ttu-id="3a70a-139">La sécurité basée sur les rôles peut utiliser un compte Windows ou une identité personnalisée, en mettant à la disposition du thread actuel des informations sur la principal de sécurité.</span><span class="sxs-lookup"><span data-stu-id="3a70a-139">Role-based security can be based on a Windows account or a custom identity, making information about the security principal available to the current thread.</span></span> <span data-ttu-id="3a70a-140">Par ailleurs, les applications doivent souvent accorder l'accès aux données et aux ressources en fonction des informations d'identification fournies par l'utilisateur.</span><span class="sxs-lookup"><span data-stu-id="3a70a-140">In addition, applications are often required to provide access to data or resources based on credentials supplied by the user.</span></span> <span data-ttu-id="3a70a-141">Généralement, ces applications vérifient le rôle de l'utilisateur afin de lui donner accès aux ressources correspondant à ce rôle.</span><span class="sxs-lookup"><span data-stu-id="3a70a-141">Typically, such applications check the role of a user and provide access to resources based on those roles.</span></span>  
  
 <span data-ttu-id="3a70a-142">La sécurité basée sur les rôles permet à un composant d'identifier les utilisateurs actuels et leurs rôles associés au moment de l'exécution.</span><span class="sxs-lookup"><span data-stu-id="3a70a-142">Role-based security enables a component to identify current users and their associated roles at run time.</span></span> <span data-ttu-id="3a70a-143">Ces informations sont ensuite mappées à l'aide d'une stratégie de sécurité d'accès du code pour déterminer le jeu d'autorisations octroyées au moment de l'exécution.</span><span class="sxs-lookup"><span data-stu-id="3a70a-143">This information is then mapped using a CAS policy to determine the set of permissions granted at run time.</span></span> <span data-ttu-id="3a70a-144">Pour un domaine d'application spécifié, l'hôte peut modifier la stratégie de sécurité basée sur les rôles par défaut et définir une principal de sécurité par défaut qui représente un utilisateur et les rôles qui lui sont associés.</span><span class="sxs-lookup"><span data-stu-id="3a70a-144">For a specified application domain, the host can change the default role-based security policy and set a default security principal that represents a user and the roles associated with that user.</span></span>  
  
 <span data-ttu-id="3a70a-145">Le CLR utilise des autorisations pour mettre en œuvre son mécanisme destiné à imposer des restrictions sur du code managé.</span><span class="sxs-lookup"><span data-stu-id="3a70a-145">The CLR uses permissions to implement its mechanism for enforcing restrictions on managed code.</span></span> <span data-ttu-id="3a70a-146">Les autorisations de sécurité basées sur les rôles fournissent un mécanisme permettant de savoir si un utilisateur (ou l'agent qui agit en son nom) possède une identité particulière ou est membre d'un rôle spécifié.</span><span class="sxs-lookup"><span data-stu-id="3a70a-146">Role-based security permissions provide a mechanism for discovering whether a user (or the agent acting on the user's behalf) has a particular identity or is a member of a specified role.</span></span> <span data-ttu-id="3a70a-147">Pour plus d’informations, consultez [autorisations de sécurité](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/5ba4k1c5(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="3a70a-147">For more information, see [Security Permissions](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/5ba4k1c5(v=vs.100)).</span></span>  
  
 <span data-ttu-id="3a70a-148">En fonction du type d'application en cours de construction, vous devez également envisager d'implémenter des autorisations basées sur les rôles dans la base de données.</span><span class="sxs-lookup"><span data-stu-id="3a70a-148">Depending on the type of application you are building, you should also consider implementing role-based permissions in the database.</span></span> <span data-ttu-id="3a70a-149">Pour plus d’informations sur la sécurité des rôles dans SQL Server, consultez [sécurité de SQL Server](../../../../docs/framework/data/adonet/sql/sql-server-security.md).</span><span class="sxs-lookup"><span data-stu-id="3a70a-149">For more information on role-based security in SQL Server, see [SQL Server Security](../../../../docs/framework/data/adonet/sql/sql-server-security.md).</span></span>  
  
## <a name="assemblies"></a><span data-ttu-id="3a70a-150">Assemblys</span><span class="sxs-lookup"><span data-stu-id="3a70a-150">Assemblies</span></span>  
 <span data-ttu-id="3a70a-151">Les assemblys constituent l'unité fondamentale dans le déploiement, le contrôle de version, la portée d'activation et les autorisations de sécurité d'une application .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="3a70a-151">Assemblies form the fundamental unit of deployment, version control, reuse, activation scoping, and security permissions for a .NET Framework application.</span></span> <span data-ttu-id="3a70a-152">Ils fournissent une collection de types et de ressources qui sont générés pour fonctionner ensemble et former une unité logique de fonctionnalités.</span><span class="sxs-lookup"><span data-stu-id="3a70a-152">An assembly provides a collection of types and resources that are built to work together and form a logical unit of functionality.</span></span> <span data-ttu-id="3a70a-153">Pour le CLR, un type n'existe pas en dehors du contexte d'un assembly.</span><span class="sxs-lookup"><span data-stu-id="3a70a-153">To the CLR, a type does not exist outside the context of an assembly.</span></span> <span data-ttu-id="3a70a-154">Pour plus d’informations sur la création et déploiement d’assemblys, consultez [programmation avec des assemblys](../../../../docs/framework/app-domains/programming-with-assemblies.md).</span><span class="sxs-lookup"><span data-stu-id="3a70a-154">For more information on creating and deploying assemblies, see [Programming with Assemblies](../../../../docs/framework/app-domains/programming-with-assemblies.md).</span></span>  
  
### <a name="strong-naming-assemblies"></a><span data-ttu-id="3a70a-155">Attribution d'un nom fort à des assemblys</span><span class="sxs-lookup"><span data-stu-id="3a70a-155">Strong-naming Assemblies</span></span>  
 <span data-ttu-id="3a70a-156">Un nom fort, ou signature numérique, est constitué de l'identité de l'assembly (son simple nom textuel, son numéro de version et des informations de culture, le cas échéant) ainsi que d'une clé publique et d'une signature numérique.</span><span class="sxs-lookup"><span data-stu-id="3a70a-156">A strong name, or digital signature, consists of the assembly's identity, which includes its simple text name, version number, and culture information (if provided), plus a public key and a digital signature.</span></span> <span data-ttu-id="3a70a-157">La signature numérique est générée à partir un fichier d'assembly à l'aide de la clé privée correspondante.</span><span class="sxs-lookup"><span data-stu-id="3a70a-157">The digital signature is generated from an assembly file using the corresponding private key.</span></span> <span data-ttu-id="3a70a-158">Le fichier d'assembly contient le manifeste d'assembly, qui à son tour comporte les noms et les hachages de tous les fichiers qui composent l'assembly.</span><span class="sxs-lookup"><span data-stu-id="3a70a-158">The assembly file contains the assembly manifest, which contains the names and hashes of all the files that make up the assembly.</span></span>  
  
 <span data-ttu-id="3a70a-159">L'attribution d'un nom fort à un assembly donne à une application ou un composant une identité unique que d'autres logiciels peuvent utiliser pour s'y référer explicitement.</span><span class="sxs-lookup"><span data-stu-id="3a70a-159">Strong naming an assembly gives an application or component a unique identity that other software can use to refer explicitly to it.</span></span> <span data-ttu-id="3a70a-160">L'attribution de noms forts aux assemblys les protège contre des falsifications par un assembly contenant un code hostile.</span><span class="sxs-lookup"><span data-stu-id="3a70a-160">Strong naming guards assemblies against being spoofed by an assembly that contains hostile code.</span></span> <span data-ttu-id="3a70a-161">Elle garantit également la cohérence du contrôle des versions d'un composant.</span><span class="sxs-lookup"><span data-stu-id="3a70a-161">Strong-naming also ensures versioning consistency among different versions of a component.</span></span> <span data-ttu-id="3a70a-162">Vous devez attribuer un nom fort aux assemblys qui seront déployés sur le cache GAC (Global Assembly Cache).</span><span class="sxs-lookup"><span data-stu-id="3a70a-162">You must strong name assemblies that will be deployed to the Global Assembly Cache (GAC).</span></span> <span data-ttu-id="3a70a-163">Pour plus d’informations, consultez [Création et utilisation d’assemblys avec nom fort](../../../../docs/framework/app-domains/create-and-use-strong-named-assemblies.md).</span><span class="sxs-lookup"><span data-stu-id="3a70a-163">For more information, see [Creating and Using Strong-Named Assemblies](../../../../docs/framework/app-domains/create-and-use-strong-named-assemblies.md).</span></span>  
  
## <a name="partial-trust-in-adonet-20"></a><span data-ttu-id="3a70a-164">Confiance partielle dans ADO.NET 2.0</span><span class="sxs-lookup"><span data-stu-id="3a70a-164">Partial Trust in ADO.NET 2.0</span></span>  
 <span data-ttu-id="3a70a-165">Dans ADO.NET 2.0, le fournisseur de données .NET Framework pour SQL Server , le fournisseur de données .NET Framework pour OLE DB, le fournisseur de données .NET Framework pour ODBC et le fournisseur de données .NET Framework pour Oracle peuvent tous s'exécuter dans des environnements bénéficiant d'une confiance partielle.</span><span class="sxs-lookup"><span data-stu-id="3a70a-165">In ADO.NET 2.0, the .NET Framework Data Provider for SQL Server, the .NET Framework Data Provider for OLE DB, the .NET Framework Data Provider for ODBC, and the .NET Framework Data Provider for Oracle can now all run in partially trusted environments.</span></span> <span data-ttu-id="3a70a-166">Dans les versions précédentes du .NET Framework, seul <xref:System.Data.SqlClient> était pris en charge dans des applications ne bénéficiant pas d'une confiance totale.</span><span class="sxs-lookup"><span data-stu-id="3a70a-166">In previous releases of the .NET Framework, only <xref:System.Data.SqlClient> was supported in less than full-trust applications.</span></span>  
  
 <span data-ttu-id="3a70a-167">Au minimum, une application avec confiance partielle utilisant le fournisseur SQL Server doit disposer d'autorisations d'exécution et de l'objet <xref:System.Data.SqlClient.SqlClientPermission>.</span><span class="sxs-lookup"><span data-stu-id="3a70a-167">At minimum, a partially trusted application using the SQL Server provider must have execution and <xref:System.Data.SqlClient.SqlClientPermission> permissions.</span></span>  
  
### <a name="permission-attribute-properties-for-partial-trust"></a><span data-ttu-id="3a70a-168">Propriétés d'attribut d'autorisation pour la confiance partielle</span><span class="sxs-lookup"><span data-stu-id="3a70a-168">Permission Attribute Properties for Partial Trust</span></span>  
 <span data-ttu-id="3a70a-169">Pour des scénarios de confiance partielle, vous pouvez utiliser des membres de l'objet <xref:System.Data.SqlClient.SqlClientPermissionAttribute> pour restreindre davantage les capacités disponibles pour le fournisseur de données .NET Framework pour SQL Server.</span><span class="sxs-lookup"><span data-stu-id="3a70a-169">For partial trust scenarios, you can use <xref:System.Data.SqlClient.SqlClientPermissionAttribute> members to further restrict the capabilities available for the .NET Framework Data Provider for SQL Server.</span></span>  
  
 <span data-ttu-id="3a70a-170">Le tableau suivant répertorie les propriétés de l'objet <xref:System.Data.SqlClient.SqlClientPermissionAttribute> disponibles et leurs descriptions :</span><span class="sxs-lookup"><span data-stu-id="3a70a-170">The following table lists the available <xref:System.Data.SqlClient.SqlClientPermissionAttribute> properties and their descriptions:</span></span>  
  
|<span data-ttu-id="3a70a-171">Propriété d'attribut d'autorisation</span><span class="sxs-lookup"><span data-stu-id="3a70a-171">Permission attribute property</span></span>|<span data-ttu-id="3a70a-172">Description</span><span class="sxs-lookup"><span data-stu-id="3a70a-172">Description</span></span>|  
|-----------------------------------|-----------------|  
|`Action`|<span data-ttu-id="3a70a-173">Obtient ou définit une action de sécurité.</span><span class="sxs-lookup"><span data-stu-id="3a70a-173">Gets or sets a security action.</span></span> <span data-ttu-id="3a70a-174">Hérité de l'objet <xref:System.Security.Permissions.SecurityAttribute>.</span><span class="sxs-lookup"><span data-stu-id="3a70a-174">Inherited from <xref:System.Security.Permissions.SecurityAttribute>.</span></span>|  
|`AllowBlankPassword`|<span data-ttu-id="3a70a-175">Active ou désactive l'utilisation d'un mot de passe vide dans une chaîne de connexion.</span><span class="sxs-lookup"><span data-stu-id="3a70a-175">Enables or disables the use of a blank password in a connection string.</span></span> <span data-ttu-id="3a70a-176">Les valeurs valides sont `true` (pour activer l'utilisation des mots de passe vides) et `false` (pour la désactiver).</span><span class="sxs-lookup"><span data-stu-id="3a70a-176">Valid values are `true` (to enable the use of blank passwords) and `false` (to disable the use of blank passwords).</span></span> <span data-ttu-id="3a70a-177">Hérité de l'objet <xref:System.Data.Common.DBDataPermissionAttribute>.</span><span class="sxs-lookup"><span data-stu-id="3a70a-177">Inherited from <xref:System.Data.Common.DBDataPermissionAttribute>.</span></span>|  
|`ConnectionString`|<span data-ttu-id="3a70a-178">Identifie une chaîne de connexion autorisée.</span><span class="sxs-lookup"><span data-stu-id="3a70a-178">Identifies a permitted connection string.</span></span> <span data-ttu-id="3a70a-179">Plusieurs chaînes de connexion peuvent être identifiées.</span><span class="sxs-lookup"><span data-stu-id="3a70a-179">Multiple connection strings can be identified.</span></span> <span data-ttu-id="3a70a-180">**Remarque :**  N'incluez pas d'ID utilisateur ni de mot de passe dans votre chaîne de connexion.</span><span class="sxs-lookup"><span data-stu-id="3a70a-180">**Note:**  Do not include a user ID or password in your connection string.</span></span> <span data-ttu-id="3a70a-181">Dans cette version, vous ne pouvez pas modifier les restrictions liées à la chaîne de connexion à l'aide de l'outil de configuration .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="3a70a-181">In this release, you cannot change connection string restrictions using the .NET Framework Configuration Tool.</span></span> <br /><br /> <span data-ttu-id="3a70a-182">Hérité de l'objet <xref:System.Data.Common.DBDataPermissionAttribute>.</span><span class="sxs-lookup"><span data-stu-id="3a70a-182">Inherited from <xref:System.Data.Common.DBDataPermissionAttribute>.</span></span>|  
|`KeyRestrictions`|<span data-ttu-id="3a70a-183">Identifie les paramètres de chaîne de connexion autorisés et non autorisés.</span><span class="sxs-lookup"><span data-stu-id="3a70a-183">Identifies connection string parameters that are allowed or disallowed.</span></span> <span data-ttu-id="3a70a-184">Paramètres de chaîne de connexion sont identifiés sous la forme  *\<nom de paramètre > =*.</span><span class="sxs-lookup"><span data-stu-id="3a70a-184">Connection string parameters are identified in the form *\<parameter name>=*.</span></span> <span data-ttu-id="3a70a-185">Il est possible de spécifier plusieurs paramètres, délimités par un point-virgule (;).</span><span class="sxs-lookup"><span data-stu-id="3a70a-185">Multiple parameters can be specified, delimited using a semicolon (;).</span></span> <span data-ttu-id="3a70a-186">**Remarque :**  Si aucun `KeyRestrictions` n'est spécifié et que la propriété `KeyRestrictionBehavior` a la valeur `AllowOnly` ou `PreventUsage`, aucun paramètre de chaîne de connexion supplémentaire n'est autorisé.</span><span class="sxs-lookup"><span data-stu-id="3a70a-186">**Note:**  If you do not specify `KeyRestrictions`, but you set `KeyRestrictionBehavior` property to `AllowOnly` or `PreventUsage`, no additional connection string parameters are allowed.</span></span> <span data-ttu-id="3a70a-187">Hérité de l'objet <xref:System.Data.Common.DBDataPermissionAttribute>.</span><span class="sxs-lookup"><span data-stu-id="3a70a-187">Inherited from <xref:System.Data.Common.DBDataPermissionAttribute>.</span></span>|  
|`KeyRestrictionBehavior`|<span data-ttu-id="3a70a-188">Identifie les paramètres de chaîne de connexion comme étant les seuls paramètres supplémentaires autorisés (`AllowOnly`) ou identifie les paramètres supplémentaires qui ne sont pas autorisés (`PreventUsage`).</span><span class="sxs-lookup"><span data-stu-id="3a70a-188">Identifies the connection string parameters as the only additional parameters allowed (`AllowOnly`), or identifies the additional parameters that are not allowed (`PreventUsage`).</span></span> <span data-ttu-id="3a70a-189">`AllowOnly` est la valeur par défaut.</span><span class="sxs-lookup"><span data-stu-id="3a70a-189">`AllowOnly` is the default.</span></span> <span data-ttu-id="3a70a-190">Hérité de l'objet <xref:System.Data.Common.DBDataPermissionAttribute>.</span><span class="sxs-lookup"><span data-stu-id="3a70a-190">Inherited from <xref:System.Data.Common.DBDataPermissionAttribute>.</span></span>|  
|`TypeID`|<span data-ttu-id="3a70a-191">Obtient un identificateur unique pour cet attribut lors de l'implémentation dans une classe dérivée.</span><span class="sxs-lookup"><span data-stu-id="3a70a-191">Gets a unique identifier for this attribute when implemented in a derived class.</span></span> <span data-ttu-id="3a70a-192">Hérité de l'objet <xref:System.Attribute>.</span><span class="sxs-lookup"><span data-stu-id="3a70a-192">Inherited from <xref:System.Attribute>.</span></span>|  
|`Unrestricted`|<span data-ttu-id="3a70a-193">Indique si une autorisation illimitée à la ressource est déclarée.</span><span class="sxs-lookup"><span data-stu-id="3a70a-193">Indicates whether unrestricted permission to the resource is declared.</span></span> <span data-ttu-id="3a70a-194">Hérité de l'objet <xref:System.Security.Permissions.SecurityAttribute>.</span><span class="sxs-lookup"><span data-stu-id="3a70a-194">Inherited from <xref:System.Security.Permissions.SecurityAttribute>.</span></span>|  
  
#### <a name="connectionstring-syntax"></a><span data-ttu-id="3a70a-195">Syntaxe de ConnectionString</span><span class="sxs-lookup"><span data-stu-id="3a70a-195">ConnectionString Syntax</span></span>  
 <span data-ttu-id="3a70a-196">L'exemple suivant illustre l'utilisation de l'élément `connectionStrings` d'un fichier de configuration pour n'autoriser l'utilisation que d'une seule chaîne de connexion spécifique.</span><span class="sxs-lookup"><span data-stu-id="3a70a-196">The following example demonstrates how to use the `connectionStrings` element of a configuration file to allow only a specific connection string to be used.</span></span> <span data-ttu-id="3a70a-197">Consultez [chaînes de connexion](../../../../docs/framework/data/adonet/connection-strings.md) pour plus d’informations sur le stockage et extraction de chaînes de connexion à partir des fichiers de configuration.</span><span class="sxs-lookup"><span data-stu-id="3a70a-197">See [Connection Strings](../../../../docs/framework/data/adonet/connection-strings.md) for more information on storing and retrieving connection strings from configuration files.</span></span>  
  
```xml  
<connectionStrings>  
  <add name="DatabaseConnection"   
    connectionString="Data Source=(local);Initial   
    Catalog=Northwind;Integrated Security=true;" />  
</connectionStrings>  
```  
  
#### <a name="keyrestrictions-syntax"></a><span data-ttu-id="3a70a-198">Syntaxe de KeyRestrictions</span><span class="sxs-lookup"><span data-stu-id="3a70a-198">KeyRestrictions Syntax</span></span>  
 <span data-ttu-id="3a70a-199">L’exemple suivant active la même chaîne de connexion, permet d’utiliser le `Encrypt` et `Packet Size` options de chaîne de connexion, mais restreint l’utilisation de toute autre option de chaîne de connexion.</span><span class="sxs-lookup"><span data-stu-id="3a70a-199">The following example enables the same connection string, enables the use of the `Encrypt` and `Packet Size` connection string options, but restricts the use of any other connection string options.</span></span>  
  
```xml  
<connectionStrings>  
  <add name="DatabaseConnection"   
    connectionString="Data Source=(local);Initial   
    Catalog=Northwind;Integrated Security=true;"  
    KeyRestrictions="Encrypt=;Packet Size=;"  
    KeyRestrictionBehavior="AllowOnly" />  
</connectionStrings>  
```  
  
#### <a name="keyrestrictionbehavior-with-preventusage-syntax"></a><span data-ttu-id="3a70a-200">KeyRestrictionBehavior avec la syntaxe de PreventUsage</span><span class="sxs-lookup"><span data-stu-id="3a70a-200">KeyRestrictionBehavior with PreventUsage Syntax</span></span>  
 <span data-ttu-id="3a70a-201">L'exemple suivant active la même chaîne de connexion et autorise tous les autres paramètres de connexion à l'exception de `User Id`, `Password` et `Persist Security Info`.</span><span class="sxs-lookup"><span data-stu-id="3a70a-201">The following example enables the same connection string and allows all other connection parameters except for `User Id`, `Password` and `Persist Security Info`.</span></span>  
  
```xml  
<connectionStrings>  
  <add name="DatabaseConnection"   
    connectionString="Data Source=(local);Initial   
    Catalog=Northwind;Integrated Security=true;"  
    KeyRestrictions="User Id=;Password=;Persist Security Info=;"  
    KeyRestrictionBehavior="PreventUsage" />  
</connectionStrings>  
```  
  
#### <a name="keyrestrictionbehavior-with-allowonly-syntax"></a><span data-ttu-id="3a70a-202">KeyRestrictionBehavior avec la syntaxe de AllowOnly</span><span class="sxs-lookup"><span data-stu-id="3a70a-202">KeyRestrictionBehavior with AllowOnly Syntax</span></span>  
 <span data-ttu-id="3a70a-203">L'exemple suivant active deux chaînes de connexion qui contiennent également des paramètres `Initial Catalog`, `Connection Timeout`, `Encrypt` et `Packet Size`.</span><span class="sxs-lookup"><span data-stu-id="3a70a-203">The following example enables two connection strings that also contain `Initial Catalog`, `Connection Timeout`, `Encrypt`, and `Packet Size` parameters.</span></span> <span data-ttu-id="3a70a-204">L'utilisation de tous les autres paramètres de chaîne de connexion est restreinte.</span><span class="sxs-lookup"><span data-stu-id="3a70a-204">All other connection string parameters are restricted.</span></span>  
  
```xml  
<connectionStrings>  
  <add name="DatabaseConnection"   
    connectionString="Data Source=(local);Initial   
    Catalog=Northwind;Integrated Security=true;"  
    KeyRestrictions="Initial Catalog;Connection Timeout=;  
       Encrypt=;Packet Size=;"   
    KeyRestrictionBehavior="AllowOnly" />  
  
  <add name="DatabaseConnection2"   
    connectionString="Data Source=SqlServer2;Initial   
    Catalog=Northwind2;Integrated Security=true;"  
    KeyRestrictions="Initial Catalog;Connection Timeout=;  
       Encrypt=;Packet Size=;"   
    KeyRestrictionBehavior="AllowOnly" />  
</connectionStrings>  
```  
  
### <a name="enabling-partial-trust-with-a-custom-permission-set"></a><span data-ttu-id="3a70a-205">Activation de confiance partielle avec un jeu d'autorisations personnalisé</span><span class="sxs-lookup"><span data-stu-id="3a70a-205">Enabling Partial Trust with a Custom Permission Set</span></span>  
 <span data-ttu-id="3a70a-206">Pour activer l'utilisation d'autorisations <xref:System.Data.SqlClient> pour une zone particulière, un administrateur système doit créer un jeu d'autorisations personnalisé et le définir comme jeu d'autorisations pour une zone particulière.</span><span class="sxs-lookup"><span data-stu-id="3a70a-206">To enable the use of <xref:System.Data.SqlClient> permissions for a particular zone, a system administrator must create a custom permission set and set it as the permission set for a particular zone.</span></span> <span data-ttu-id="3a70a-207">Les jeux d'autorisations par défaut, tels que `LocalIntranet`, ne peuvent pas être modifiés.</span><span class="sxs-lookup"><span data-stu-id="3a70a-207">Default permission sets, such as `LocalIntranet`, cannot be modified.</span></span> <span data-ttu-id="3a70a-208">Par exemple, pour inclure <xref:System.Data.SqlClient> autorisations pour le code qui a un <xref:System.Security.Policy.Zone> de `LocalIntranet`, un administrateur système peut copier la jeu d’autorisations pour `LocalIntranet`, le renommer en « CustomLocalIntranet », ajoutez le <xref:System.Data.SqlClient> autorisations, importer le jeu à l’aide d’autorisations CustomLocalIntranet le [Caspol.exe (outil de stratégie de sécurité d’accès de Code)](../../../../docs/framework/tools/caspol-exe-code-access-security-policy-tool.md)et définissez le jeu d’autorisations de `LocalIntranet_Zone` à CustomLocalIntranet.</span><span class="sxs-lookup"><span data-stu-id="3a70a-208">For example, to include <xref:System.Data.SqlClient> permissions for code that has a <xref:System.Security.Policy.Zone> of `LocalIntranet`, a system administrator could copy the permission set for `LocalIntranet`, rename it to "CustomLocalIntranet", add the <xref:System.Data.SqlClient> permissions, import the CustomLocalIntranet permission set using the [Caspol.exe (Code Access Security Policy Tool)](../../../../docs/framework/tools/caspol-exe-code-access-security-policy-tool.md), and set the permission set of `LocalIntranet_Zone` to CustomLocalIntranet.</span></span>  
  
### <a name="sample-permission-set"></a><span data-ttu-id="3a70a-209">Exemple de jeu d'autorisations</span><span class="sxs-lookup"><span data-stu-id="3a70a-209">Sample Permission Set</span></span>  
 <span data-ttu-id="3a70a-210">Voici un exemple de jeu d'autorisations destiné au fournisseur de données .NET Framework pour SQL Serveur dans un scénario à confiance partielle.</span><span class="sxs-lookup"><span data-stu-id="3a70a-210">The following is a sample permission set for the .NET Framework Data Provider for SQL Server in a partially trusted scenario.</span></span> <span data-ttu-id="3a70a-211">Pour plus d’informations sur la création de jeux d’autorisations personnalisés, consultez [configuration autorisation définit à l’aide de Caspol.exe](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/4ybs46y6(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="3a70a-211">For information on creating custom permission sets, see [Configuring Permission Sets Using Caspol.exe](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/4ybs46y6(v=vs.100)).</span></span>  
  
```xml  
<PermissionSet class="System.Security.NamedPermissionSet"  
  version="1"  
  Name="CustomLocalIntranet"  
  Description="Custom permission set given to applications on  
    the local intranet">  
  
<IPermission class="System.Data.SqlClient.SqlClientPermission, System.Data, Version=2.0.0000.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"  
version="1"  
AllowBlankPassword="False">  
<add ConnectionString="Data Source=(local);Integrated Security=true;"  
 KeyRestrictions="Initial Catalog=;Connection Timeout=;  
   Encrypt=;Packet Size=;"   
 KeyRestrictionBehavior="AllowOnly" />  
 </IPermission>  
</PermissionSet>  
```  
  
## <a name="verifying-adonet-code-access-using-security-permissions"></a><span data-ttu-id="3a70a-212">Vérification de l'accès du code ADO.NET à l'aide des autorisations de sécurité</span><span class="sxs-lookup"><span data-stu-id="3a70a-212">Verifying ADO.NET Code Access Using Security Permissions</span></span>  
 <span data-ttu-id="3a70a-213">Dans les scénarios avec confiance partielle, vous pouvez exiger des privilèges de sécurité d'accès du code (CAS) pour des méthodes particulières dans votre code en spécifiant un objet <xref:System.Data.SqlClient.SqlClientPermissionAttribute>.</span><span class="sxs-lookup"><span data-stu-id="3a70a-213">For partial-trust scenarios, you can require CAS privileges for particular methods in your code by specifying a <xref:System.Data.SqlClient.SqlClientPermissionAttribute>.</span></span> <span data-ttu-id="3a70a-214">Si ce privilège n'est pas autorisé par la stratégie de sécurité limitée en vigueur, une exception est levée avant que votre code soit exécuté.</span><span class="sxs-lookup"><span data-stu-id="3a70a-214">If that privilege is not allowed by the restricted security policy in effect, an exception is thrown before your code is run.</span></span> <span data-ttu-id="3a70a-215">Pour plus d’informations sur la stratégie de sécurité, consultez [gestion des stratégies de sécurité](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/c1k0eed6(v=vs.100)) et [meilleures pratiques de sécurité stratégie](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/sa4se9bc(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="3a70a-215">For more information on security policy, see [Security Policy Management](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/c1k0eed6(v=vs.100)) and [Security Policy Best Practices](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/sa4se9bc(v=vs.100)).</span></span>  
  
### <a name="example"></a><span data-ttu-id="3a70a-216">Exemple</span><span class="sxs-lookup"><span data-stu-id="3a70a-216">Example</span></span>  
 <span data-ttu-id="3a70a-217">L'exemple suivant montre comment écrire un code requérant une chaîne de connexion particulière.</span><span class="sxs-lookup"><span data-stu-id="3a70a-217">The following example demonstrates how to write code that requires a particular connection string.</span></span> <span data-ttu-id="3a70a-218">Il simule le refus d'autorisations illimitées à <xref:System.Data.SqlClient>, qu'un administrateur système implémenterait à l'aide d'une stratégie de sécurité d'accès du code dans la réalité.</span><span class="sxs-lookup"><span data-stu-id="3a70a-218">It simulates denying unrestricted permissions to <xref:System.Data.SqlClient>, which a system administrator would implement using a CAS policy in the real world.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="3a70a-219">En cas d'utilisation d'autorisations de sécurité d'accès du code pour ADO.NET, le modèle correct consiste à commencer par le cas le plus restrictif (aucune autorisation) puis à ajouter les autorisations spécifiques nécessaires pour la tâche particulière que le code doit exécuter.</span><span class="sxs-lookup"><span data-stu-id="3a70a-219">When designing CAS permissions for ADO.NET, the correct pattern is to start with the most restrictive case (no permissions at all) and then add the specific permissions that are needed for the particular task that the code needs to perform.</span></span> <span data-ttu-id="3a70a-220">En revanche, commencer par toutes les autorisations, puis tenter de refuser une autorisation spécifique n'est pas une approche sûre car il existe de nombreuses manières d'exprimer la même chaîne de connexion.</span><span class="sxs-lookup"><span data-stu-id="3a70a-220">The opposite pattern, starting with all permissions and then denying a specific permission, is not secure because there are many ways of expressing the same connection string.</span></span> <span data-ttu-id="3a70a-221">Par exemple, si vous démarrez avec toutes les autorisations, puis refusez l'utilisation de la chaîne de connexion "server=someserver", vous pouvez continuer à utiliser "server=someserver.mycompany.com".</span><span class="sxs-lookup"><span data-stu-id="3a70a-221">For example, if you start with all permissions and then attempt to deny the use of the connection string "server=someserver", the string "server=someserver.mycompany.com" would still be allowed.</span></span> <span data-ttu-id="3a70a-222">En démarrant toujours en n'accordant aucune autorisation, vous limitez les risques de failles dans le jeu d'autorisations.</span><span class="sxs-lookup"><span data-stu-id="3a70a-222">By always starting by granting no permissions at all, you reduce the chances that there are holes in the permission set.</span></span>  
  
 <span data-ttu-id="3a70a-223">Le code suivant montre comment `SqlClient` exécute la demande de sécurité qui lève un objet <xref:System.Security.SecurityException> si les autorisations de sécurité d'accès du code (CAS) appropriées ne sont pas en place.</span><span class="sxs-lookup"><span data-stu-id="3a70a-223">The following code demonstrates how `SqlClient` performs the security demand, which throws a <xref:System.Security.SecurityException> if the appropriate CAS permissions are not in place.</span></span> <span data-ttu-id="3a70a-224">Le résultat de l'objet <xref:System.Security.SecurityException> s'affiche dans la fenêtre de console.</span><span class="sxs-lookup"><span data-stu-id="3a70a-224">The <xref:System.Security.SecurityException> output is displayed in the console window.</span></span>  
  
 [!code-csharp[DataWorks SqlClient.CAS#1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlClient.CAS/CS/source.cs#1)]
 [!code-vb[DataWorks SqlClient.CAS#1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlClient.CAS/VB/source.vb#1)]  
  
 <span data-ttu-id="3a70a-225">Vous devez voir ce résultat dans la fenêtre Console :</span><span class="sxs-lookup"><span data-stu-id="3a70a-225">You should see this output in the Console window:</span></span>  
  
```  
Failed, as expected: <IPermission class="System.Data.SqlClient.  
SqlClientPermission, System.Data, Version=2.0.0.0,   
  Culture=neutral, PublicKeyToken=b77a5c561934e089" version="1"  
  AllowBlankPassword="False">  
<add ConnectionString="Data Source=(local);Initial Catalog=  
  Northwind;Integrated Security=SSPI" KeyRestrictions=""  
KeyRestrictionBehavior="AllowOnly"/>  
</IPermission>  
  
Connection opened, as expected.  
Failed, as expected: Request failed.  
```  
  
## <a name="interoperability-with-unmanaged-code"></a><span data-ttu-id="3a70a-226">Interopérabilité avec du code non managé</span><span class="sxs-lookup"><span data-stu-id="3a70a-226">Interoperability with Unmanaged Code</span></span>  
 <span data-ttu-id="3a70a-227">Le code qui s'exécute en dehors du CLR est appelé code non managé.</span><span class="sxs-lookup"><span data-stu-id="3a70a-227">Code that runs outside the CLR is called unmanaged code.</span></span> <span data-ttu-id="3a70a-228">Par conséquent, les mécanismes de sécurité, tels que la sécurité d'accès du code, ne peuvent pas être appliqués à du code non managé.</span><span class="sxs-lookup"><span data-stu-id="3a70a-228">Therefore, security mechanisms such as CAS cannot be applied to unmanaged code.</span></span> <span data-ttu-id="3a70a-229">Les composants COM, les interfaces ActiveX et les fonctions API Win32 sont des exemples de code non managé.</span><span class="sxs-lookup"><span data-stu-id="3a70a-229">COM components, ActiveX interfaces, and Win32 API functions are examples of unmanaged code.</span></span> <span data-ttu-id="3a70a-230">Des considérations de sécurité particulières s'appliquent lors de l'exécution de code non managé pour éviter de compromettre la sécurité globale des applications.</span><span class="sxs-lookup"><span data-stu-id="3a70a-230">Special security considerations apply when executing unmanaged code so that you do not jeopardize overall application security.</span></span> <span data-ttu-id="3a70a-231">Pour plus d’informations, consultez [Interopération avec du code non managé](../../../../docs/framework/interop/index.md).</span><span class="sxs-lookup"><span data-stu-id="3a70a-231">For more information, see [Interoperating with Unmanaged Code](../../../../docs/framework/interop/index.md).</span></span>  
  
 <span data-ttu-id="3a70a-232">Le .NET Framework prend également en charge la compatibilité descendante avec des composants COM existants en offrant un accès via COM Interop.</span><span class="sxs-lookup"><span data-stu-id="3a70a-232">The .NET Framework also supports backward compatibility to existing COM components by providing access through COM interop.</span></span> <span data-ttu-id="3a70a-233">Vous pouvez incorporer des composants COM dans une application .NET Framework en utilisant des outils de COM Interop pour importer les types COM pertinents.</span><span class="sxs-lookup"><span data-stu-id="3a70a-233">You can incorporate COM components into a .NET Framework application by using COM interop tools to import the relevant COM types.</span></span> <span data-ttu-id="3a70a-234">Une fois importés, les types COM sont prêts à être utilisés.</span><span class="sxs-lookup"><span data-stu-id="3a70a-234">Once imported, the COM types are ready to use.</span></span> <span data-ttu-id="3a70a-235">COM Interop permet également aux clients COM d'accéder à du code managé en exportant des métadonnées d'assembly dans une bibliothèque de types et en inscrivant le composant managé en tant que composant COM.</span><span class="sxs-lookup"><span data-stu-id="3a70a-235">COM interop also enables COM clients to access managed code by exporting assembly metadata to a type library and registering the managed component as a COM component.</span></span> <span data-ttu-id="3a70a-236">Pour plus d’informations, consultez [interopérabilité COM avancée](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/bd9cdfyx).</span><span class="sxs-lookup"><span data-stu-id="3a70a-236">For more information, see [Advanced COM Interoperability](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/bd9cdfyx).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="3a70a-237">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="3a70a-237">See also</span></span>
- [<span data-ttu-id="3a70a-238">Sécurisation des applications ADO.NET</span><span class="sxs-lookup"><span data-stu-id="3a70a-238">Securing ADO.NET Applications</span></span>](../../../../docs/framework/data/adonet/securing-ado-net-applications.md)
- <span data-ttu-id="3a70a-239">[Sécurité dans le Code natif et .NET Framework](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2010/1787tk12(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="3a70a-239">[Security in Native and .NET Framework Code](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2010/1787tk12(v=vs.100))</span></span>
- [<span data-ttu-id="3a70a-240">Sécurité basée sur les rôles</span><span class="sxs-lookup"><span data-stu-id="3a70a-240">Role-Based Security</span></span>](../../../../docs/standard/security/role-based-security.md)
- [<span data-ttu-id="3a70a-241">Fournisseurs managés ADO.NET et centre de développement DataSet</span><span class="sxs-lookup"><span data-stu-id="3a70a-241">ADO.NET Managed Providers and DataSet Developer Center</span></span>](https://go.microsoft.com/fwlink/?LinkId=217917)
