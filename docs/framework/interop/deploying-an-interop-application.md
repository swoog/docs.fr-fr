---
title: Déploiement d'une application d'interopérabilité
ms.date: 03/30/2017
helpviewer_keywords:
- deploying applications [.NET Framework], interop
- strong-named assemblies, interop applications
- unsigned assemblies
- private assemblies
- exposing COM components to .NET Framework
- interoperation with unmanaged code, deploying applications
- shared assemblies
- COM interop, deploying applications
- interoperation with unmanaged code, exposing COM components
- signed assemblies
- COM interop, exposing COM components
ms.assetid: ea8a403e-ae03-4faa-9d9b-02179ec72992
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: d0efe9234bd61a45fa87e68cdbed1be69957d218
ms.sourcegitcommit: 58fc0e6564a37fa1b9b1b140a637e864c4cf696e
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/08/2019
ms.locfileid: "57675158"
---
# <a name="deploying-an-interop-application"></a><span data-ttu-id="ff228-102">Déploiement d'une application d'interopérabilité</span><span class="sxs-lookup"><span data-stu-id="ff228-102">Deploying an Interop Application</span></span>
<span data-ttu-id="ff228-103">Une application d’interopérabilité comporte généralement un assembly client .NET, un ou plusieurs assemblys d’interopérabilité représentant des bibliothèques de types COM distinctes, et un ou plusieurs composants COM inscrits.</span><span class="sxs-lookup"><span data-stu-id="ff228-103">An interop application typically includes a .NET client assembly, one or more interop assemblies representing distinct COM type libraries, and one or more registered COM components.</span></span> <span data-ttu-id="ff228-104">Visual Studio et le [!INCLUDE[winsdklong](../../../includes/winsdklong-md.md)] fournissent des outils pour importer et convertir une bibliothèque de types vers un assembly d’interopérabilité, comme décrit dans [Importation d’une bibliothèque de types sous la forme d’un assembly](importing-a-type-library-as-an-assembly.md).</span><span class="sxs-lookup"><span data-stu-id="ff228-104">Visual Studio and the [!INCLUDE[winsdklong](../../../includes/winsdklong-md.md)] provide tools to import and convert a type library to an interop assembly, as discussed in [Importing a Type Library as an Assembly](importing-a-type-library-as-an-assembly.md).</span></span> <span data-ttu-id="ff228-105">Il existe deux façons de déployer une application d’interopérabilité :</span><span class="sxs-lookup"><span data-stu-id="ff228-105">There are two ways to deploy an interop application:</span></span>  
  
-   <span data-ttu-id="ff228-106">En utilisant des types d’interopérabilité : à compter de [!INCLUDE[net_v40_long](../../../includes/net-v40-long-md.md)], vous pouvez demander au compilateur d’incorporer les informations de type à partir d’un assembly d’interopérabilité dans votre fichier exécutable.</span><span class="sxs-lookup"><span data-stu-id="ff228-106">By using embedded interop types: Beginning with the [!INCLUDE[net_v40_long](../../../includes/net-v40-long-md.md)], you can instruct the compiler to embed type information from an interop assembly into your executable.</span></span> <span data-ttu-id="ff228-107">Le compilateur incorpore uniquement les informations de type que votre application utilise.</span><span class="sxs-lookup"><span data-stu-id="ff228-107">The compiler embeds only the type information that your application uses.</span></span> <span data-ttu-id="ff228-108">Vous n’avez pas à déployer l’assembly d’interopérabilité avec votre application.</span><span class="sxs-lookup"><span data-stu-id="ff228-108">You do not have to deploy the interop assembly with your application.</span></span> <span data-ttu-id="ff228-109">Il s'agit de la technique recommandée.</span><span class="sxs-lookup"><span data-stu-id="ff228-109">This is the recommended technique.</span></span>  
  
-   <span data-ttu-id="ff228-110">En déployant des assemblys d’interopérabilité : vous pouvez créer une référence standard à un assembly d’interopérabilité.</span><span class="sxs-lookup"><span data-stu-id="ff228-110">By deploying interop assemblies: You can create a standard reference to an interop assembly.</span></span> <span data-ttu-id="ff228-111">Dans ce cas, l’assembly d’interopérabilité doit être déployé avec votre application.</span><span class="sxs-lookup"><span data-stu-id="ff228-111">In this case, the interop assembly must be deployed with your application.</span></span> <span data-ttu-id="ff228-112">Si vous utilisez cette technique et que vous n’utilisez pas un composant COM privé, référencez toujours l’assembly PIA (Primary Interop Assembly) publié par l’auteur du composant COM que vous prévoyez d’incorporer dans votre code managé.</span><span class="sxs-lookup"><span data-stu-id="ff228-112">If you employ this technique, and you are not using a private COM component, always reference the primary interop assembly (PIA) published by the author of the COM component you intend to incorporate in your managed code.</span></span> <span data-ttu-id="ff228-113">Pour plus d’informations sur la production et l’utilisation d’assemblys PIA, consultez [Assemblys PIA (Primary Interop Assembly)](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/aax7sdch(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="ff228-113">For more information about producing and using primary interop assemblies, see [Primary Interop Assemblies](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/aax7sdch(v=vs.100)).</span></span>  
  
 <span data-ttu-id="ff228-114">Si vous utilisez des types interop incorporés, le déploiement est simple et direct.</span><span class="sxs-lookup"><span data-stu-id="ff228-114">If you use embedded interop types, deployment is simple and straightforward.</span></span> <span data-ttu-id="ff228-115">Vous n’avez rien de spécial à faire.</span><span class="sxs-lookup"><span data-stu-id="ff228-115">There is nothing special you need to do.</span></span> <span data-ttu-id="ff228-116">Le reste de cet article décrit les scénarios de déploiement des assemblys d’interopérabilité avec votre application.</span><span class="sxs-lookup"><span data-stu-id="ff228-116">The rest of this article describes the scenarios for deploying interop assemblies with your application.</span></span>  
  
## <a name="deploying-interop-assemblies"></a><span data-ttu-id="ff228-117">Déploiement des assemblys d’interopérabilité</span><span class="sxs-lookup"><span data-stu-id="ff228-117">Deploying Interop Assemblies</span></span>  
 <span data-ttu-id="ff228-118">Les assemblys peuvent avoir des noms forts.</span><span class="sxs-lookup"><span data-stu-id="ff228-118">Assemblies can have strong names.</span></span> <span data-ttu-id="ff228-119">Un assembly avec nom fort inclut la clé publique de l’éditeur, qui fournit une identité unique.</span><span class="sxs-lookup"><span data-stu-id="ff228-119">A strong-named assembly includes the publisher's public key, which provides a unique identity.</span></span> <span data-ttu-id="ff228-120">Les assemblys qui sont produits par l’[importateur de bibliothèques de types (Tlbimp.exe)](../tools/tlbimp-exe-type-library-importer.md) peuvent être signés par l’éditeur à l’aide de l’option **/keyfile**.</span><span class="sxs-lookup"><span data-stu-id="ff228-120">Assemblies that are produced by the [Type Library Importer (Tlbimp.exe)](../tools/tlbimp-exe-type-library-importer.md) can be signed by the publisher by using the **/keyfile** option.</span></span> <span data-ttu-id="ff228-121">Vous pouvez installer des assemblys signés dans le Global Assembly Cache.</span><span class="sxs-lookup"><span data-stu-id="ff228-121">You can install signed assemblies into the global assembly cache.</span></span> <span data-ttu-id="ff228-122">Les assemblys non signés doivent être installés sur la machine de l’utilisateur en tant qu’assemblys privés.</span><span class="sxs-lookup"><span data-stu-id="ff228-122">Unsigned assemblies must be installed on the user's machine as private assemblies.</span></span>  
  
### <a name="private-assemblies"></a><span data-ttu-id="ff228-123">Assemblys privés</span><span class="sxs-lookup"><span data-stu-id="ff228-123">Private Assemblies</span></span>  
 <span data-ttu-id="ff228-124">Pour installer un assembly destiné à une utilisation privée, vous devez installer l’exécutable de l’application et l’assembly d’interopérabilité qui contient les types COM importés dans la même structure de répertoires.</span><span class="sxs-lookup"><span data-stu-id="ff228-124">To install an assembly to be used privately, both the application executable and the interop assembly that contains imported COM types must be installed in the same directory structure.</span></span> <span data-ttu-id="ff228-125">L’illustration suivante montre un assembly d’interopérabilité non signé destiné à une utilisation privée par Client1.exe et Client2.exe, qui se trouvent dans des répertoires distincts de l’application.</span><span class="sxs-lookup"><span data-stu-id="ff228-125">The following illustration shows an unsigned interop assembly to be used privately by Client1.exe and Client2.exe, which reside in separate application directories.</span></span> <span data-ttu-id="ff228-126">L’assembly d’interopérabilité, appelé LOANLib.dll dans cet exemple, est installé deux fois.</span><span class="sxs-lookup"><span data-stu-id="ff228-126">The interop assembly, which is called LOANLib.dll in this example, is installed twice.</span></span>  
  
 <span data-ttu-id="ff228-127">![Structure de répertoires et Registre Windows](./media/deploying-an-interop-application/com-private-deployment.gif "Structure de répertoires et entrées du Registre pour un déploiement privé")</span><span class="sxs-lookup"><span data-stu-id="ff228-127">![Directory structure and Windows registry](./media/deploying-an-interop-application/com-private-deployment.gif "Directory structure and registry entries for a private deployment")</span></span>  
  
 <span data-ttu-id="ff228-128">Tous les composants COM associés à l’application doivent être installés dans le Registre Windows.</span><span class="sxs-lookup"><span data-stu-id="ff228-128">All COM components associated with the application must be installed in the Windows registry.</span></span> <span data-ttu-id="ff228-129">Si les fichiers Client1.exe et Client2.exe de l’illustration sont installés sur des ordinateurs différents, vous devez inscrire les composants COM sur les deux ordinateurs.</span><span class="sxs-lookup"><span data-stu-id="ff228-129">If Client1.exe and Client2.exe in the illustration are installed on different computers, you must register the COM components on both computers.</span></span>  
  
### <a name="shared-assemblies"></a><span data-ttu-id="ff228-130">Assemblys partagés</span><span class="sxs-lookup"><span data-stu-id="ff228-130">Shared Assemblies</span></span>  
 <span data-ttu-id="ff228-131">Les assemblys qui sont partagés par plusieurs applications doivent être installés dans un référentiel centralisé appelé le Global Assembly Cache.</span><span class="sxs-lookup"><span data-stu-id="ff228-131">Assemblies that are shared by multiple applications should be installed in a centralized repository called the global assembly cache.</span></span> <span data-ttu-id="ff228-132">Les clients .NET peuvent accéder à la même copie de l’assembly d’interopérabilité, qui est signé et installé dans le Global Assembly Cache.</span><span class="sxs-lookup"><span data-stu-id="ff228-132">.NET clients can access the same copy of the interop assembly, which is signed and installed in the global assembly cache.</span></span> <span data-ttu-id="ff228-133">Pour plus d’informations sur la production et l’utilisation d’assemblys PIA, consultez [Assemblys PIA (Primary Interop Assembly)](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/aax7sdch(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="ff228-133">For more information about producing and using primary interop assemblies, see [Primary Interop Assemblies](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/aax7sdch(v=vs.100)).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="ff228-134">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="ff228-134">See also</span></span>
- [<span data-ttu-id="ff228-135">Exposition de composants COM au .NET Framework</span><span class="sxs-lookup"><span data-stu-id="ff228-135">Exposing COM Components to the .NET Framework</span></span>](exposing-com-components.md)
- [<span data-ttu-id="ff228-136">Importation d'une bibliothèque de types sous la forme d'un assembly</span><span class="sxs-lookup"><span data-stu-id="ff228-136">Importing a Type Library as an Assembly</span></span>](importing-a-type-library-as-an-assembly.md)
- <span data-ttu-id="ff228-137">[Utilisation de types COM dans du code managé](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/3y76b69k(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="ff228-137">[Using COM Types in Managed Code](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/3y76b69k(v=vs.100))</span></span>
- [<span data-ttu-id="ff228-138">Compilation d'un projet d'interopérabilité</span><span class="sxs-lookup"><span data-stu-id="ff228-138">Compiling an Interop Project</span></span>](compiling-an-interop-project.md)
