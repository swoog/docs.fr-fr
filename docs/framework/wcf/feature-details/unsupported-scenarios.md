---
title: Scénarios non pris en charge
ms.date: 03/30/2017
ms.assetid: 72027d0f-146d-40c5-9d72-e94392c8bb40
ms.openlocfilehash: 6c0ee061f754e85244bffdc06cbe23aee68d2222
ms.sourcegitcommit: 3c1c3ba79895335ff3737934e39372555ca7d6d0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/06/2018
ms.locfileid: "43858061"
---
# <a name="unsupported-scenarios"></a><span data-ttu-id="bba56-102">Scénarios non pris en charge</span><span class="sxs-lookup"><span data-stu-id="bba56-102">Unsupported Scenarios</span></span>
<span data-ttu-id="bba56-103">Pour diverses raisons, Windows Communication Foundation (WCF) ne prend pas en charge certains scénarios de sécurité spécifiques.</span><span class="sxs-lookup"><span data-stu-id="bba56-103">For various reasons, Windows Communication Foundation (WCF) does not support some specific security scenarios.</span></span> <span data-ttu-id="bba56-104">Par exemple, [!INCLUDE[wxp](../../../../includes/wxp-md.md)] Édition familiale n’implémente pas les protocoles d’authentification SSPI ou Kerberos, et par conséquent, WCF ne prend pas en charge l’exécution d’un service avec l’authentification Windows sur cette plateforme.</span><span class="sxs-lookup"><span data-stu-id="bba56-104">For example, [!INCLUDE[wxp](../../../../includes/wxp-md.md)] Home Edition does not implement the SSPI or Kerberos authentication protocols, and therefore WCF does not support running a service with Windows authentication on that platform.</span></span> <span data-ttu-id="bba56-105">Autres mécanismes d’authentification, telles que le nom d’utilisateur/mot de passe et l’authentification intégrée HTTP/HTTPS sont pris en charge lors de l’exécution de WCF sous Windows XP Édition familiale.</span><span class="sxs-lookup"><span data-stu-id="bba56-105">Other authentication mechanisms, such as username/password and HTTP/HTTPS integrated authentication are supported when running WCF under Windows XP Home Edition.</span></span>  
  
## <a name="impersonation-scenarios"></a><span data-ttu-id="bba56-106">Emprunt d'identité</span><span class="sxs-lookup"><span data-stu-id="bba56-106">Impersonation Scenarios</span></span>  
  
### <a name="impersonated-identity-might-not-flow-when-clients-make-asynchronous-calls"></a><span data-ttu-id="bba56-107">Il se peut que l'identité empruntée ne fonctionne pas correctement lorsque des clients passent des appels asynchrones.</span><span class="sxs-lookup"><span data-stu-id="bba56-107">Impersonated Identity Might Not Flow When Clients Make Asynchronous Calls</span></span>  
 <span data-ttu-id="bba56-108">Lorsqu'un client WCF passe des appels asynchrones à un service WCF à l'aide de l'authentification Windows sous un emprunt d'identité, l'authentification peut se produire avec l'identité du processus client au lieu de l'identité empruntée.</span><span class="sxs-lookup"><span data-stu-id="bba56-108">When a WCF client makes asynchronous calls to a WCF service using Windows authentication under impersonation, authentication might occur with the identity of the client process instead of the impersonated identity.</span></span>  
  
### <a name="windows-xp-and-secure-context-token-cookie-enabled"></a><span data-ttu-id="bba56-109">Windows XP avec le cookie de jeton de contexte sécurisé activé</span><span class="sxs-lookup"><span data-stu-id="bba56-109">Windows XP and Secure Context Token Cookie Enabled</span></span>  
 <span data-ttu-id="bba56-110">WCF ne prend pas en charge l’emprunt d’identité et un <xref:System.InvalidOperationException> est levée lorsque les conditions suivantes sont réunies :</span><span class="sxs-lookup"><span data-stu-id="bba56-110">WCF does not support impersonation and an <xref:System.InvalidOperationException> is thrown when the following conditions exist:</span></span>  
  
-   <span data-ttu-id="bba56-111">Le système d'exploitation correspond à [!INCLUDE[wxp](../../../../includes/wxp-md.md)].</span><span class="sxs-lookup"><span data-stu-id="bba56-111">The operating system is [!INCLUDE[wxp](../../../../includes/wxp-md.md)].</span></span>  
  
-   <span data-ttu-id="bba56-112">Le mode d'authentification aboutit à un identité Windows.</span><span class="sxs-lookup"><span data-stu-id="bba56-112">The authentication mode results in a Windows identity.</span></span>  
  
-   <span data-ttu-id="bba56-113">La propriété <xref:System.ServiceModel.OperationBehaviorAttribute.Impersonation%2A> de l'objet <xref:System.ServiceModel.OperationBehaviorAttribute> a la valeur <xref:System.ServiceModel.ImpersonationOption.Required>.</span><span class="sxs-lookup"><span data-stu-id="bba56-113">The <xref:System.ServiceModel.OperationBehaviorAttribute.Impersonation%2A> property of the <xref:System.ServiceModel.OperationBehaviorAttribute> is set to <xref:System.ServiceModel.ImpersonationOption.Required>.</span></span>  
  
-   <span data-ttu-id="bba56-114">Un jeton de contexte de sécurité basé sur l'état est créé (cette création est désactivée par défaut).</span><span class="sxs-lookup"><span data-stu-id="bba56-114">A state-based security context token (SCT) is created (by default, creation is disabled).</span></span>  
  
 <span data-ttu-id="bba56-115">Ce jeton peut uniquement être crée à l’aide d’une liaison personnalisée.</span><span class="sxs-lookup"><span data-stu-id="bba56-115">The state-based SCT can only be created using a custom binding.</span></span> <span data-ttu-id="bba56-116">Pour plus d’informations, consultez [Comment : créer un jeton de contexte de sécurité pour une Session sécurisée](../../../../docs/framework/wcf/feature-details/how-to-create-a-security-context-token-for-a-secure-session.md).) Dans le code, ce jeton est activé en créant un élément de liaison de sécurité (<xref:System.ServiceModel.Channels.SymmetricSecurityBindingElement> ou <xref:System.ServiceModel.Channels.AsymmetricSecurityBindingElement>) à l'aide de la méthode <xref:System.ServiceModel.Channels.SecurityBindingElement.CreateSspiNegotiationBindingElement%28System.Boolean%29?displayProperty=nameWithType> ou <xref:System.ServiceModel.Channels.SecurityBindingElement.CreateSecureConversationBindingElement%28System.ServiceModel.Channels.SecurityBindingElement%2CSystem.Boolean%29?displayProperty=nameWithType> et en affectant au paramètre `requireCancellation` la valeur `false`.</span><span class="sxs-lookup"><span data-stu-id="bba56-116">For more information, see [How to: Create a Security Context Token for a Secure Session](../../../../docs/framework/wcf/feature-details/how-to-create-a-security-context-token-for-a-secure-session.md).) In code, the token is enabled by creating a security binding element (either <xref:System.ServiceModel.Channels.SymmetricSecurityBindingElement> or <xref:System.ServiceModel.Channels.AsymmetricSecurityBindingElement>) using the <xref:System.ServiceModel.Channels.SecurityBindingElement.CreateSspiNegotiationBindingElement%28System.Boolean%29?displayProperty=nameWithType> or the <xref:System.ServiceModel.Channels.SecurityBindingElement.CreateSecureConversationBindingElement%28System.ServiceModel.Channels.SecurityBindingElement%2CSystem.Boolean%29?displayProperty=nameWithType> method and setting the `requireCancellation` parameter to `false`.</span></span> <span data-ttu-id="bba56-117">Ce paramètre concerne la mise en cache du jeton.</span><span class="sxs-lookup"><span data-stu-id="bba56-117">The parameter refers to the caching of the SCT.</span></span> <span data-ttu-id="bba56-118">L'affectation de la valeur `false` à ce paramètre permet d'activer la fonctionnalité de jeton basé sur l'état.</span><span class="sxs-lookup"><span data-stu-id="bba56-118">Setting the value to `false` enables the state-based SCT feature.</span></span>  
  
 <span data-ttu-id="bba56-119">Vous pouvez également, dans la configuration, le jeton est activé en créant un <`customBinding`>, puis en ajoutant un <`security`> élément et en définissant le `authenticationMode` attribut SecureConversation et le `requireSecurityContextCancellation` attribut `true`.</span><span class="sxs-lookup"><span data-stu-id="bba56-119">Alternatively, in configuration, the token is enabled by creating a <`customBinding`>, then adding a <`security`> element, and setting the `authenticationMode` attribute to SecureConversation and the `requireSecurityContextCancellation` attribute to `true`.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bba56-120">Les exigences précédentes sont spécifiques.</span><span class="sxs-lookup"><span data-stu-id="bba56-120">The preceding requirements are specific.</span></span> <span data-ttu-id="bba56-121">Par exemple, l'élément <xref:System.ServiceModel.Channels.SecurityBindingElement.CreateKerberosBindingElement%2A> crée un élément de liaison qui aboutit à une identité Windows, mais cet élément ne définit pas de jeton de contexte de sécurité avec état.</span><span class="sxs-lookup"><span data-stu-id="bba56-121">For example, the <xref:System.ServiceModel.Channels.SecurityBindingElement.CreateKerberosBindingElement%2A> creates a binding element that results in a Windows identity, but does not establish an SCT.</span></span> <span data-ttu-id="bba56-122">Vous pouvez donc utiliser cet élément avec l'option `Required` de [!INCLUDE[wxp](../../../../includes/wxp-md.md)].</span><span class="sxs-lookup"><span data-stu-id="bba56-122">Therefore, you can use it with the `Required` option on [!INCLUDE[wxp](../../../../includes/wxp-md.md)].</span></span>  
  
### <a name="possible-aspnet-conflict"></a><span data-ttu-id="bba56-123">Éventuel conflit avec ASP.NET</span><span class="sxs-lookup"><span data-stu-id="bba56-123">Possible ASP.NET Conflict</span></span>  
 <span data-ttu-id="bba56-124">WCF et [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] peuvent activer ou désactiver l’emprunt d’identité.</span><span class="sxs-lookup"><span data-stu-id="bba56-124">WCF and [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] can both enable or disable impersonation.</span></span> <span data-ttu-id="bba56-125">Lorsque [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] héberge une application WCF, un conflit peut survenir entre WCF et [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] paramètres de configuration.</span><span class="sxs-lookup"><span data-stu-id="bba56-125">When [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] hosts an WCF application, a conflict may exist between the WCF and [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] configuration settings.</span></span> <span data-ttu-id="bba56-126">En cas de conflit, le paramètre de WCF est prioritaire, sauf si le <xref:System.ServiceModel.OperationBehaviorAttribute.Impersonation%2A> propriété est définie sur <xref:System.ServiceModel.ImpersonationOption.NotAllowed>, auquel cas le [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] le paramètre de l’emprunt d’identité est prioritaire.</span><span class="sxs-lookup"><span data-stu-id="bba56-126">In case of conflict, the WCF setting takes precedence, unless the <xref:System.ServiceModel.OperationBehaviorAttribute.Impersonation%2A> property is set to <xref:System.ServiceModel.ImpersonationOption.NotAllowed>, in which case the [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] impersonation setting takes precedence.</span></span>  
  
### <a name="assembly-loads-may-fail-under-impersonation"></a><span data-ttu-id="bba56-127">Les chargements d'assembly risquent d'échouer lorsque l'emprunt d'identité est activé</span><span class="sxs-lookup"><span data-stu-id="bba56-127">Assembly Loads May Fail Under Impersonation</span></span>  
 <span data-ttu-id="bba56-128">Si le contexte emprunté ne dispose de droits d'accès permettant le chargement d'un assembly et que l'objet CLR tente pour la première fois de le charger pour AppDomain, <xref:System.AppDomain> met l'échec en mémoire cache.</span><span class="sxs-lookup"><span data-stu-id="bba56-128">If the impersonated context does not have access rights to load an assembly and if it is the first time the common language runtime (CLR) is attempting to load the assembly for that AppDomain, the <xref:System.AppDomain> caches the failure.</span></span> <span data-ttu-id="bba56-129">Les tentatives suivantes pour charger cet assembly échoueront également, même après restauration de l'emprunt d'identité et même si le contexte restauré dispose cette fois de droits d'accès permettant de charger cet assembly.</span><span class="sxs-lookup"><span data-stu-id="bba56-129">Subsequent attempts to load that assembly (or assemblies) fail, even after reverting the impersonation, and even if the reverted context has access rights to load the assembly.</span></span> <span data-ttu-id="bba56-130">Ces échecs successifs se produisent car l'objet CLR ne tente pas une nouvelle fois de charger l'assembly après la modification du contexte utilisateur.</span><span class="sxs-lookup"><span data-stu-id="bba56-130">This is because the CLR does not re-attempt the load after the user context is changed.</span></span> <span data-ttu-id="bba56-131">Vous devez redémarrer le domaine d'application pour résoudre ce problème.</span><span class="sxs-lookup"><span data-stu-id="bba56-131">You must restart the application domain to recover from the failure.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bba56-132">La valeur par défaut de la propriété <xref:System.ServiceModel.Security.WindowsClientCredential.AllowedImpersonationLevel%2A> de la classe <xref:System.ServiceModel.Security.WindowsClientCredential> est <xref:System.Security.Principal.TokenImpersonationLevel.Identification>.</span><span class="sxs-lookup"><span data-stu-id="bba56-132">The default value for the <xref:System.ServiceModel.Security.WindowsClientCredential.AllowedImpersonationLevel%2A> property of the <xref:System.ServiceModel.Security.WindowsClientCredential> class is <xref:System.Security.Principal.TokenImpersonationLevel.Identification>.</span></span> <span data-ttu-id="bba56-133">Dans la plupart des cas, les contextes d'emprunt d'identité de niveau identification ne disposent pas de droits leur permettant de charger d'autres assemblys.</span><span class="sxs-lookup"><span data-stu-id="bba56-133">In most cases, an identification-level impersonation context has no rights to load any additional assemblies.</span></span> <span data-ttu-id="bba56-134">Il s'agit de la valeur par défaut. Il est donc important de garder à l'esprit ce cas très fréquent.</span><span class="sxs-lookup"><span data-stu-id="bba56-134">This is the default value, so this is a very common condition to be aware of.</span></span> <span data-ttu-id="bba56-135">L'emprunt d'identité de niveau identification se produit lorsque le processus d'emprunt ne dispose pas du droit `SeImpersonate`.</span><span class="sxs-lookup"><span data-stu-id="bba56-135">Identification-level impersonation also occurs when the impersonating process does not have the `SeImpersonate` privilege.</span></span> <span data-ttu-id="bba56-136">Pour plus d’informations, consultez [délégation et emprunt d’identité](../../../../docs/framework/wcf/feature-details/delegation-and-impersonation-with-wcf.md).</span><span class="sxs-lookup"><span data-stu-id="bba56-136">For more information, see [Delegation and Impersonation](../../../../docs/framework/wcf/feature-details/delegation-and-impersonation-with-wcf.md).</span></span>  
  
### <a name="delegation-requires-credential-negotiation"></a><span data-ttu-id="bba56-137">La délégation nécessite la négociation des informations d'identification</span><span class="sxs-lookup"><span data-stu-id="bba56-137">Delegation Requires Credential Negotiation</span></span>  
 <span data-ttu-id="bba56-138">Pour pouvoir utiliser le protocole d'authentification Kerberos avec la délégation, vous devez implémenter le protocole Kerberos en utilisant la négociation des informations d'identification (parfois appelé Kerberos multi-segment ou multi-étape).</span><span class="sxs-lookup"><span data-stu-id="bba56-138">To use the Kerberos authentication protocol with delegation, you must implement the Kerberos protocol with credential negotiation (sometimes called multi-leg or multi-step Kerberos).</span></span> <span data-ttu-id="bba56-139">Si vous implémentez l'authentification Kerberos sans négociation d'informations d'identification (parfois appelée Kerberos « one-shot » ou Kerberos « single-leg »), une exception est levée.</span><span class="sxs-lookup"><span data-stu-id="bba56-139">If you implement Kerberos authentication without credential negotiation (sometimes called one-shot or single-leg Kerberos), an exception is thrown.</span></span> <span data-ttu-id="bba56-140">Pour plus d’informations sur la façon d’implémenter la négociation des informations d’identification, consultez [débogage des erreurs d’authentification Windows](../../../../docs/framework/wcf/feature-details/debugging-windows-authentication-errors.md).</span><span class="sxs-lookup"><span data-stu-id="bba56-140">For more information about how to implement credential negotiation, see [Debugging Windows Authentication Errors](../../../../docs/framework/wcf/feature-details/debugging-windows-authentication-errors.md).</span></span>  
  
## <a name="cryptography"></a><span data-ttu-id="bba56-141">Chiffrement</span><span class="sxs-lookup"><span data-stu-id="bba56-141">Cryptography</span></span>  
  
### <a name="sha-256-supported-only-for-symmetric-key-usages"></a><span data-ttu-id="bba56-142">SHA-256 uniquement pris en charge lorsque des clés symétriques sont utilisées</span><span class="sxs-lookup"><span data-stu-id="bba56-142">SHA-256 Supported Only for Symmetric Key Usages</span></span>  
 <span data-ttu-id="bba56-143">WCF prend en charge une variété de chiffrement et signature algorithmes digest de création que vous pouvez spécifier à l’aide de la suite d’algorithme dans les liaisons fournies par le système.</span><span class="sxs-lookup"><span data-stu-id="bba56-143">WCF supports a variety of encryption and signature digest creation algorithms that you can specify using the algorithm suite in the system-provided bindings.</span></span> <span data-ttu-id="bba56-144">Pour améliorer la sécurité, WCF prend en charge les algorithmes de hachage algorithme sécurisé (SHA) 2, en particulier de SHA-256, pour la création de hachages de condensat de signature.</span><span class="sxs-lookup"><span data-stu-id="bba56-144">For improved security, WCF supports Secure Hash Algorithm (SHA) 2 algorithms, specifically SHA-256, for creating signature digest hashes.</span></span> <span data-ttu-id="bba56-145">Cette mise en production prend uniquement en charge SHA-256 lorsque des clés symétriques, telles que les clés Kerberos sont utilisées et lorsque les messages ne sont pas signés par les certificats X.509.</span><span class="sxs-lookup"><span data-stu-id="bba56-145">This release supports SHA-256 only for symmetric key usages, such as Kerberos keys, and where an X.509 certificate is not used to sign the message.</span></span> <span data-ttu-id="bba56-146">WCF ne prend pas en charge les signatures RSA (utilisées dans les certificats X.509) à l’aide du hachage SHA-256 en raison de l’absence de prise en charge pour RSA-SHA256 dans la [!INCLUDE[vstecwinfx](../../../../includes/vstecwinfx-md.md)].</span><span class="sxs-lookup"><span data-stu-id="bba56-146">WCF does not support RSA signatures (used in X.509 certificates) using SHA-256 hash due to the current lack of support for RSA-SHA256 in the [!INCLUDE[vstecwinfx](../../../../includes/vstecwinfx-md.md)].</span></span>  
  
### <a name="fips-compliant-sha-256-hashes-not-supported"></a><span data-ttu-id="bba56-147">Hachage SHA-256 conforme FIPS non pris en charge</span><span class="sxs-lookup"><span data-stu-id="bba56-147">FIPS-Compliant SHA-256 Hashes not Supported</span></span>  
 <span data-ttu-id="bba56-148">WCF ne prend pas en charge les hachages SHA-256 conformes FIPS, suites algorithmiques qui utilisent SHA-256 ne sont pas pris en charge par WCF sur les systèmes où l’utilisation des algorithmes compatibles FIPS est requise.</span><span class="sxs-lookup"><span data-stu-id="bba56-148">WCF does not support SHA-256 FIPS-compliant hashes, so algorithm suites that use SHA-256 are not supported by WCF on systems where use of FIPS compliant algorithms is required.</span></span>  
  
### <a name="fips-compliant-algorithms-may-fail-if-registry-is-edited"></a><span data-ttu-id="bba56-149">Les algorithmes conformes FIPS risquent d'échouer si le registre est modifié</span><span class="sxs-lookup"><span data-stu-id="bba56-149">FIPS-Compliant Algorithms May Fail if Registry Is Edited</span></span>  
 <span data-ttu-id="bba56-150">Vous pouvez activer ou désactiver les algorithmes conformes FIPS en utilisant les paramètres de sécurité locale de l'outil enfichable MMC.</span><span class="sxs-lookup"><span data-stu-id="bba56-150">You can enable and disable Federal Information Processing Standards (FIPS)-compliant algorithms by using the Local Security Settings Microsoft Management Console (MMC) snap-in.</span></span> <span data-ttu-id="bba56-151">Ces paramètres sont également accessibles à partir du registre.</span><span class="sxs-lookup"><span data-stu-id="bba56-151">You can also access the setting in the registry.</span></span> <span data-ttu-id="bba56-152">Notez, cependant, que WCF ne prend pas en charge le Registre pour modifier ces paramètres.</span><span class="sxs-lookup"><span data-stu-id="bba56-152">Note, however, that WCF does not support using the registry to reset the setting.</span></span> <span data-ttu-id="bba56-153">Si vous affectez à ces paramètres une valeur autre que 1 ou 0, cela risque de générer des résultats incohérents entre CLR et le système d'exploitation.</span><span class="sxs-lookup"><span data-stu-id="bba56-153">If the value is set to anything other than 1 or 0, inconsistent results can occur between the CLR and the operating system.</span></span>  
  
### <a name="fips-compliant-aes-encryption-limitation"></a><span data-ttu-id="bba56-154">Limites d'utilisation concernant le chiffrement AES conforme FIPS</span><span class="sxs-lookup"><span data-stu-id="bba56-154">FIPS-Compliant AES Encryption Limitation</span></span>  
 <span data-ttu-id="bba56-155">Le chiffrement AES conforme FIPS n'est pas compatible avec les rappels duplex dans le cadre des emprunts d'identité de niveau identification.</span><span class="sxs-lookup"><span data-stu-id="bba56-155">FIPS compliant AES encryption does not work in duplex callbacks under identification level impersonation.</span></span>  
  
### <a name="cngksp-certificates"></a><span data-ttu-id="bba56-156">Certificats CNG/KSP</span><span class="sxs-lookup"><span data-stu-id="bba56-156">CNG/KSP Certificates</span></span>  
 <span data-ttu-id="bba56-157">*Cryptography API : Infrastructure de Diagnostics Windows (CNG Next Generation)* est le remplaçant à long terme pour l’interface CryptoAPI.</span><span class="sxs-lookup"><span data-stu-id="bba56-157">*Cryptography API: Next Generation (CNG)* is the long-term replacement for the CryptoAPI.</span></span> <span data-ttu-id="bba56-158">Cette API est disponible dans le code non managé sur [!INCLUDE[wv](../../../../includes/wv-md.md)], [!INCLUDE[lserver](../../../../includes/lserver-md.md)] et versions ultérieures de Windows.</span><span class="sxs-lookup"><span data-stu-id="bba56-158">This API is available in unmanaged code on [!INCLUDE[wv](../../../../includes/wv-md.md)],  [!INCLUDE[lserver](../../../../includes/lserver-md.md)] and later Windows versions.</span></span>  
  
 <span data-ttu-id="bba56-159">.NET framework 4.6.1 et versions antérieures ne prennent pas en charge ces certificats, car elles utilisent l’interface CryptoAPI hérité pour gérer les certificats CNG/KSP.</span><span class="sxs-lookup"><span data-stu-id="bba56-159">.NET Framework 4.6.1 and earlier versions do not support these certificates because they use the legacy CryptoAPI to handle CNG/KSP certificates.</span></span> <span data-ttu-id="bba56-160">L’utilisation de ces certificats avec .NET Framework 4.6.1 et versions antérieures provoquera une exception.</span><span class="sxs-lookup"><span data-stu-id="bba56-160">The use of these certificates with   .NET Framework 4.6.1 and earlier versions will cause an exception.</span></span>  
  
 <span data-ttu-id="bba56-161">Pour indiquer si un certificat utilise KSP, deux méthodes sont possibles :</span><span class="sxs-lookup"><span data-stu-id="bba56-161">There are two possible ways to tell if a certificate uses KSP:</span></span>  
  
-   <span data-ttu-id="bba56-162">Exécutez `p/invoke` de `CertGetCertificateContextProperty` et inspectez `dwProvType` sur la `CertGetCertificateContextProperty` retournée.</span><span class="sxs-lookup"><span data-stu-id="bba56-162">Do a `p/invoke` of `CertGetCertificateContextProperty`, and inspect `dwProvType` on the returned `CertGetCertificateContextProperty`.</span></span>  
  
-   <span data-ttu-id="bba56-163">Utilisez le `certutil` commande à partir de la ligne de commande pour interroger des certificats.</span><span class="sxs-lookup"><span data-stu-id="bba56-163">Use the  `certutil` command from the command line for querying certificates.</span></span> <span data-ttu-id="bba56-164">Pour plus d’informations, consultez [Tâches Certutil pour le dépannage des certificats](https://go.microsoft.com/fwlink/?LinkId=120056).</span><span class="sxs-lookup"><span data-stu-id="bba56-164">For more information, see [Certutil tasks for troubleshooting certificates](https://go.microsoft.com/fwlink/?LinkId=120056).</span></span>  
  
## <a name="message-security-fails-if-using-aspnet-impersonation-and-aspnet-compatibility-is-required"></a><span data-ttu-id="bba56-165">La sécurité de message échouera si l'emprunt d'identité ASP.NET est utilisé et si la compatibilité ASP.NET est requise</span><span class="sxs-lookup"><span data-stu-id="bba56-165">Message Security Fails if Using ASP.NET Impersonation and ASP.NET Compatibility Is Required</span></span>  
 <span data-ttu-id="bba56-166">WCF ne prend pas en charge la combinaison suivante de paramètres, car ils peuvent également empêcher l’authentification du client ne se produise :</span><span class="sxs-lookup"><span data-stu-id="bba56-166">WCF does not support the following combination of settings because they can prevent client authentication from occurring:</span></span>  
  
-   <span data-ttu-id="bba56-167">L'emprunt d'identité [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] est activé.</span><span class="sxs-lookup"><span data-stu-id="bba56-167">[!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] Impersonation is enabled.</span></span> <span data-ttu-id="bba56-168">Cela est effectué dans le fichier Web.config en définissant le `impersonate` attribut de la <`identity`> élément à `true`.</span><span class="sxs-lookup"><span data-stu-id="bba56-168">This is done in the Web.config file by setting the `impersonate` attribute of the <`identity`> element to `true`.</span></span>  
  
-   [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)]<span data-ttu-id="bba56-169"> mode de compatibilité est activé en définissant le `aspNetCompatibilityEnabled` attribut de la [ \<serviceHostingEnvironment >](../../../../docs/framework/configure-apps/file-schema/wcf/servicehostingenvironment.md) à `true\`.</span><span class="sxs-lookup"><span data-stu-id="bba56-169"> compatibility mode is enabled by setting the `aspNetCompatibilityEnabled` attribute of the [\<serviceHostingEnvironment>](../../../../docs/framework/configure-apps/file-schema/wcf/servicehostingenvironment.md) to `true\`.</span></span>  
  
-   <span data-ttu-id="bba56-170">Le mode de sécurité de niveau message est utilisé.</span><span class="sxs-lookup"><span data-stu-id="bba56-170">Message mode security is used.</span></span>  
  
 <span data-ttu-id="bba56-171">Pour contourner cette difficulté, il suffit de désactiver le mode de compatibilité [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)].</span><span class="sxs-lookup"><span data-stu-id="bba56-171">The work-around is to turn off the [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] compatibility mode.</span></span> <span data-ttu-id="bba56-172">Ou, si le [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] mode de compatibilité est requis, désactivez le [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] l’emprunt d’identité des fonctionnalités et utilisez à la place de l’emprunt d’identité fourni par WCF.</span><span class="sxs-lookup"><span data-stu-id="bba56-172">Or, if the [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] compatibility mode is required, disable the [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] impersonation feature and use WCF-provided impersonation instead.</span></span> <span data-ttu-id="bba56-173">Pour plus d’informations, consultez [délégation et emprunt d’identité](../../../../docs/framework/wcf/feature-details/delegation-and-impersonation-with-wcf.md).</span><span class="sxs-lookup"><span data-stu-id="bba56-173">For more information, see [Delegation and Impersonation](../../../../docs/framework/wcf/feature-details/delegation-and-impersonation-with-wcf.md).</span></span>  
  
## <a name="ipv6-literal-address-failure"></a><span data-ttu-id="bba56-174">Échec d'adresse littérale IPv6</span><span class="sxs-lookup"><span data-stu-id="bba56-174">IPv6 Literal Address Failure</span></span>  
 <span data-ttu-id="bba56-175">Les demandes de sécurité échouent si le client et le service s'exécutent sur le même ordinateur et les adresses littérales IPv6 sont utilisées pour le service.</span><span class="sxs-lookup"><span data-stu-id="bba56-175">Security requests fail when the client and service are on the same machine, and IPv6 literal addresses are used for the service.</span></span>  
  
 <span data-ttu-id="bba56-176">L'utilisation d'adresses littérales IPv6 est possible à condition que le client et le service ne s'exécutent pas sur le même ordinateur.</span><span class="sxs-lookup"><span data-stu-id="bba56-176">Literal IPv6 addresses work if the service and client are on different machines.</span></span>  
  
## <a name="wsdl-retrieval-failures-with-federated-trust"></a><span data-ttu-id="bba56-177">Échecs de récupération WSDL avec approbation fédérée</span><span class="sxs-lookup"><span data-stu-id="bba56-177">WSDL Retrieval Failures with Federated Trust</span></span>  
 <span data-ttu-id="bba56-178">WCF nécessite exactement un document WSDL pour chaque nœud dans la chaîne d’approbation fédérée.</span><span class="sxs-lookup"><span data-stu-id="bba56-178">WCF requires exactly one WSDL document for each node in the federated trust chain.</span></span> <span data-ttu-id="bba56-179">Veillez à ne pas définir de boucle lors de la spécification des points de terminaison.</span><span class="sxs-lookup"><span data-stu-id="bba56-179">Be careful not to set up a loop when specifying endpoints.</span></span> <span data-ttu-id="bba56-180">Des boucles peuvent résulter de l'utilisation d'un téléchargement WSDL de chaînes d'approbation fédérée avec au moins deux liens dans le même document WSDL.</span><span class="sxs-lookup"><span data-stu-id="bba56-180">One way in which loops can arise is using a WSDL download of federated trust chains with two or more links in the same WSDL document.</span></span> <span data-ttu-id="bba56-181">Un scénario courant pouvant induire ce problème est un service fédéré où le serveur de jeton de sécurité et le service sont contenus dans le même ServiceHost.</span><span class="sxs-lookup"><span data-stu-id="bba56-181">A common scenario that can produce this problem is a federated service where the Security Token Server and the service are contained inside the same ServiceHost.</span></span>  
  
 <span data-ttu-id="bba56-182">Un service comportant les trois adresses de point de terminaison suivantes est un exemple illustrant cette situation :</span><span class="sxs-lookup"><span data-stu-id="bba56-182">An example of this situation is a service with the following three endpoint addresses:</span></span>  
  
-   <span data-ttu-id="bba56-183">http://localhost/CalculatorService/service (le service)</span><span class="sxs-lookup"><span data-stu-id="bba56-183">http://localhost/CalculatorService/service (the service)</span></span>  
  
-   <span data-ttu-id="bba56-184">http://localhost/CalculatorService/issue_ticket (STS)</span><span class="sxs-lookup"><span data-stu-id="bba56-184">http://localhost/CalculatorService/issue_ticket (the STS)</span></span>  
  
-   <span data-ttu-id="bba56-185">http://localhost/CalculatorService/mex (le point de terminaison de métadonnées)</span><span class="sxs-lookup"><span data-stu-id="bba56-185">http://localhost/CalculatorService/mex (the metadata endpoint)</span></span>  
  
 <span data-ttu-id="bba56-186">Ce scénario lève une exception.</span><span class="sxs-lookup"><span data-stu-id="bba56-186">This throws an exception.</span></span>  
  
 <span data-ttu-id="bba56-187">Pour qu'il fonctionne, vous pouvez placer le point de terminaison `issue_ticket` ailleurs.</span><span class="sxs-lookup"><span data-stu-id="bba56-187">You can make this scenario work by putting the `issue_ticket` endpoint elsewhere.</span></span>  
  
## <a name="wsdl-import-attributes-can-be-lost"></a><span data-ttu-id="bba56-188">Risques de perte des attributs d'importation WSDL</span><span class="sxs-lookup"><span data-stu-id="bba56-188">WSDL Import Attributes can be Lost</span></span>  
 <span data-ttu-id="bba56-189">WCF perd la trace des attributs sur un élément `<wst:Claims>` dans un modèle `RST` lors de l'exécution d'une importation WSDL.</span><span class="sxs-lookup"><span data-stu-id="bba56-189">WCF loses track of the attributes on a `<wst:Claims>` element in an `RST` template when doing a WSDL import.</span></span> <span data-ttu-id="bba56-190">Cela se produit pendant une importation WSDL si vous spécifiez directement `<Claims>` dans `WSFederationHttpBinding.Security.Message.TokenRequestParameters` ou `IssuedSecurityTokenRequestParameters.AdditionalRequestParameters` au lieu d'utiliser directement les collections de types de revendication.</span><span class="sxs-lookup"><span data-stu-id="bba56-190">This happens during a WSDL import if you specify `<Claims>` directly in `WSFederationHttpBinding.Security.Message.TokenRequestParameters` or `IssuedSecurityTokenRequestParameters.AdditionalRequestParameters` instead of using the claim type collections directly.</span></span>  <span data-ttu-id="bba56-191">Puisque l’importation perd les attributs, la liaison ne fait pas l’aller-retour correctement dans WSDL et est donc incorrecte du côté client.</span><span class="sxs-lookup"><span data-stu-id="bba56-191">Since the import loses the attributes, the binding does not round trip properly through WSDL and hence is incorrect on the client side.</span></span>  
  
 <span data-ttu-id="bba56-192">pour corriger cette situation, il convient de modifier directement la liaison sur le client après l’importation.</span><span class="sxs-lookup"><span data-stu-id="bba56-192">The fix is to modify the binding directly on the client after doing the import.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="bba56-193">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="bba56-193">See Also</span></span>  
 [<span data-ttu-id="bba56-194">Considérations relatives à la sécurité</span><span class="sxs-lookup"><span data-stu-id="bba56-194">Security Considerations</span></span>](../../../../docs/framework/wcf/feature-details/security-considerations-in-wcf.md)  
 [<span data-ttu-id="bba56-195">Divulgation d’informations</span><span class="sxs-lookup"><span data-stu-id="bba56-195">Information Disclosure</span></span>](../../../../docs/framework/wcf/feature-details/information-disclosure.md)  
 [<span data-ttu-id="bba56-196">Élévation de privilèges</span><span class="sxs-lookup"><span data-stu-id="bba56-196">Elevation of Privilege</span></span>](../../../../docs/framework/wcf/feature-details/elevation-of-privilege.md)  
 [<span data-ttu-id="bba56-197">Déni de service</span><span class="sxs-lookup"><span data-stu-id="bba56-197">Denial of Service</span></span>](../../../../docs/framework/wcf/feature-details/denial-of-service.md)  
 [<span data-ttu-id="bba56-198">Falsification</span><span class="sxs-lookup"><span data-stu-id="bba56-198">Tampering</span></span>](../../../../docs/framework/wcf/feature-details/tampering.md)  
 [<span data-ttu-id="bba56-199">Attaques par relecture</span><span class="sxs-lookup"><span data-stu-id="bba56-199">Replay Attacks</span></span>](../../../../docs/framework/wcf/feature-details/replay-attacks.md)
