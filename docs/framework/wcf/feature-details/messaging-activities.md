---
title: Activités de messagerie - WCF
ms.date: 03/30/2017
ms.assetid: 8498f215-1823-4aba-a6e1-391407f8c273
ms.openlocfilehash: 7670a6694e15f0a9e25152102d6237ef1ed60941
ms.sourcegitcommit: 14355b4b2fe5bcf874cac96d0a9e6376b567e4c7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/30/2019
ms.locfileid: "55255255"
---
# <a name="messaging-activities"></a><span data-ttu-id="5ef0f-102">Activités de messagerie</span><span class="sxs-lookup"><span data-stu-id="5ef0f-102">Messaging activities</span></span>

<span data-ttu-id="5ef0f-103">Les activités de messagerie permettent aux workflows d'envoyer et de recevoir des messages WCF.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-103">Messaging activities allow workflows to send and receive WCF messages.</span></span> <span data-ttu-id="5ef0f-104">En ajoutant des activités de messagerie à un workflow, vous pouvez modéliser n’importe quel modèle d’échange de messages (MEP) arbitrairement complexe.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-104">By adding messaging activities to a workflow you can model any arbitrarily complex message exchange patterns (MEP).</span></span>

## <a name="message-exchange-patterns"></a><span data-ttu-id="5ef0f-105">Modèles d’échange de message</span><span class="sxs-lookup"><span data-stu-id="5ef0f-105">Message exchange patterns</span></span>

<span data-ttu-id="5ef0f-106">Il existe trois modèles d’échange de messages de base :</span><span class="sxs-lookup"><span data-stu-id="5ef0f-106">There are three basic message exchange patterns:</span></span>

- <span data-ttu-id="5ef0f-107">**Datagramme** : lors de l’utilisation du datagramme MEP le client envoie un message au service, mais le service ne répond pas.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-107">**Datagram** - When using the datagram MEP the client sends a message to the service, but the service does not respond.</span></span> <span data-ttu-id="5ef0f-108">Cet échange est parfois appelé « fire and forget ».</span><span class="sxs-lookup"><span data-stu-id="5ef0f-108">This is sometimes called "fire and forget".</span></span> <span data-ttu-id="5ef0f-109">Un échange de ce type requiert une confirmation hors bande de la réussite de la remise.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-109">A fire and forget exchange is one that requires out-of-band confirmation of successful delivery.</span></span> <span data-ttu-id="5ef0f-110">Le message peut être perdu lors de la transmission et ne jamais atteindre le service.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-110">The message might be lost in transit and never reach the service.</span></span> <span data-ttu-id="5ef0f-111">Si le client envoie un message avec succès, cela ne garantit pas que le service a reçu le message.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-111">If the client successfully sends a message, it does not guarantee that the service has received the message.</span></span> <span data-ttu-id="5ef0f-112">Le datagramme est un bloc de construction de messagerie fondamental. Vous pouvez en effet générer vos propres MEP au-dessus de ce bloc.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-112">The datagram is a fundamental building block for messaging, as you can build your own MEPs on top of it.</span></span>

- <span data-ttu-id="5ef0f-113">**Requête-réponse** : quand à l’aide du MEP demande-réponse le client envoie un message au service, le service effectue le traitement requis, puis renvoie une réponse au client.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-113">**Request-Response** - When using the request-response MEP the client sends a message to the service, the service does the required processing, and then sends a response back to the client.</span></span> <span data-ttu-id="5ef0f-114">Ce modèle se compose de paires demande-réponse.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-114">The pattern consists of request-response pairs.</span></span> <span data-ttu-id="5ef0f-115">Parmi les exemples d'appels demande-réponse figurent notamment les appels de procédure distante (RPC) et les demandes GET de navigateur.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-115">Examples of request-response calls are remote procedure calls (RPC) and browser GET requests.</span></span> <span data-ttu-id="5ef0f-116">Ce modèle est également connu sous le nom de mode semi-duplex.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-116">This pattern is also known as half-duplex.</span></span>

- <span data-ttu-id="5ef0f-117">**Duplex** : lorsque vous en utilisant le MEP le client et un service duplex peut envoyer des messages entre eux dans n’importe quel ordre.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-117">**Duplex** - When using the duplex MEP the client and service can send messages to each other in any order.</span></span> <span data-ttu-id="5ef0f-118">Le MEP duplex est similaire à une conversation téléphonique, où chaque mot prononcé correspond à un message.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-118">The duplex MEP is like a phone conversation, where each word being spoken is a message.</span></span>

<span data-ttu-id="5ef0f-119">Les activités de messagerie vous permettent d'implémenter chacun de ces MEP de base ainsi qu'un MEP arbitrairement complexe.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-119">The messaging activities allow you to implement any of these basic MEPs as well as any arbitrarily complex MEP.</span></span>

## <a name="messaging-activities"></a><span data-ttu-id="5ef0f-120">Activités de messagerie</span><span class="sxs-lookup"><span data-stu-id="5ef0f-120">Messaging activities</span></span>

<span data-ttu-id="5ef0f-121">Le [!INCLUDE[netfx_current_long](../../../../includes/netfx-current-long-md.md)] définit les activités de messagerie suivantes :</span><span class="sxs-lookup"><span data-stu-id="5ef0f-121">The [!INCLUDE[netfx_current_long](../../../../includes/netfx-current-long-md.md)] defines the following messaging activities:</span></span>

- <span data-ttu-id="5ef0f-122"><xref:System.ServiceModel.Activities.Send> : utilise l'activité <xref:System.ServiceModel.Activities.Send> pour envoyer un message.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-122"><xref:System.ServiceModel.Activities.Send>- Use the <xref:System.ServiceModel.Activities.Send> activity to send a message.</span></span>

- <span data-ttu-id="5ef0f-123"><xref:System.ServiceModel.Activities.SendReply> : utilise l'activité <xref:System.ServiceModel.Activities.SendReply> pour envoyer une réponse à un message reçu.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-123"><xref:System.ServiceModel.Activities.SendReply> - Use the <xref:System.ServiceModel.Activities.SendReply> activity to send a response to a received message.</span></span> <span data-ttu-id="5ef0f-124">Cette activité est utilisée par les services de workflow lors de l'implémentation d'un MEP demande/réponse.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-124">This activity is used by workflow services when implementing a request/reply MEP.</span></span>

- <span data-ttu-id="5ef0f-125"><xref:System.ServiceModel.Activities.Receive> : utilise l'activité <xref:System.ServiceModel.Activities.Receive> pour recevoir un message.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-125"><xref:System.ServiceModel.Activities.Receive>- Use the <xref:System.ServiceModel.Activities.Receive> activity to receive a message.</span></span>

- <span data-ttu-id="5ef0f-126"><xref:System.ServiceModel.Activities.ReceiveReply> : utilise l'activité <xref:System.ServiceModel.Activities.ReceiveReply> pour recevoir un message de réponse.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-126"><xref:System.ServiceModel.Activities.ReceiveReply> - Use the <xref:System.ServiceModel.Activities.ReceiveReply> activity to receive a reply message.</span></span> <span data-ttu-id="5ef0f-127">Cette activité est utilisée par les clients du service de workflow lors de l'implémentation d'un MEP demande/réponse.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-127">This activity is used by workflow service clients when implementing a request/reply MEP.</span></span>

## <a name="messaging-activities-and-message-exchange-patterns"></a><span data-ttu-id="5ef0f-128">Activités de messagerie et des modèles d’échange de message</span><span class="sxs-lookup"><span data-stu-id="5ef0f-128">Messaging activities and message exchange patterns</span></span>

<span data-ttu-id="5ef0f-129">Un MEP datagramme implique un client qui envoie un message et un service qui reçoit le message.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-129">A datagram MEP involves a client sending a message and a service receiving the message.</span></span> <span data-ttu-id="5ef0f-130">Si le client est un workflow, utilisez une activité <xref:System.ServiceModel.Activities.Send> pour envoyer le message.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-130">If the client is a workflow use a <xref:System.ServiceModel.Activities.Send> activity to send the message.</span></span> <span data-ttu-id="5ef0f-131">Pour recevoir ce message dans un workflow, utilisez une activité <xref:System.ServiceModel.Activities.Receive>.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-131">To receive that message in a workflow, use a <xref:System.ServiceModel.Activities.Receive> activity.</span></span> <span data-ttu-id="5ef0f-132">Les activités <xref:System.ServiceModel.Activities.Send> et <xref:System.ServiceModel.Activities.Receive> ont chacune une propriété nommée `Content`.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-132">The <xref:System.ServiceModel.Activities.Send> and <xref:System.ServiceModel.Activities.Receive> activities each have a property named `Content`.</span></span> <span data-ttu-id="5ef0f-133">Cette propriété contient les données qui sont envoyées ou reçues.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-133">This property contains the data being sent or received.</span></span> <span data-ttu-id="5ef0f-134">Lors de l'implémentation du MEP demande-réponse, le client et le service utilisent tous les deux des paires d'activités.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-134">When implementing the request-response MEP both the client and the service use pairs of activities.</span></span> <span data-ttu-id="5ef0f-135">Le client utilise une activité <xref:System.ServiceModel.Activities.Send> pour envoyer le message et une activité <xref:System.ServiceModel.Activities.ReceiveReply> pour recevoir la réponse du service.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-135">The client uses a <xref:System.ServiceModel.Activities.Send> activity to send the message and a <xref:System.ServiceModel.Activities.ReceiveReply> activity to receive the response from the service.</span></span> <span data-ttu-id="5ef0f-136">Ces deux activités sont associées l'une à l'autre par la propriété <xref:System.ServiceModel.Activities.ReceiveReply.Request%2A>.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-136">These two activities are associated with each other by the <xref:System.ServiceModel.Activities.ReceiveReply.Request%2A> property.</span></span> <span data-ttu-id="5ef0f-137">Cette propriété est définie sur l'activité <xref:System.ServiceModel.Activities.Send> qui a envoyé le message d'origine.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-137">This property is set to the <xref:System.ServiceModel.Activities.Send> activity that sent the original message.</span></span> <span data-ttu-id="5ef0f-138">Le service utilise également une paire d'activités associées : <xref:System.ServiceModel.Activities.Receive> et <xref:System.ServiceModel.Activities.SendReply>.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-138">The service also uses a pair of associated activities: <xref:System.ServiceModel.Activities.Receive> and <xref:System.ServiceModel.Activities.SendReply>.</span></span> <span data-ttu-id="5ef0f-139">Ces deux activités sont associées par la propriété <xref:System.ServiceModel.Activities.SendReply.Request%2A>.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-139">These two activities are associated by the <xref:System.ServiceModel.Activities.SendReply.Request%2A> property.</span></span> <span data-ttu-id="5ef0f-140">Cette propriété est définie sur l'activité <xref:System.ServiceModel.Activities.Receive> qui a reçu le message d'origine.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-140">This property is set to the <xref:System.ServiceModel.Activities.Receive> activity that received the original message.</span></span> <span data-ttu-id="5ef0f-141">Les activités <xref:System.ServiceModel.Activities.ReceiveReply> et <xref:System.ServiceModel.Activities.SendReply>, comme <xref:System.ServiceModel.Activities.Send> et <xref:System.ServiceModel.Activities.Receive> vous permettent d'envoyer une instance <xref:System.ServiceModel.Channels.Message> ou un type de contrat de message.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-141">The <xref:System.ServiceModel.Activities.ReceiveReply> and <xref:System.ServiceModel.Activities.SendReply> activities, like <xref:System.ServiceModel.Activities.Send> and <xref:System.ServiceModel.Activities.Receive> allow you to send a <xref:System.ServiceModel.Channels.Message> instance or a message contract type.</span></span>

<span data-ttu-id="5ef0f-142">En raison de la longue durée d'exécution des workflows, il est important que le modèle duplex de communication prenne également en charge des conversations de longue durée.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-142">Because of the long-running nature of workflows, it is important for the duplex pattern of communication to also support long-running conversations.</span></span> <span data-ttu-id="5ef0f-143">Pour prendre en charge des conversations de longue durée, les clients qui initialisent la conversation doivent donner au service la possibilité de le rappeler plus tard lorsque les données deviennent disponibles.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-143">To support long-running conversations, clients who initiate the conversation must provide the service with an opportunity to call it back at a later time when the data becomes available.</span></span> <span data-ttu-id="5ef0f-144">Par exemple, une demande de bon de commande est soumise à l'approbation du gestionnaire, mais elle risque de ne pas être traitée dans la journée, la semaine ou même l'année ; le workflow qui gère l'approbation du bon de commande doit le savoir pour continuer une fois l'approbation donnée.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-144">For example, a purchase order request is submitted for manager approval, but it might not be processed for a day, a week, or even a year; the workflow that manages the purchase order approval must know to resume after the approval is given.</span></span> <span data-ttu-id="5ef0f-145">Ce modèle de communication en duplex est pris en charge dans les workflows à l’aide de la corrélation.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-145">This pattern of duplex communication is supported in workflows using correlation.</span></span> <span data-ttu-id="5ef0f-146">Pour implémenter un modèle duplex, utilisez les activités <xref:System.ServiceModel.Activities.Send> et <xref:System.ServiceModel.Activities.Receive>.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-146">To implement a duplex pattern, use <xref:System.ServiceModel.Activities.Send> and <xref:System.ServiceModel.Activities.Receive> activities.</span></span> <span data-ttu-id="5ef0f-147">Sur le <xref:System.ServiceModel.Activities.Receive> activité, initialiser une corrélation à l’aide <xref:System.ServiceModel.Activities.CorrelationHandle>.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-147">On the <xref:System.ServiceModel.Activities.Receive> activity, initialize a correlation using <xref:System.ServiceModel.Activities.CorrelationHandle>.</span></span> <span data-ttu-id="5ef0f-148">Sur l'activité <xref:System.ServiceModel.Activities.Send>, définissez ce gestionnaire de corrélation comme valeur de la propriété <xref:System.ServiceModel.Activities.Send.CorrelatesWith%2A>.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-148">On the <xref:System.ServiceModel.Activities.Send> activity set that correlation handle as the <xref:System.ServiceModel.Activities.Send.CorrelatesWith%2A> property value.</span></span> <span data-ttu-id="5ef0f-149">Pour plus d’informations, consultez [Durable Duplex](durable-duplex-correlation.md).</span><span class="sxs-lookup"><span data-stu-id="5ef0f-149">For more information, see [Durable Duplex](durable-duplex-correlation.md).</span></span>

> [!NOTE]
> <span data-ttu-id="5ef0f-150">Implémentation du flux de travail d’un duplex à l’aide d’une corrélation de rappel (« Duplex Durable ») est conçue pour les conversations de longue.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-150">Workflow’s implementation of duplex using a callback correlation ("Durable Duplex") is intended for long-running conversations.</span></span> <span data-ttu-id="5ef0f-151">Ce n'est pas la même chose qu'un duplex WCF avec des contrats de rappel, où la conversation est de courte durée d'exécution (durée de vie du canal).</span><span class="sxs-lookup"><span data-stu-id="5ef0f-151">This is not the same as WCF duplex with callback contracts where the conversation is short-running (the lifetime of the channel).</span></span>

## <a name="message-formatting-and-messaging-activities"></a><span data-ttu-id="5ef0f-152">Mise en forme du message et les activités de messagerie</span><span class="sxs-lookup"><span data-stu-id="5ef0f-152">Message formatting and messaging activities</span></span>

<span data-ttu-id="5ef0f-153">Les activités <xref:System.ServiceModel.Activities.Receive> et <xref:System.ServiceModel.Activities.ReceiveReply> ont une propriété nommée `Content`.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-153">The <xref:System.ServiceModel.Activities.Receive> and <xref:System.ServiceModel.Activities.ReceiveReply> activities have a property named `Content`.</span></span> <span data-ttu-id="5ef0f-154">Cette propriété est de type <xref:System.ServiceModel.Activities.ReceiveContent> et représente les données que reçoit l'activité <xref:System.ServiceModel.Activities.Receive> ou <xref:System.ServiceModel.Activities.ReceiveReply>.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-154">This property is of type <xref:System.ServiceModel.Activities.ReceiveContent> and represents data the <xref:System.ServiceModel.Activities.Receive> or <xref:System.ServiceModel.Activities.ReceiveReply> activity receives.</span></span> <span data-ttu-id="5ef0f-155">Le .NET Framework définit deux classes connexes nommées <xref:System.ServiceModel.Activities.ReceiveMessageContent> et <xref:System.ServiceModel.Activities.ReceiveParametersContent> qui sont toutes les deux dérivées de <xref:System.ServiceModel.Activities.ReceiveContent>.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-155">The .NET Framework defines two related classes called <xref:System.ServiceModel.Activities.ReceiveMessageContent> and <xref:System.ServiceModel.Activities.ReceiveParametersContent> both of which are derived from <xref:System.ServiceModel.Activities.ReceiveContent>.</span></span> <span data-ttu-id="5ef0f-156">Définissez la propriété <xref:System.ServiceModel.Activities.Receive> de l'activité <xref:System.ServiceModel.Activities.ReceiveReply> ou `Content` sur une instance de l'un de ces types pour recevoir des données dans un service de workflow.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-156">Set the <xref:System.ServiceModel.Activities.Receive> or <xref:System.ServiceModel.Activities.ReceiveReply> activity’s `Content` property to an instance of one of these types to receive data into a workflow service.</span></span> <span data-ttu-id="5ef0f-157">Le type à utiliser dépend du type des données que l'activité reçoit.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-157">The type to use depends upon the type of data the activity receives.</span></span> <span data-ttu-id="5ef0f-158">Si l'activité reçoit un objet `Message` ou un type de contrat de message, utilisez <xref:System.ServiceModel.Activities.ReceiveMessageContent>.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-158">If the activity receives a `Message` object or a message contract type, use <xref:System.ServiceModel.Activities.ReceiveMessageContent>.</span></span> <span data-ttu-id="5ef0f-159">Si l'activité accepte un jeu de contrats de données ou de types XML qui peut être sérialisé, utilisez <xref:System.ServiceModel.Activities.ReceiveParametersContent>.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-159">If the activity receives a set of data contract or XML types that can be serialized, use <xref:System.ServiceModel.Activities.ReceiveParametersContent>.</span></span> <span data-ttu-id="5ef0f-160"><xref:System.ServiceModel.Activities.ReceiveParametersContent> vous permet d'envoyer plusieurs paramètres, alors que <xref:System.ServiceModel.Activities.ReceiveMessageContent> vous permet uniquement d'envoyer un objet, le message (ou le type de contrat de message).</span><span class="sxs-lookup"><span data-stu-id="5ef0f-160"><xref:System.ServiceModel.Activities.ReceiveParametersContent> allows you to send multiple parameters, whereas <xref:System.ServiceModel.Activities.ReceiveMessageContent> only allows you to send one object, the message (or message contract type).</span></span>

> [!NOTE]
> <span data-ttu-id="5ef0f-161"><xref:System.ServiceModel.Activities.ReceiveMessageContent> peut également être utilisé avec un contrat de données ou un type XML unique qui peut être sérialisé.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-161"><xref:System.ServiceModel.Activities.ReceiveMessageContent> can also be used with a single data contract or XML type that can be serialized.</span></span> <span data-ttu-id="5ef0f-162">La différence entre utiliser <xref:System.ServiceModel.Activities.ReceiveParametersContent> avec un paramètre unique et l'objet transmis directement à <xref:System.ServiceModel.Activities.ReceiveMessageContent> est le format de câble.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-162">The difference between using <xref:System.ServiceModel.Activities.ReceiveParametersContent> with a single parameter and the object passed directly to <xref:System.ServiceModel.Activities.ReceiveMessageContent> is the wire-format.</span></span> <span data-ttu-id="5ef0f-163">Le contenu du paramètre est encapsulé dans un élément XML correspondant au nom de l'opération et l'objet sérialisé est encapsulé dans un élément XML à l'aide du nom de paramètre (par exemple, `<Echo><msg>Hello, World</msg></Echo>`).</span><span class="sxs-lookup"><span data-stu-id="5ef0f-163">The parameter’s content is wrapped in an XML element that corresponds to the operation name and the serialized object is wrapped in an XML element using the parameter name (for example, `<Echo><msg>Hello, World</msg></Echo>`).</span></span> <span data-ttu-id="5ef0f-164">Le contenu du message n'est pas encapsulé par le nom de l'opération.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-164">The message content is not wrapped by the operation name.</span></span> <span data-ttu-id="5ef0f-165">L'objet sérialisé est en revanche placé dans un élément XML à l'aide du nom de type qualifié XML (par exemple, `<string>Hello, World</string>`).</span><span class="sxs-lookup"><span data-stu-id="5ef0f-165">Instead, the serialized object is placed within an XML element using the XML-qualified type name (for example, `<string>Hello, World</string>`).</span></span>

<span data-ttu-id="5ef0f-166">Les activités <xref:System.ServiceModel.Activities.Send> et <xref:System.ServiceModel.Activities.SendReply> ont également une propriété nommée `Content`.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-166">The <xref:System.ServiceModel.Activities.Send> and <xref:System.ServiceModel.Activities.SendReply> activities also have a property named `Content`.</span></span> <span data-ttu-id="5ef0f-167">Cette propriété est de type <xref:System.ServiceModel.Activities.SendContent> et représente les données envoyées par l'activité <xref:System.ServiceModel.Activities.Send> ou <xref:System.ServiceModel.Activities.SendReply>.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-167">This property is of type <xref:System.ServiceModel.Activities.SendContent> and represents data the <xref:System.ServiceModel.Activities.Send> or <xref:System.ServiceModel.Activities.SendReply> activity sends.</span></span> <span data-ttu-id="5ef0f-168">Le .NET Framework définit deux types connexes nommés <xref:System.ServiceModel.Activities.SendMessageContent> et <xref:System.ServiceModel.Activities.SendParametersContent> qui sont tous les deux dérivés de <xref:System.ServiceModel.Activities.SendContent>.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-168">The .NET Framework defines two related types called <xref:System.ServiceModel.Activities.SendMessageContent> and <xref:System.ServiceModel.Activities.SendParametersContent> both of which are derived from <xref:System.ServiceModel.Activities.SendContent>.</span></span> <span data-ttu-id="5ef0f-169">Définissez la propriété <xref:System.ServiceModel.Activities.Send> de l'activité <xref:System.ServiceModel.Activities.SendReply> ou `Content` sur une instance de l'un de ces types pour envoyer des données à partir d'un service de workflow.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-169">Set the <xref:System.ServiceModel.Activities.Send> or <xref:System.ServiceModel.Activities.SendReply> activity’s `Content` property to an instance of one of these types to send data from a workflow service.</span></span> <span data-ttu-id="5ef0f-170">Le type à utiliser dépend du type de données que l'activité envoie.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-170">The type to use depends upon the type of data the activity sends.</span></span> <span data-ttu-id="5ef0f-171">Si l'activité envoie un objet `Message` ou un type de contrat de message, utilisez <xref:System.ServiceModel.Activities.SendMessageContent>.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-171">If the activity sends a `Message` object or a message contract type, use <xref:System.ServiceModel.Activities.SendMessageContent>.</span></span> <span data-ttu-id="5ef0f-172">Si l'activité envoie un type de contrat de données, utilisez <xref:System.ServiceModel.Activities.SendParametersContent>.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-172">If the activity sends a data contract type use <xref:System.ServiceModel.Activities.SendParametersContent>.</span></span> <span data-ttu-id="5ef0f-173"><xref:System.ServiceModel.Activities.SendParametersContent> vous permet d'envoyer plusieurs paramètres, alors que <xref:System.ServiceModel.Activities.SendMessageContent> vous permet uniquement d'envoyer un objet, le message (ou le type de contrat de message).</span><span class="sxs-lookup"><span data-stu-id="5ef0f-173"><xref:System.ServiceModel.Activities.SendParametersContent> allows you to send multiple parameters, whereas <xref:System.ServiceModel.Activities.SendMessageContent> only allows you to send one object, the message (or the message contract type).</span></span>

<span data-ttu-id="5ef0f-174">Lorsque vous programmez de façon impérative avec les activités de messagerie, vous utilisez les <xref:System.Activities.InArgument%601> et <xref:System.Activities.OutArgument%601> génériques pour encapsuler les objets que vous affectez au message ou les propriétés de paramètres des activités <xref:System.ServiceModel.Activities.Send>, <xref:System.ServiceModel.Activities.SendReply>, <xref:System.ServiceModel.Activities.Receive> et <xref:System.ServiceModel.Activities.ReceiveReply>.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-174">When programming imperatively with the messaging activities, you use the generic <xref:System.Activities.InArgument%601> and <xref:System.Activities.OutArgument%601> to wrap the objects you assign to the message or parameters properties of the <xref:System.ServiceModel.Activities.Send>, <xref:System.ServiceModel.Activities.SendReply>, <xref:System.ServiceModel.Activities.Receive>, and <xref:System.ServiceModel.Activities.ReceiveReply> activities.</span></span> <span data-ttu-id="5ef0f-175">Utilisez <xref:System.Activities.InArgument%601> pour le <xref:System.ServiceModel.Activities.Send> et <xref:System.ServiceModel.Activities.SendReply> activités et <xref:System.Activities.OutArgument%601> pour <xref:System.ServiceModel.Activities.Receive> et <xref:System.ServiceModel.Activities.ReceiveReply> activités.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-175">Use <xref:System.Activities.InArgument%601> for the <xref:System.ServiceModel.Activities.Send> and <xref:System.ServiceModel.Activities.SendReply> activities and <xref:System.Activities.OutArgument%601> for <xref:System.ServiceModel.Activities.Receive> and <xref:System.ServiceModel.Activities.ReceiveReply> activities.</span></span> <span data-ttu-id="5ef0f-176">Les arguments `In` sont utilisés avec les activités d'envoi, car les données sont passées dans les activités.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-176">`In` arguments are used with the send activities because the data is being passed into the activities.</span></span> <span data-ttu-id="5ef0f-177">Les arguments `Out` sont utilisés avec les activités d'envoi, car les données sont transmises dans les activités, comme indiqué dans l'exemple suivant.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-177">`Out` arguments are used with the receive activities because data is being passed out of the activities, as shown in the following example.</span></span>

```csharp
Receive reserveSeat = new Receive
{
    ...
    Content = new ReceiveParametersContent
    {
        Parameters =
        {
            { "ReservationInfo", new OutArgument<ReservationRequest>(reservationInfo) }
        }
    }
};
SendReply reserveSeat = new SendReply
{
    ...
    Request = reserveSeat,
    Content = new SendParametersContent
    {
        Parameters =
        {
            { "ReservationId", new InArgument<string>(reservationId) }
        }
    },
};
```

<span data-ttu-id="5ef0f-178">Lors de l'implémentation d'un service de workflow définissant une opération de demande/réponse qui retourne void, vous devez instancier une activité <xref:System.ServiceModel.Activities.SendReply> et définir la propriété <xref:System.ServiceModel.Activities.SendReply.Content%2A> sur une instance vide de l'un des types de contenu (<xref:System.ServiceModel.Activities.SendMessageContent> ou <xref:System.ServiceModel.Activities.SendParametersContent>), comme indiqué dans l'exemple suivant.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-178">When implementing a workflow service that defines a request/response operation that returns void, you must instantiate a <xref:System.ServiceModel.Activities.SendReply> activity and set the <xref:System.ServiceModel.Activities.SendReply.Content%2A> property to an empty instance of one of the content types (<xref:System.ServiceModel.Activities.SendMessageContent> or <xref:System.ServiceModel.Activities.SendParametersContent>) as shown in the following example.</span></span>

```csharp
Receive rcv = new Receive()
{
ServiceContractName = "IService",
OperationName = "NullReturningContract",
Content = new ReceiveParametersContent( new Dictionary<string, OutArgument>() { { "message", new OutArgument<string>() } } )
};
SendReply sr = new SendReply()
{
Request = rcv
   Content = new SendParametersContent();
};
```

## <a name="add-service-reference"></a><span data-ttu-id="5ef0f-179">Ajouter une référence de service</span><span class="sxs-lookup"><span data-stu-id="5ef0f-179">Add service reference</span></span>

<span data-ttu-id="5ef0f-180">Lorsque vous appelez un service de workflow à partir d’une application de workflow, Visual Studio 2012 génère des activités de messagerie personnalisées qui encapsulent les <xref:System.ServiceModel.Activities.Send> et <xref:System.ServiceModel.Activities.ReceiveReply> activités utilisées dans un MEP demande/réponse.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-180">When calling a workflow service from a workflow application, Visual Studio 2012 generates custom messaging activities that encapsulate the usual <xref:System.ServiceModel.Activities.Send> and <xref:System.ServiceModel.Activities.ReceiveReply> activities used in a request/reply MEP.</span></span> <span data-ttu-id="5ef0f-181">Pour utiliser cette fonctionnalité, cliquez sur le projet client dans Visual Studio et sélectionnez **ajouter** > **une référence de Service**.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-181">To use this feature, right-click the client project in Visual Studio and select **Add** > **Service Reference**.</span></span> <span data-ttu-id="5ef0f-182">Tapez l'adresse de base du service dans la zone d'adresse et cliquez sur OK.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-182">Type the base address of the service in the address box and click Go.</span></span> <span data-ttu-id="5ef0f-183">Les services disponibles sont affichés dans le **Services :** boîte.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-183">The available services are displayed in the **Services:** box.</span></span> <span data-ttu-id="5ef0f-184">Développez le nœud du service pour afficher les contrats pris en charge.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-184">Expand the service node to display the contracts supported.</span></span> <span data-ttu-id="5ef0f-185">Sélectionnez le contrat que vous souhaitez appeler et la liste des opérations disponibles s’affiche dans le **opérations** boîte.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-185">Select the contract you want to call and the list of available operations is displayed in the **Operations** box.</span></span> <span data-ttu-id="5ef0f-186">Vous pouvez spécifier l’espace de noms pour l’activité générée, puis cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-186">You can then specify the namespace for the generated activity and click **OK**.</span></span> <span data-ttu-id="5ef0f-187">Un dialogue s'affiche indiquant que l'opération s'est achevée avec succès et que les activités personnalisées générées se trouveront dans la boîte à outils une fois le projet reconstruit.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-187">You then see a dialog that says the operation completed successfully and that the generated custom activities are in the toolbox after you have rebuilt the project.</span></span> <span data-ttu-id="5ef0f-188">Il existe une activité pour chaque opération définie sur le contrat de service.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-188">There is one activity for each operation defined on the service contract.</span></span> <span data-ttu-id="5ef0f-189">Après avoir reconstruit le projet, vous pouvez faire glisser et déposer les activités personnalisées sur votre workflow et définir les propriétés nécessaires dans la fenêtre de propriétés.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-189">After rebuilding the project you can drag and drop the custom activities onto your workflow and set any required properties in the properties window.</span></span>

## <a name="messaging-activity-templates"></a><span data-ttu-id="5ef0f-190">Modèles d’activité de messagerie</span><span class="sxs-lookup"><span data-stu-id="5ef0f-190">Messaging activity templates</span></span>

<span data-ttu-id="5ef0f-191">Pour faciliter la configuration d’un MEP demande/réponse sur le client et le service, Visual Studio 2012 propose deux modèles d’activité messagerie.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-191">To make setting up a request/response MEP on the client and service easier, Visual Studio 2012 provides two messaging activity templates.</span></span> <span data-ttu-id="5ef0f-192">`System.ServiceModel.Activities.Design.ReceiveAndSendReply` est utilisé sur le service et `System.ServiceModel.Activities.Design.SendAndReceiveReply` est utilisé sur le client.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-192">`System.ServiceModel.Activities.Design.ReceiveAndSendReply` is used on the service and `System.ServiceModel.Activities.Design.SendAndReceiveReply` is used on the client.</span></span> <span data-ttu-id="5ef0f-193">Dans les deux cas, les modèles ajoutent les activités de messagerie appropriées à votre workflow.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-193">In both cases the templates add the appropriate messaging activities to your workflow.</span></span> <span data-ttu-id="5ef0f-194">Sur le service, le modèle `System.ServiceModel.Activities.Design.ReceiveAndSendReply` ajoute une activité <xref:System.ServiceModel.Activities.Receive> suivie d'une activité <xref:System.ServiceModel.Activities.SendReply>.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-194">On the service, the `System.ServiceModel.Activities.Design.ReceiveAndSendReply` adds a <xref:System.ServiceModel.Activities.Receive> activity followed by a <xref:System.ServiceModel.Activities.SendReply> activity.</span></span> <span data-ttu-id="5ef0f-195">La propriété <xref:System.ServiceModel.Activities.SendReply.Request> est automatiquement définie sur l'activité <xref:System.ServiceModel.Activities.Receive>.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-195">The <xref:System.ServiceModel.Activities.SendReply.Request> property is automatically set to the <xref:System.ServiceModel.Activities.Receive> activity.</span></span> <span data-ttu-id="5ef0f-196">Sur le client, le modèle `System.ServiceModel.Activities.Design.SendAndReceiveReply` ajoute une activité <xref:System.ServiceModel.Activities.Send> suivie d'une activité <xref:System.ServiceModel.Activities.ReceiveReply>.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-196">On the client, the `System.ServiceModel.Activities.Design.SendAndReceiveReply` adds a <xref:System.ServiceModel.Activities.Send> activity followed by a <xref:System.ServiceModel.Activities.ReceiveReply>.</span></span> <span data-ttu-id="5ef0f-197">La propriété <xref:System.ServiceModel.Activities.ReceiveReply.Request%2A> est automatiquement définie sur l'activité <xref:System.ServiceModel.Activities.Send>.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-197">The <xref:System.ServiceModel.Activities.ReceiveReply.Request%2A> property is automatically set to the <xref:System.ServiceModel.Activities.Send> activity.</span></span> <span data-ttu-id="5ef0f-198">Pour utiliser ces modèles, il suffit de glisser-déposer le modèle approprié sur votre workflow.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-198">To use these templates, just drag and drop the appropriate template onto your workflow.</span></span>

## <a name="messaging-activities-and-transactions"></a><span data-ttu-id="5ef0f-199">Transactions et les activités de messagerie</span><span class="sxs-lookup"><span data-stu-id="5ef0f-199">Messaging activities and transactions</span></span>

<span data-ttu-id="5ef0f-200">Lorsqu’un appel est effectué à un service de workflow, vous pouvez souhaiter transmettre une transaction à l’opération de service.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-200">When a call is made to a workflow service you may want to flow a transaction to the service operation.</span></span> <span data-ttu-id="5ef0f-201">Pour cela, placez l'activité <xref:System.ServiceModel.Activities.Receive> dans une activité <xref:System.ServiceModel.Activities.TransactedReceiveScope>.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-201">To do this place the <xref:System.ServiceModel.Activities.Receive> activity within a <xref:System.ServiceModel.Activities.TransactedReceiveScope> activity.</span></span> <span data-ttu-id="5ef0f-202">L'activité <xref:System.ServiceModel.Activities.TransactedReceiveScope> contient une activité `Receive` et un corps.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-202">The <xref:System.ServiceModel.Activities.TransactedReceiveScope> activity contains a `Receive` activity and a body.</span></span> <span data-ttu-id="5ef0f-203">La transaction transmise au service reste ambiante pendant l'exécution du corps de l'activité <xref:System.ServiceModel.Activities.TransactedReceiveScope>.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-203">The transaction flowed to the service remains ambient throughout the execution of the body of the <xref:System.ServiceModel.Activities.TransactedReceiveScope>.</span></span> <span data-ttu-id="5ef0f-204">La transaction se termine une fois l’exécution du corps terminée.</span><span class="sxs-lookup"><span data-stu-id="5ef0f-204">The transaction is completed when the body finishes executing.</span></span> <span data-ttu-id="5ef0f-205">Pour plus d’informations sur les workflows et les transactions, consultez [Transactions de Workflow](../../../../docs/framework/windows-workflow-foundation/workflow-transactions.md).</span><span class="sxs-lookup"><span data-stu-id="5ef0f-205">For more information about workflows and transactions see [Workflow Transactions](../../../../docs/framework/windows-workflow-foundation/workflow-transactions.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="5ef0f-206">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="5ef0f-206">See also</span></span>

- [<span data-ttu-id="5ef0f-207">Comment envoyer et recevoir des erreurs dans les Services de flux de travail</span><span class="sxs-lookup"><span data-stu-id="5ef0f-207">How to Send and Receive Faults in Workflow Services</span></span>](https://go.microsoft.com/fwlink/?LinkId=189151)
- [<span data-ttu-id="5ef0f-208">Création d’un service de workflow de longue durée</span><span class="sxs-lookup"><span data-stu-id="5ef0f-208">Creating a Long-running Workflow Service</span></span>](creating-a-long-running-workflow-service.md)
