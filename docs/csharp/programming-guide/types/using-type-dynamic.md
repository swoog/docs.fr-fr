---
title: Utilisation du type dynamic (Guide de programmation C#)
ms.date: 07/20/2015
helpviewer_keywords:
- dynamic [C#], about dynamic type
- dynamic type [C#]
ms.assetid: 3828989d-c967-4a51-b948-857ebc8fdf26
ms.openlocfilehash: b1ea9240da66b77723c002c6527135339af9e352
ms.sourcegitcommit: 2eceb05f1a5bb261291a1f6a91c5153727ac1c19
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/04/2018
ms.locfileid: "43502531"
---
# <a name="using-type-dynamic-c-programming-guide"></a><span data-ttu-id="6d113-102">Utilisation du type dynamic (Guide de programmation C#)</span><span class="sxs-lookup"><span data-stu-id="6d113-102">Using type dynamic (C# Programming Guide)</span></span>

[!INCLUDE[csharp_dev10_long](~/includes/csharp-dev10-long-md.md)] <span data-ttu-id="6d113-103">introduit un nouveau type, appelé `dynamic`.</span><span class="sxs-lookup"><span data-stu-id="6d113-103"> introduces a new type, `dynamic\`.</span></span> <span data-ttu-id="6d113-104">Il s’agit d’un type statique ; toutefois, un objet de type `dynamic` ignore la vérification des types statiques.</span><span class="sxs-lookup"><span data-stu-id="6d113-104">The type is a static type, but an object of type `dynamic` bypasses static type checking.</span></span> <span data-ttu-id="6d113-105">Dans la plupart des cas, il fonctionne comme s’il était de type `object`.</span><span class="sxs-lookup"><span data-stu-id="6d113-105">In most cases, it functions like it has type `object`.</span></span> <span data-ttu-id="6d113-106">Au moment de la compilation, un élément de type `dynamic` est supposé prendre en charge n’importe quelle opération.</span><span class="sxs-lookup"><span data-stu-id="6d113-106">At compile time, an element that is typed as `dynamic` is assumed to support any operation.</span></span> <span data-ttu-id="6d113-107">Par conséquent, vous n’avez pas besoin de vous demander si l’objet obtient sa valeur d’une API COM, d’un langage dynamique tel qu’IronPython, du modèle DOM (Document Object Model) HTML, de la réflexion ou d’une autre partie du programme.</span><span class="sxs-lookup"><span data-stu-id="6d113-107">Therefore, you do not have to be concerned about whether the object gets its value from a COM API, from a dynamic language such as IronPython, from the HTML Document Object Model (DOM), from reflection, or from somewhere else in the program.</span></span> <span data-ttu-id="6d113-108">Toutefois, si le code n’est pas valide, des erreurs sont détectées au moment de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="6d113-108">However, if the code is not valid, errors are caught at run time.</span></span>

<span data-ttu-id="6d113-109">Par exemple, si la méthode d’instance `exampleMethod1` du code suivant ne comporte qu’un seul paramètre, le compilateur reconnaît que le premier appel à la méthode, `ec.exampleMethod1(10, 4)`, n’est pas valide car il contient deux arguments.</span><span class="sxs-lookup"><span data-stu-id="6d113-109">For example, if instance method `exampleMethod1` in the following code has only one parameter, the compiler recognizes that the first call to the method, `ec.exampleMethod1(10, 4)`, is not valid because it contains two arguments.</span></span> <span data-ttu-id="6d113-110">Cet appel entraîne une erreur du compilateur.</span><span class="sxs-lookup"><span data-stu-id="6d113-110">The call causes a compiler error.</span></span> <span data-ttu-id="6d113-111">Le deuxième appel à la méthode, `dynamic_ec.exampleMethod1(10, 4)`, n’est pas vérifié par le compilateur, car le type de `dynamic_ec` est `dynamic`.</span><span class="sxs-lookup"><span data-stu-id="6d113-111">The second call to the method, `dynamic_ec.exampleMethod1(10, 4)`, is not checked by the compiler because the type of `dynamic_ec` is `dynamic`.</span></span> <span data-ttu-id="6d113-112">Par conséquent, aucune erreur de compilateur n’est signalée.</span><span class="sxs-lookup"><span data-stu-id="6d113-112">Therefore, no compiler error is reported.</span></span> <span data-ttu-id="6d113-113">Toutefois, l’erreur ne passe pas indéfiniment inaperçue.</span><span class="sxs-lookup"><span data-stu-id="6d113-113">However, the error does not escape notice indefinitely.</span></span> <span data-ttu-id="6d113-114">Elle est détectée au moment de l’exécution et provoque une exception runtime.</span><span class="sxs-lookup"><span data-stu-id="6d113-114">It is caught at run time and causes a run-time exception.</span></span>

[!code-csharp[CsProgGuideTypes#50](~/samples/snippets/csharp/VS_Snippets_VBCSharp/CsProgGuideTypes/CS/usingdynamic.cs#50)]

[!code-csharp[CsProgGuideTypes#56](~/samples/snippets/csharp/VS_Snippets_VBCSharp/CsProgGuideTypes/CS/usingdynamic.cs#56)]

<span data-ttu-id="6d113-115">Dans ces exemples, le rôle du compilateur consiste à regrouper les informations relatives à l’opération que chaque instruction propose d’exécuter sur l’objet ou l’expression de type `dynamic`.</span><span class="sxs-lookup"><span data-stu-id="6d113-115">The role of the compiler in these examples is to package together information about what each statement is proposing to do to the object or expression that is typed as `dynamic`.</span></span> <span data-ttu-id="6d113-116">Au moment de l’exécution, les informations stockées sont examinées, et toute instruction non valide provoque une exception runtime.</span><span class="sxs-lookup"><span data-stu-id="6d113-116">At run time, the stored information is examined, and any statement that is not valid causes a run-time exception.</span></span>

<span data-ttu-id="6d113-117">Le résultat de la plupart des opérations dynamiques est lui-même de type `dynamic`.</span><span class="sxs-lookup"><span data-stu-id="6d113-117">The result of most dynamic operations is itself `dynamic`.</span></span> <span data-ttu-id="6d113-118">Par exemple, si vous placez le pointeur de la souris sur `testSum` dans l’exemple suivant, IntelliSense affiche le type **(variable locale) dynamic testSum**.</span><span class="sxs-lookup"><span data-stu-id="6d113-118">For example, if you rest the mouse pointer over the use of `testSum` in the following example, IntelliSense displays the type **(local variable) dynamic testSum**.</span></span>

[!code-csharp[CsProgGuideTypes#51](~/samples/snippets/csharp/VS_Snippets_VBCSharp/CsProgGuideTypes/CS/usingdynamic.cs#51)]

<span data-ttu-id="6d113-119">Les opérations dans lesquelles le résultat n’est pas `dynamic` incluent :</span><span class="sxs-lookup"><span data-stu-id="6d113-119">Operations in which the result is not `dynamic` include:</span></span>

* <span data-ttu-id="6d113-120">Les conversions de `dynamic` vers un autre type.</span><span class="sxs-lookup"><span data-stu-id="6d113-120">Conversions from `dynamic` to another type.</span></span>
* <span data-ttu-id="6d113-121">Les appels de constructeur qui incluent des arguments de type `dynamic`.</span><span class="sxs-lookup"><span data-stu-id="6d113-121">Constructor calls that include arguments of type `dynamic`.</span></span>

<span data-ttu-id="6d113-122">Par exemple, le type de `testInstance` dans la déclaration suivante est `ExampleClass`, et non pas `dynamic` :</span><span class="sxs-lookup"><span data-stu-id="6d113-122">For example, the type of `testInstance` in the following declaration is `ExampleClass`, not `dynamic`:</span></span>

[!code-csharp[CsProgGuideTypes#52](~/samples/snippets/csharp/VS_Snippets_VBCSharp/CsProgGuideTypes/CS/usingdynamic.cs#52)]

<span data-ttu-id="6d113-123">Des exemples de conversion sont présentés dans la section suivante, "Conversions".</span><span class="sxs-lookup"><span data-stu-id="6d113-123">Conversion examples are shown in the following section, "Conversions."</span></span>

## <a name="conversions"></a><span data-ttu-id="6d113-124">Conversions</span><span class="sxs-lookup"><span data-stu-id="6d113-124">Conversions</span></span>

<span data-ttu-id="6d113-125">Les conversions entre des objets dynamiques et d’autres types sont faciles à exécuter.</span><span class="sxs-lookup"><span data-stu-id="6d113-125">Conversions between dynamic objects and other types are easy.</span></span> <span data-ttu-id="6d113-126">Les développeurs peuvent ainsi passer du comportement dynamique au comportement non dynamique, et vice versa.</span><span class="sxs-lookup"><span data-stu-id="6d113-126">This enables the developer to switch between dynamic and non-dynamic behavior.</span></span>

<span data-ttu-id="6d113-127">Tout objet peut être converti implicitement en type dynamique, comme illustré dans les exemples suivants.</span><span class="sxs-lookup"><span data-stu-id="6d113-127">Any object can be converted to dynamic type implicitly, as shown in the following examples.</span></span>

[!code-csharp[CsProgGuideTypes#53](~/samples/snippets/csharp/VS_Snippets_VBCSharp/CsProgGuideTypes/CS/usingdynamic.cs#53)]

<span data-ttu-id="6d113-128">Inversement, une conversion implicite peut être appliquée de façon dynamique à toute expression de type `dynamic`.</span><span class="sxs-lookup"><span data-stu-id="6d113-128">Conversely, an implicit conversion can be dynamically applied to any expression of type `dynamic`.</span></span>

[!code-csharp[CsProgGuideTypes#54](~/samples/snippets/csharp/VS_Snippets_VBCSharp/CsProgGuideTypes/CS/usingdynamic.cs#54)]

## <a name="overload-resolution-with-arguments-of-type-dynamic"></a><span data-ttu-id="6d113-129">Résolution de surcharge avec des arguments de type dynamic</span><span class="sxs-lookup"><span data-stu-id="6d113-129">Overload resolution with arguments of type dynamic</span></span>

<span data-ttu-id="6d113-130">La résolution de surcharge a lieu au moment de l’exécution, et non pas au moment de la compilation, si un ou plusieurs arguments d’un appel de méthode sont de type `dynamic`, ou si le récepteur de l’appel de méthode est de type `dynamic`.</span><span class="sxs-lookup"><span data-stu-id="6d113-130">Overload resolution occurs at run time instead of at compile time if one or more of the arguments in a method call have the type `dynamic`, or if the receiver of the method call is of type `dynamic`.</span></span> <span data-ttu-id="6d113-131">Dans l’exemple suivant, si la seule méthode `exampleMethod2` accessible est définie pour accepter un argument de chaîne, l’envoi de `d1` en tant qu’argument n’entraîne pas d’erreur du compilateur, mais provoque une exception runtime.</span><span class="sxs-lookup"><span data-stu-id="6d113-131">In the following example, if the only accessible `exampleMethod2` method is defined to take a string argument, sending `d1` as the argument does not cause a compiler error, but it does cause a run-time exception.</span></span> <span data-ttu-id="6d113-132">La résolution de surcharge échoue au moment de l’exécution car le type de `d1` est `int`, et `exampleMethod2` exige une chaîne.</span><span class="sxs-lookup"><span data-stu-id="6d113-132">Overload resolution fails at run time because the run-time type of `d1` is `int`, and `exampleMethod2` requires a string.</span></span>

[!code-csharp[CsProgGuideTypes#55](~/samples/snippets/csharp/VS_Snippets_VBCSharp/CsProgGuideTypes/CS/usingdynamic.cs#55)]

## <a name="dynamic-language-runtime"></a><span data-ttu-id="6d113-133">Dynamic Language Runtime</span><span class="sxs-lookup"><span data-stu-id="6d113-133">Dynamic language runtime</span></span>

<span data-ttu-id="6d113-134">Le composant Dynamic Language Runtime (DLR) est une nouvelle API de [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)].</span><span class="sxs-lookup"><span data-stu-id="6d113-134">The dynamic language runtime (DLR) is a new API in [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)].</span></span> <span data-ttu-id="6d113-135">Il fournit l’infrastructure qui prend en charge le type `dynamic` en C#, ainsi que l’implémentation des langages de programmation dynamique tels qu’IronPython et IronRuby.</span><span class="sxs-lookup"><span data-stu-id="6d113-135">It provides the infrastructure that supports the `dynamic` type in C#, and also the implementation of dynamic programming languages such as IronPython and IronRuby.</span></span> <span data-ttu-id="6d113-136">Pour plus d’informations sur le DLR, consultez [Vue d’ensemble du Dynamic Language Runtime](../../../framework/reflection-and-codedom/dynamic-language-runtime-overview.md).</span><span class="sxs-lookup"><span data-stu-id="6d113-136">For more information about the DLR, see [Dynamic Language Runtime Overview](../../../framework/reflection-and-codedom/dynamic-language-runtime-overview.md).</span></span>

## <a name="com-interop"></a><span data-ttu-id="6d113-137">COM interop</span><span class="sxs-lookup"><span data-stu-id="6d113-137">COM interop</span></span>

[!INCLUDE[csharp_dev10_long](~/includes/csharp-dev10-long-md.md)] <span data-ttu-id="6d113-138">inclut plusieurs fonctionnalités qui améliorent l’interopérabilité avec les API COM telles que les API Office Automation.</span><span class="sxs-lookup"><span data-stu-id="6d113-138"> includes several features that improve the experience of interoperating with COM APIs such as the Office Automation APIs.</span></span> <span data-ttu-id="6d113-139">L’utilisation du type `dynamic` et des [arguments nommés et facultatifs](../classes-and-structs/named-and-optional-arguments.md) fait partie des améliorations offertes.</span><span class="sxs-lookup"><span data-stu-id="6d113-139">Among the improvements are the use of the `dynamic` type, and of [named and optional arguments](../classes-and-structs/named-and-optional-arguments.md).</span></span>

<span data-ttu-id="6d113-140">De nombreuses méthodes COM autorisent une variation des types d’arguments et du type de retour en désignant les types comme `object`.</span><span class="sxs-lookup"><span data-stu-id="6d113-140">Many COM methods allow for variation in argument types and return type by designating the types as `object`.</span></span> <span data-ttu-id="6d113-141">Cela a nécessité un cast explicite des valeurs pour la coordination avec les variables fortement typées en C#.</span><span class="sxs-lookup"><span data-stu-id="6d113-141">This has necessitated explicit casting of the values to coordinate with strongly typed variables in C#.</span></span> <span data-ttu-id="6d113-142">Si vous effectuez la compilation à l’aide de l’option [/link (Options du compilateur C#)](../../../csharp/language-reference/compiler-options/link-compiler-option.md), l’introduction du type `dynamic` vous permet de traiter les occurrences d’`object` dans les signatures COM comme si elles étaient de type `dynamic`, vous évitant ainsi une grande partie des opérations de cast.</span><span class="sxs-lookup"><span data-stu-id="6d113-142">If you compile by using the [/link (C# Compiler Options)](../../../csharp/language-reference/compiler-options/link-compiler-option.md) option, the introduction of the `dynamic` type enables you to treat the occurrences of `object` in COM signatures as if they were of type `dynamic`, and thereby to avoid much of the casting.</span></span> <span data-ttu-id="6d113-143">Par exemple, les instructions suivantes permettent de comparer la façon dont vous accédez à une cellule d’une feuille de calcul Microsoft Office Excel avec le type `dynamic` et sans le type `dynamic`.</span><span class="sxs-lookup"><span data-stu-id="6d113-143">For example, the following statements contrast how you access a cell in a Microsoft Office Excel spreadsheet with the `dynamic` type and without the `dynamic` type.</span></span>

[!code-csharp[csOfficeWalkthrough#12](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csofficewalkthrough/cs/thisaddin.cs#12)]

[!code-csharp[csOfficeWalkthrough#13](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csofficewalkthrough/cs/thisaddin.cs#13)]

## <a name="related-topics"></a><span data-ttu-id="6d113-144">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="6d113-144">Related topics</span></span>

|<span data-ttu-id="6d113-145">Titre</span><span class="sxs-lookup"><span data-stu-id="6d113-145">Title</span></span>|<span data-ttu-id="6d113-146">Description</span><span class="sxs-lookup"><span data-stu-id="6d113-146">Description</span></span>|
|-----------|-----------------|
|[<span data-ttu-id="6d113-147">dynamic</span><span class="sxs-lookup"><span data-stu-id="6d113-147">dynamic</span></span>](../../language-reference/keywords/dynamic.md)|<span data-ttu-id="6d113-148">Décrit l’utilisation du mot clé `dynamic`.</span><span class="sxs-lookup"><span data-stu-id="6d113-148">Describes the usage of the `dynamic` keyword.</span></span>|
|[<span data-ttu-id="6d113-149">Vue d’ensemble du Dynamic Language Runtime</span><span class="sxs-lookup"><span data-stu-id="6d113-149">Dynamic Language Runtime Overview</span></span>](../../../framework/reflection-and-codedom/dynamic-language-runtime-overview.md)|<span data-ttu-id="6d113-150">Fournit une vue d’ensemble du DLR, qui est un environnement d’exécution ajoutant au Common Language Runtime (CLR) un ensemble de services pour les langages dynamiques.</span><span class="sxs-lookup"><span data-stu-id="6d113-150">Provides an overview of the DLR, which is a runtime environment that adds a set of services for dynamic languages to the common language runtime (CLR).</span></span>|
|[<span data-ttu-id="6d113-151">Procédure pas à pas : création et utilisation d’objets dynamiques</span><span class="sxs-lookup"><span data-stu-id="6d113-151">Walkthrough: Creating and Using Dynamic Objects</span></span>](walkthrough-creating-and-using-dynamic-objects.md)|<span data-ttu-id="6d113-152">Fournit des instructions pas à pas pour la création d’un objet dynamique personnalisé et pour la création d’un projet qui accède à une bibliothèque `IronPython`.</span><span class="sxs-lookup"><span data-stu-id="6d113-152">Provides step-by-step instructions for creating a custom dynamic object and for creating a project that accesses an `IronPython` library.</span></span>|
|[<span data-ttu-id="6d113-153">Guide pratique pour accéder aux objets Office Interop à l’aide des fonctionnalités Visual C#</span><span class="sxs-lookup"><span data-stu-id="6d113-153">How to: Access Office Interop Objects by Using Visual C# Features</span></span>](../interop/how-to-access-office-onterop-objects.md)|<span data-ttu-id="6d113-154">Montre comment créer un projet qui utilise les arguments nommés et facultatifs, le type `dynamic` et d’autres améliorations qui simplifient l’accès aux objets d’API Office.</span><span class="sxs-lookup"><span data-stu-id="6d113-154">Demonstrates how to create a project that uses named and optional arguments, the `dynamic` type, and other enhancements that simplify access to Office API objects.</span></span>|