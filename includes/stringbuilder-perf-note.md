<span data-ttu-id="39fd1-101">L’utilisation de l’indexation basée sur des caractères avec la propriété <xref:System.Text.StringBuilder.Chars%2A> peut être très lente dans les conditions suivantes :</span><span class="sxs-lookup"><span data-stu-id="39fd1-101">Using character-based indexing with the <xref:System.Text.StringBuilder.Chars%2A> property can be extremely slow under the following conditions:</span></span>

- <span data-ttu-id="39fd1-102">L’instance de <xref:System.Text.StringBuilder> est grande (par exemple, elle est constituée de plusieurs dizaines de milliers de caractères).</span><span class="sxs-lookup"><span data-stu-id="39fd1-102">The <xref:System.Text.StringBuilder> instance is large (for example, it consists of several tens of thousands of characters).</span></span>
- <span data-ttu-id="39fd1-103"><xref:System.Text.StringBuilder> contient des grands blocs.</span><span class="sxs-lookup"><span data-stu-id="39fd1-103">The <xref:System.Text.StringBuilder> is "chunky."</span></span> <span data-ttu-id="39fd1-104">Autrement dit, des appels répétés à des méthodes comme <xref:System.Text.StringBuilder.Append%2A?displayProperty=nameWithType> ont développé automatiquement la propriété <xref:System.Text.StringBuilder.Capacity%2A?displayProperty=nameWithType> de l’objet et lui ont alloué de nouveaux blocs de mémoire.</span><span class="sxs-lookup"><span data-stu-id="39fd1-104">That is, repeated calls to methods such as <xref:System.Text.StringBuilder.Append%2A?displayProperty=nameWithType> have automatically expanded the object's <xref:System.Text.StringBuilder.Capacity%2A?displayProperty=nameWithType> property and allocated new chunks of memory to it.</span></span>

<span data-ttu-id="39fd1-105">Les performances sont gravement affectées, car chaque accès aux caractères doit parcourir toute la liste chaînée des blocs pour trouver la mémoire tampon correcte où indexer.</span><span class="sxs-lookup"><span data-stu-id="39fd1-105">Performance is severely impacted because each character access walks the entire linked list of chunks to find the correct buffer to index into.</span></span>

> [!NOTE]
>  <span data-ttu-id="39fd1-106">Même pour un grand objet <xref:System.Text.StringBuilder> avec des gros blocs, l’utilisation de la propriété <xref:System.Text.StringBuilder.Chars%2A> pour l’accès basé sur un index à un seul caractère ou à un petit nombre de caractères a un impact négligeable sur les performances ; en général, il s’agit d’une opération **0(n)**.</span><span class="sxs-lookup"><span data-stu-id="39fd1-106">Even for a large "chunky" <xref:System.Text.StringBuilder> object, using the <xref:System.Text.StringBuilder.Chars%2A> property for index-based access to one or a small number of characters has a negligible performance impact; typically, it is an **0(n)** operation.</span></span> <span data-ttu-id="39fd1-107">Un impact significatif sur les performances se produit par contre lors de l’itération dans les caractères contenus dans l’objet <xref:System.Text.StringBuilder>, qui est une opération **O(n^2)**.</span><span class="sxs-lookup"><span data-stu-id="39fd1-107">The significant performance impact occurs when iterating the characters in the <xref:System.Text.StringBuilder> object, which is an **O(n^2)** operation.</span></span> 

<span data-ttu-id="39fd1-108">Si vous rencontrez des problèmes de performances lors de l’utilisation de l’indexation basée sur des caractères avec des objets <xref:System.Text.StringBuilder>, vous pouvez utiliser une des solutions de contournement suivantes :</span><span class="sxs-lookup"><span data-stu-id="39fd1-108">If you encounter performance issues when using character-based indexing with <xref:System.Text.StringBuilder> objects, you can use any of the following workarounds:</span></span>

- <span data-ttu-id="39fd1-109">Convertissez l’instance de <xref:System.Text.StringBuilder> en <xref:System.String> en appelant la méthode <xref:System.Text.StringBuilder.ToString%2A>, puis accédez aux caractères de la chaîne.</span><span class="sxs-lookup"><span data-stu-id="39fd1-109">Convert the <xref:System.Text.StringBuilder> instance to a <xref:System.String> by calling the <xref:System.Text.StringBuilder.ToString%2A> method, then access the characters in the string.</span></span>

- <span data-ttu-id="39fd1-110">Copiez le contenu de l’objet <xref:System.Text.StringBuilder> existant dans un objet <xref:System.Text.StringBuilder> prédimensionné.</span><span class="sxs-lookup"><span data-stu-id="39fd1-110">Copy the contents of the existing <xref:System.Text.StringBuilder> object to a new pre-sized <xref:System.Text.StringBuilder> object.</span></span> <span data-ttu-id="39fd1-111">Les performances s’améliorent, car le nouvel objet <xref:System.Text.StringBuilder> ne contient pas de gros blocs.</span><span class="sxs-lookup"><span data-stu-id="39fd1-111">Performance improves because the new <xref:System.Text.StringBuilder> object is not chunky.</span></span> <span data-ttu-id="39fd1-112">Exemple :</span><span class="sxs-lookup"><span data-stu-id="39fd1-112">For example:</span></span>

   ```csharp
   // sbOriginal is the existing StringBuilder object
   var sbNew = new StringBuilder(sbOriginal.ToString(), sbOriginal.Length);
   ```
   ```vb
   ' sbOriginal is the existing StringBuilder object
   Dim sbNew = New StringBuilder(sbOriginal.ToString(), sbOriginal.Length)
   ```
- <span data-ttu-id="39fd1-113">Définissez la capacité initiale de l’objet <xref:System.Text.StringBuilder> à une valeur approximativement égale à sa taille maximale attendue en appelant le constructeur <xref:System.Text.StringBuilder.%23ctor(System.Int32)>.</span><span class="sxs-lookup"><span data-stu-id="39fd1-113">Set the initial capacity of the <xref:System.Text.StringBuilder> object to a value that is approximately equal to its maximum expected size by calling the <xref:System.Text.StringBuilder.%23ctor(System.Int32)> constructor.</span></span> <span data-ttu-id="39fd1-114">Notez que ceci alloue l’intégralité du bloc de mémoire, même si <xref:System.Text.StringBuilder> atteint rarement sa capacité maximale.</span><span class="sxs-lookup"><span data-stu-id="39fd1-114">Note that this allocates the entire block of memory even if the <xref:System.Text.StringBuilder> rarely reaches its maximum capacity.</span></span>
